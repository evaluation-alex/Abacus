/**
*
*   Abacus
*   A combinatorics library for Node/XPCOM/JS, PHP, Python
*   @version: 0.1.0
*   https://github.com/foo123/Abacus
**/
!function(t,r,n){"use strict";var e;"undefined"!=typeof Components&&"object"==typeof Components.classes&&"object"==typeof Components.classesByID&&Components.utils&&"function"==typeof Components.utils["import"]?(t.EXPORTED_SYMBOLS=[r])&&(t[r]=n.call(t)):"object"==typeof module&&module.exports?module.exports=n.call(t):"function"==typeof define&&define.amd&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(r)?define(r,["require","exports","module"],function(){return n.call(t)}):r in t||(t[r]=e=n.call(t))&&"function"==typeof define&&define.amd&&define(function(){return e})}(this,"Abacus",function(t){"use strict";var r,n,e,i,u,o,l,a,f,c={VERSION:"0.1.0"},s="prototype",_="constructor",h="hasOwnProperty",d=Array.prototype.slice,m=Object.create,v=function(t,r){for(var n in r)r[h](n)&&(t[n]=r[n]);return t},A=function(t,r){1===arguments.length&&(r=t,t=Object);var n=r[_];return r[h]("__static__")&&(n=v(n,r.__static__),delete r.__static__),n[s]=v(m(t[s]),r),n},g=Math.log2||function(t){return Math.log(t)/Math.LN2},p=function(t){return function(r){var n,e;return e=r.toString(2),(n=t-e.length)>0&&(e=new Array(n+1).join("0")+e),e}},w=p(32),b=function(t,r,n,e,i,u){var o=t.length;if(arguments.length<5&&(i=o-1),0>i&&(i+=o),arguments.length<4&&(e=0),e>i)return n;if(!0===u){var l,a,f=i-e+1,c=f-1,s=15&f,_=1&s,h=c-s,d=_?r(n,t[i],i):n;for(l=c-_;l>h;l-=2)a=e+l,d=r(r(d,t[a],a),t[a-1],a-1);for(l=h;l>=0;l-=16)a=e+l,d=r(r(r(r(r(r(r(r(r(r(r(r(r(r(r(r(d,t[a],a),t[a-1],a-1),t[a-2],a-2),t[a-3],a-3),t[a-4],a-4),t[a-5],a-5),t[a-6],a-6),t[a-7],a-7),t[a-8],a-8),t[a-9],a-9),t[a-10],a-10),t[a-11],a-11),t[a-12],a-12),t[a-13],a-13),t[a-14],a-14),t[a-15],a-15)}else{var l,a,f=i-e+1,s=15&f,_=1&s,d=_?r(n,t[e],e):n;for(l=_;s>l;l+=2)a=e+l,d=r(r(d,t[a],a),t[a+1],a+1);for(l=s;f>l;l+=16)a=e+l,d=r(r(r(r(r(r(r(r(r(r(r(r(r(r(r(r(d,t[a],a),t[a+1],a+1),t[a+2],a+2),t[a+3],a+3),t[a+4],a+4),t[a+5],a+5),t[a+6],a+6),t[a+7],a+7),t[a+8],a+8),t[a+9],a+9),t[a+10],a+10),t[a+11],a+11),t[a+12],a+12),t[a+13],a+13),t[a+14],a+14),t[a+15],a+15)}return d},y=function(t,r,n,e){if(n>e)return r;var i,u,o=e-n+1,l=15&o,a=1&l,f=a?t(r,n):r;for(i=a;l>i;i+=2)u=n+i,f=t(t(f,u),u+1);for(i=l;o>i;i+=16)u=n+i,f=t(t(t(t(t(t(t(t(t(t(t(t(t(t(t(t(f,u),u+1),u+2),u+3),u+4),u+5),u+6),u+7),u+8),u+9),u+10),u+11),u+12),u+13),u+14),u+15);return f},x=function(t,r,n,e,i){var u=t.length;if(arguments.length<4&&(e=u-1),0>e&&(e+=u),arguments.length<3&&(n=0),n>e)return[];var o,l,a,f,c,s,_=e-n+1,h=new Array(_);if(!0===i){for(a=_-1,c=15&_,s=1&c,f=a-c,s&&(h[0]=r(t[e],e,n,e)),o=a-s;o>f;o-=2)l=n+o,h[o]=r(t[l],l,n,e),h[o+1]=r(t[l-1],l-1,n,e);for(o=f;o>=0;o-=16)l=n+o,h[o]=r(t[l],l,n,e),h[o+1]=r(t[l-1],l-1,n,e),h[o+2]=r(t[l-2],l-2,n,e),h[o+3]=r(t[l-3],l-3,n,e),h[o+4]=r(t[l-4],l-4,n,e),h[o+5]=r(t[l-5],l-5,n,e),h[o+6]=r(t[l-6],l-6,n,e),h[o+7]=r(t[l-7],l-7,n,e),h[o+8]=r(t[l-8],l-8,n,e),h[o+9]=r(t[l-9],l-9,n,e),h[o+10]=r(t[l-10],l-10,n,e),h[o+11]=r(t[l-11],l-11,n,e),h[o+12]=r(t[l-12],l-12,n,e),h[o+13]=r(t[l-13],l-13,n,e),h[o+14]=r(t[l-14],l-14,n,e),h[o+15]=r(t[l-15],l-15,n,e)}else{for(c=15&_,s=1&c,s&&(h[0]=r(t[n],n,n,e)),o=s;c>o;o+=2)l=n+o,h[o]=r(t[l],l,n,e),h[o+1]=r(t[l+1],l+1,n,e);for(o=c;_>o;o+=16)l=n+o,h[o]=r(t[l],l,n,e),h[o+1]=r(t[l+1],l+1,n,e),h[o+2]=r(t[l+2],l+2,n,e),h[o+3]=r(t[l+3],l+3,n,e),h[o+4]=r(t[l+4],l+4,n,e),h[o+5]=r(t[l+5],l+5,n,e),h[o+6]=r(t[l+6],l+6,n,e),h[o+7]=r(t[l+7],l+7,n,e),h[o+8]=r(t[l+8],l+8,n,e),h[o+9]=r(t[l+9],l+9,n,e),h[o+10]=r(t[l+10],l+10,n,e),h[o+11]=r(t[l+11],l+11,n,e),h[o+12]=r(t[l+12],l+12,n,e),h[o+13]=r(t[l+13],l+13,n,e),h[o+14]=r(t[l+14],l+14,n,e),h[o+15]=r(t[l+15],l+15,n,e)}return h},k=function(t,r){for(var n=0,e=0,i=[],u=t.length,o=r.length;u>n&&o>e;)t[n]<r[e]?n++:t[n]>r[e]?e++:(i.push(t[n]),n++,e++);return i},U=function(t,r,n){var e,i,u=0,o=0,l=[],a=t.length,f=r.length;for(n=!1!==n,i=!n;a>u&&f>o;){if(n&&l.length){if(t[u]===e){u++;continue}if(r[o]===e){o++;continue}}t[u]<r[o]?l.push(e=t[u++]):t[u]>r[o]?l.push(e=r[o++]):(l.push(e=t[u]),i&&l.push(r[o]),u++,o++)}for(;a>u;)(i||t[u]!==e)&&l.push(e=t[u++]);for(;f>o;)(i||r[o]!==e)&&l.push(e=r[o++]);return l},C=function(){var t,r,n,e,i,u,o,l,a,f,c=arguments,s=c.length;if(!s)return[];for(a=c[0].length,t=1;s>t;t++)a*=c[t].length;for(f=new Array(a),t=0;a>t;t++){for(l=[],n=t,r=s-1;r>=0;r--)if(e=c[r].length,i=n%e,n=~~(n/e),o=c[r][i],o instanceof Array)for(u=o.length-1;u>=0;u--)l.unshift(o[u]);else l.unshift(o);f[t]=l}return f},q=function(){},E=function(t,r,n){var e,i,u,o,l,a=c.Arithmetic.rnd;for(o=!0===n?t.slice():t,l=!0===r?1:0,e=o.length;l<e--;)i=a(0,e-l),e!==i&&(u=o[e],o[e]=o[i],o[i]=u);return o},I=function(t,r,n){var e,i,u,o,l,a=c.Arithmetic.rnd,f=t.length;for(r=c.Arithmetic.min(r,f),e=new Array(r),n=!1!==n,n&&(i=new Array(r)),u=0;r>u;u++)o=a(0,--f),l=t[o],t[o]=t[f],t[f]=l,e[u]=l,n&&(i[u]=o);if(n)for(u=r-1;u>=0;u--)o=i[u],l=t[f],t[f]=t[o],t[o]=l,f++;return e},O=function(t,r){var n,e,i,u,o=t.length;for(n=new Array(r-o),e=0,i=0,u=0;r>e;)i>=o||e<t[i]?n[u++]=e:i++,e++;return n},R=function(t,r){if(null==t)return null;if(!t.length)return[];var n,e=t.length,i=new Array(e);if(r.length===e)for(n=0;e>n;n++)i[n]=r[n]-1-t[n];else for(n=0;e>n;n++)i[n]=r-1-t[e-1-n];return i},M=function(t){var r,n=[],e=t.length;if(e>1)for(r=e-1;r>=1;r--)n.push([t[0],t[r]]);return n},L=function(t){var r=c.Arithmetic.add;return b(t,r,0)},S=function(t){var r=c.Arithmetic.mul;return b(t,r,1)},N=function(t){return c.Arithmetic.shl(1,t)},P=function(t,r){return c.Arithmetic.pow(t,r)},X=function(t){var r=c.Arithmetic.mul;return 0>t?0:2>t?1:4>t?t<<t-2:y(r,1,2,t)},j=function(t,r){if(r>t-r&&(r=t-r),0>r||1>t)return 0;if(0===r||1===t)return 1;if(1===r)return t;var n,e=c.Arithmetic.mul,i=t-r,u=1+i;for(n=2;r>=n;n++)u=e(u,1+i/n);return c.Arithmetic.round(u)},T=function W(t,r,n,e){if(n===t&&1===r||r===t&&1===n)return 1;if(n+r>t+1||t>r*n)return 0;var i,u,o=c.Arithmetic.add,l=c.Arithmetic.min(n,t-n-r+2),a=c.Arithmetic.max(1,c.Arithmetic.ceil((t-n)/(r-1))),f=0;for(null==e&&(e={}),i=a;l>=i;i++)u=t-n+","+(r-1)+","+i,null==e[u]&&(e[u]=W(t-n,r-1,i,e)),f=o(f,e[u]);return f},D=8,H=16,G=32,V=64,B=128,K=256,Y=512,z=D|H|G|V|B|K|Y,F=K|Y,J=function(t){return arguments.length&&null!=t?t.substr?(t=t.toUpperCase(),c.ORDER[h](t)?c.ORDER[t]:D):z&t?t:D:D},Q=function(t){return arguments.length?function(){throw new Error('"'+t+'" not implemented')}:function(){throw new Error("Method not implemented")}};return c.Util={rnd:Math.random,rint:function(t,r){return c.Arithmetic.round((r-t)*c.Util.rnd()+t)},shuffle:E,pick:I,operate:b,operation:y,map:x,intersection:k,union:U,kronecker:C,cartesian:q,num:function(t){return parseInt(t,10)},val:function(t){return c.Arithmetic.floor(t.valueOf())},equ:function(t,r){return t===r},gte:function(t,r){return t>=r},lte:function(t,r){return r>=t},gt:function(t,r){return t>r},lt:function(t,r){return r>t},add:function(t,r){return t+r},sub:function(t,r){return t-r},mul:function(t,r){return t*r},div:function(t,r){return c.Arithmetic.floor(t/r)},mod:function(t,r){return t%r},pow:Math.pow,shl:function(t,r){return t<<r},shr:function(t,r){return t>>r},bor:function(t,r){return t|r},band:function(t,r){return t&r},neg:function(t){return c.Arithmetic.sub(0,t)},abs:Math.abs,min:Math.min,max:Math.max,floor:Math.floor,ceil:Math.ceil,round:Math.round,sum:L,product:S,pow2:N,powNK:P,factorial:X,binomial:j,partitions:T},c.Arithmetic={num:c.Util.num,val:c.Util.val,equ:c.Util.equ,gte:c.Util.gte,lte:c.Util.lte,gt:c.Util.gt,lt:c.Util.lt,add:c.Util.add,sub:c.Util.sub,mul:c.Util.mul,div:c.Util.div,mod:c.Util.mod,pow:c.Util.pow,shl:c.Util.shl,shr:c.Util.shr,bor:c.Util.bor,band:c.Util.band,neg:c.Util.neg,abs:c.Util.abs,min:c.Util.min,max:c.Util.max,floor:c.Util.floor,ceil:c.Util.ceil,round:c.Util.round,rnd:c.Util.rint},c.ORDER={LEX:D,LEXICOGRAPHIC:D,REVLEX:H,ANTILEX:H,REVERSELEXICOGRAPHIC:H,ANTILEXICOGRAPHIC:H,COLEX:G,COLEXICOGRAPHIC:G,REVCOLEX:V,ANTICOLEX:V,REVERSECOLEXICOGRAPHIC:V,ANTICOLEXICOGRAPHIC:V,RANDOM:K,RANDOMISED:K,STOCHASTIC:Y},r=c.BitArray=A({constructor:function Z(t){var r=this;return r instanceof Z?(r.length=t,void(r.bits=new Uint32Array(c.Arithmetic.ceil(t/32)))):new Z(t)},length:0,bits:null,dispose:function(){var t=this;return t.length=null,t.bits=null,t},clone:function(){var t=this,n=new r(t.length);return n.bits=new Uint32Array(t.bits),n},fromArray:function(t){var r=this;return r.bits=new Uint32Array(t),r},toArray:function(){return d.call(this.bits)},toString:function(){return x(this.toArray(),w).join("")},reset:function(){var t,r=this,n=r.bits,e=n.length;for(t=0;e>t;t++)n[t]=0;return r},isset:function(t){return!!(this.bits[t>>>5]&1<<(31&t))},set:function(t){var r=this;return r.bits[t>>>5]|=1<<(31&t),r},unset:function(t){var r=this;return r.bits[t>>>5]&=~(1<<(31&t)),r},toggle:function(t){var r=this;return r.bits[t>>>5]^=1<<(31&t),r}}),n=c.CombinatorialIterator=A({constructor:function $(t){var r,n=this;return n instanceof $?(r=n[_],n.n=t||0,n._count=r.count(n.n),void n.order(D)):new $(t)},__static__:{count:Q(),rank:Q(),unrank:Q(),first:Q(),last:Q(),stochastic:Q(),dual:function(t,r,n){return 0>=r?[]:R(t,r)},succ:function(t,r,n,e){var i=this,u=c.Arithmetic;return-1!==t&&1!==t&&(t=1),r?i.unrank(u.add(i.rank(r,n,e),t),n,e):null},rand:function(t,r){var n=this,e=c.Arithmetic,i=r?r:n.count(t),u=e.sub(i,1),o=e.rnd(0,u);return e.equ(0,o)?n.first(t):e.equ(o,u)?n.last(t):n.unrank(o,t,i)}},n:0,_order:0,_count:0,_index:null,__item:null,_item:null,_prev:null,_next:null,_traversed:null,_stochastic:null,dispose:function(){var t=this;return t.n=null,t._order=null,t._count=0,t._index=null,t.__item=null,t._item=null,t._prev=null,t._next=null,t._stochastic=null,t._traversed&&(t._traversed.dispose(),t._traversed=null),t},_store:function(){var t=this;return[t._order,t._index,t.__item,t._item,t._prev,t._next]},_restore:function(t){var r=this;return t&&(r._order=t[0],r._index=t[1],r.__item=t[2],r._item=t[3],r._prev=t[4],r._next=t[5]),r},total:function(){return this._count},order:function(t,n,e,i){var u,o,l,a=this,f=a[_];if(!arguments.length)return a._order;if("object"==typeof n&&arguments.length<4?(i=e,e=n,n=!1):n=!1===n,t=J(t),a._order=t,a._index=0,a._item=a.__item=null,a._prev=!1,a._next=!1,o=a._count,l=a.n,Y&t)if(null==a._stochastic||e){if(!e)throw new Error("No Stochastic Transition Matrix given!");a._stochastic=[e,i?1:0,i?[]:null],a.__item=f.stochastic(a._stochastic[0],l,a._stochastic[2]),a._item=a.__item.slice()}else null!=a._stochastic[2]&&(a._stochastic[2]=[]),a.__item=f.stochastic(a._stochastic[0],l,a._stochastic[2]),a._item=a.__item.slice();else K&t?(a._traversed?a._traversed.reset():a._traversed=new r(o),a._traversed.set(u=a.randomIndex()),a.__item=a.item(u,D),a._item=null!=a.__item?a.__item.slice():null):V&t?(a.__item=n?f.last(l):f.first(l),a._item=f.dual(a.__item,l,V)):G&t?(a.__item=n?f.first(l):f.last(l),a._item=f.dual(a.__item,l,G)):H&t?(a.__item=n?f.first(l):f.last(l),a._item=null!=a.__item?a.__item.slice():null):(a.__item=n?f.last(l):f.first(l),a._item=null!=a.__item?a.__item.slice():null);return a._prev=F&t||!n?!1:null!=a._item,a._next=!n||F&t?null!=a._item:!1,a},index:function(t){if(!arguments.length)return this._index;var r,n=this,e=c.Arithmetic,i=n[_],u=n.n,o=n._count,l=n._order;return t=e.num(t),e.gt(0,t)&&(t=e.add(t,o)),e.gte(t,0)&&e.lt(t,o)&&(r=e.sub(o,1),V&l?(n._index=t,n.__item=e.equ(0,t)?i.first(u):e.equ(r,t)?i.last(u):i.unrank(t,u,o),n._item=i.dual(n.__item,u,V)):G&l?(n._index=t,n.__item=e.equ(0,t)?i.last(u):e.equ(r,t)?i.first(u):i.unrank(e.sub(r,t),u,o),n._item=i.dual(n.__item,u,G)):H&l?(n._index=t,n.__item=e.equ(0,t)?i.last(u):e.equ(r,t)?i.first(u):i.unrank(e.sub(r,t),u,o),n._item=n.__item.slice()):D&l&&(n._index=t,n.__item=e.equ(0,t)?i.first(u):e.equ(r,t)?i.last(u):i.unrank(t,u,o),n._item=n.__item.slice())),n},item:function(t,r){if(!arguments.length)return this._item;var n,e,i,u=this,o=u.n,l=u._count,a=u[_],f=c.Arithmetic;if(r=null!=r?J(r):u._order,t=f.num(t),f.gt(0,t)&&(t=f.add(t,l)),f.gte(t,0)&&f.lt(t,l)){if(n=f.sub(l,1),K&r){for(e=u._traversed;e.isset(i=u.randomIndex()););return e.set(i),a.unrank(i,o,l)}return V&r?a.dual(f.equ(0,t)?a.first(o):f.equ(n,t)?a.last(o):a.unrank(t,o,l),o,V):G&r?a.dual(f.equ(0,t)?a.last(o):f.equ(n,t)?a.first(o):a.unrank(f.sub(n,t),o,l),o,G):H&r?f.equ(0,t)?a.last(o):f.equ(n,t)?a.first(o):a.unrank(f.sub(n,t),o,l):f.equ(0,t)?a.first(o):f.equ(n,t)?a.last(o):a.unrank(t,o,l)}return null},randomIndex:function(t,r){var n=this,e=c.Arithmetic,i=n._count,u=arguments.length;return 0===u?(t=0,r=e.sub(i,1)):1===u?(t=e.num(t||0),r=e.sub(i,1)):(t=e.num(t),r=e.num(r)),e.rnd(t,r)},random:function(){var t=this,r=t[_];return r.rand(t.n,t._count)},rewind:function(){return this.order(this._order,!0)},hasNext:function(){return Y&this._order?!0:this._next},next:function(){var t,r,n=this,e=c.Arithmetic,i=n._order,u=n[_],o=n._item,l=n.n,a=n._count;if(Y&i)n.__item=u.stochastic(n._stochastic[0],l,n._stochastic[2]),n._item=n.__item.slice();else if(K&i)if(e.lt(e.add(n._index,1),a)){for(n._index=e.add(n._index,1),t=n._traversed;t.isset(r=n.randomIndex()););t.set(r),n.__item=n.item(r,D),n._item=null!=n.__item?n.__item.slice():null,n._next=null!=n._item}else n._next=!1,n._traversed&&(n._traversed.dispose(),n._traversed=null);else V&i?(n.__item=u.succ(1,n.__item,l,a),n._item=u.dual(n.__item,l,V)):G&i?(n.__item=u.succ(-1,n.__item,l,a),n._item=u.dual(n.__item,l,G)):H&i?(n.__item=u.succ(-1,n.__item,l,a),n._item=null!=n.__item?n.__item.slice():null):(n.__item=u.succ(1,n.__item,l,a),n._item=null!=n.__item?n.__item.slice():null),n._next=null!=n._item,n._next&&(n._index=e.add(n._index,1));return o},forward:function(){return this.order(this._order,!1)},hasPrev:function(){return F&this._order?!1:this._prev},prev:function(){var t=this,r=c.Arithmetic,n=t._order,e=t[_],i=t._item,u=t.n,o=t._count;return F&n?null:(V&n?(t.__item=e.succ(-1,t.__item,u,o),t._item=e.dual(t.__item,u,V)):G&n?(t.__item=e.succ(1,t.__item,u,o),t._item=e.dual(t.__item,u,G)):H&n?(t.__item=e.succ(1,t.__item,u,o),t._item=null!=t.__item?t.__item.slice():null):(t.__item=e.succ(-1,t.__item,u,o),t._item=null!=t.__item?t.__item.slice():null),t._prev=null!=t._item,t._prev&&(t._index=r.sub(t._index,1)),i)},range:function(t,r){var n,e,i,u,o,l=this,a=c.Arithmetic,f=l._count,s=1,_=arguments.length,h=a.sub(f,1);if(1>_?(t=0,r=h):2>_?(t=a.num(t),r=h):(t=a.num(t),r=a.num(r)),a.lt(t,0)&&(t=a.add(t,f)),a.lt(r,0)&&(r=a.add(r,f)),a.gt(t,r)&&(n=t,t=r,r=n,s=-1),a.lt(t,0)&&(t=0),a.gt(r,h)&&(r=h),a.lte(t,r)){if(o=l._store(),F&l._order||l.index(t),i=a.val(a.sub(r,t)),e=new Array(i+1),0>s)for(u=i;u>=0;u--)e[u]=l.next();else for(u=0;i>=u;u++)e[u]=l.next();l._restore(o)}else e=[];return e}}),e=c.Permutation=A(n,{constructor:function tt(t){var r=this;return r instanceof tt?void n.call(r,t):new tt(t)},__static__:{count:function(t){return X(t)},dual:n.dual,rank:function(t,r){var n,e,i,u,o=c.Arithmetic,l=0,a=o.ceil(g(r)),f=(1<<1+a)-1,s=new Array(f),_=o.shl(1,a);for(n=0;f>n;n++)s[n]=0;for(n=0;r>n;n++){for(u=t[n],i=o.val(o.add(_,u)),e=0;a>e;e++)1&i&&(u=o.sub(u,s[i>>>1<<1])),s[i]=o.add(s[i],1),i>>>=1;s[i]=o.add(s[i],1),l=o.add(o.mul(l,o.sub(n)),u)}return l},unrank:function(t,r,n){var e,i,u,o,l,a,f,s,_,h,d,m,v=c.Arithmetic,A=this;if(n=n||X(r),v.equ(0,t))return A.first(r);if(v.equ(n,v.add(t,1)))return A.last(r);for(e=new Array(r),i=v.div(n,r),_=v.ceil(g(r)),h=(1<<1+_)-1,d=new Array(h),m=v.shl(1,_),u=0;_>=u;u++)for(o=1,l=1<<u;l>=o;o++)d[l-1+o]=v.shl(1,v.sub(_,u));for(s=r-1,u=0;r>u;u++){for(a=v.div(t,i),f=1,o=0;_>o;o++)d[f]=v.sub(d[f],1),f<<=1,v.gte(a,d[f])&&(a=v.sub(a,d[f]),f++);d[f]=0,e[u]=v.val(v.sub(f,m)),s&&(t=v.mod(t,i),i=v.div(i,s),s--)}return e},first:function(t){var r,n=new Array(t);for(r=0;t>r;r++)n[r]=r;return n},last:function(t){var r,n=new Array(t);for(r=0;t>r;r++)n[r]=t-1-r;return n},succ:function(t,r,n){if(r){var e,i,u,o,l,a=r.slice();if(-1===t){for(e=n-2;e>=0&&a[e]<=a[e+1];)e--;if(e>=0){for(i=n-1;i>e&&a[e]<=a[i];)i--;for(l=a[e],a[e]=a[i],a[i]=l,u=e+1,o=n-1;o>u;)l=a[u],a[u++]=a[o],a[o--]=l}else a=null}else{for(e=n-2;e>=0&&a[e]>=a[e+1];)e--;if(e>=0){for(i=n-1;i>e&&a[e]>=a[i];)i--;for(l=a[e],a[e]=a[i],a[i]=l,u=e+1,o=n-1;o>u;)l=a[u],a[u++]=a[o],a[o--]=l}else a=null}return a}return null},rand:function(t){var r,n=new Array(t);for(r=0;t>r;r++)n[r]=r;return E(n)},stochastic:function(t,r,n){if(t.length!==r||t[0].length!==r)throw new Error("Stochastic Matrix dimensions and Permutation dimensions do not match!");var e,i,u,o,l,a,f,s,_=new Array(r),h=new Array(r),d=0,m=c.Util.rnd,v=!1;for(i=0;r>i;i++)h[i]=0;if(n){if(v=!0,!n.length){for(n.N=0,e=new Array(r),i=0;r>i;i++)e[i]=0;for(i=0;r>i;i++)n.push(e.slice())}d=++n.N}for(s=!v,i=0;r>i;)for(o=m(),f=0,l=t[i],v&&(a=n[i]),u=0;r>u;u++){if(o>f&&o<=f+l[u]){0===h[u]&&(s||a[u]+1<=(d+1)*l[u])&&(h[u]=1,_[i]=u,v&&a[u]++,i++);break}f+=l[u]}return _},inverse:function(t,r){r=r||t.length;var n,e=new Array(r);for(n=0;r>n;n++)e[t[n]]=n;return e},compose:function(){var t,r,n,e=arguments,i=e.length,u=i?e[0]:[],o=u.length;for(r=1;i>r;r++)for(n=u.slice(),t=0;o>t;t++)u[t]=n[e[r][t]];return u},permute:function(t,r,n){var e,i,u,o=t.length;for(!0===n?(i=new Array(o),u=t):(i=t,u=t.slice()),e=0;o>e;e++)i[e]=u[r[e]];return i},reassign:function(t,r){var n,e=t.length,i=new Array(e);for(n=0;e>n;n++)i[n]=r[t[n]];return i},shuffle:E,toCycles:function(t,r,n){r=r||t.length;var e,i,u,o=[],l=!0===n?1:0,a=new Array(r),f=new Array(r);for(e=0;r>e;e++)f[e]=e,a[e]=0;for(u=[i=f.shift()],a[i]=1;f.length;){if(i=t[i],a[i])for(u.length>l&&o.push(u),u=[];f.length&&a[i=f.shift()];);a[i]||(u.push(i),a[i]=1)}return u.length>l&&o.push(u),o},fromCycles:function(t,r){var n,e,i,u,o=new Array(r),l=t.length;for(e=0;r>e;e++)o[e]=e;for(n=0;l>n;n++)if(u=t[n],i=u.length,!(2>i)){for(e=0;i-1>e;e++)o[u[e]]=u[e+1];o[u[i-1]]=u[0]}return o},toSwaps:function(t,r){r=r||t.length;var n,i,u,o=[],l=e.toCycles(t,r,!0);for(n=0,i=l.length;i>n;n++)u=l[n],o=o.concat(M(u));return o},fromSwaps:function(t,r){var n,e,i,u=t.length,o=new Array(r);for(n=0;r>n;n++)o[n]=n;for(n=0;u>n;n++)e=t[n],i=o[e[0]],o[e[0]]=o[e[1]],o[e[1]]=i;return o},toMatrix:function(t,r,n){var e,i,u=new Array(r);for(n=!0===n,e=0;r>e;e++)for(u[e]=new Array(r),i=0;r>i;i++)u[e][i]=0;for(e=0;r>e;e++)n?u[t[e]][e]=1:u[e][t[e]]=1;return u},fromMatrix:function(t,r,n){var e,i,u=new Array(r);for(n=!0===n,e=0;r>e;e++)for(i=0;r>i;i++)t[e][i]&&(n?u[i]=e:u[e]=i);return u},isConnected:function(t,r){var n,e=-(1/0);for(r=r||t.length,n=0;r-1>n;n++)if(t[n]>e&&(e=t[n]),n>=e)return!1;return!0}}}),i=c.Combination=A(n,{constructor:function rt(t,r){var e=this;return e instanceof rt?void n.call(e,[t,r]):new rt(t,r)},__static__:{count:function(t){return j(t[0],t[1])},dual:function(t,r){return R(t,r[0])},rank:function(t,r,n){var e,i,u,o,l,a=c.Arithmetic,f=0;for(o=r[1],r=r[0],l=n?n:j(r,o),e=1;o>=e;e++)i=r-1-t[e-1],u=o+1-e,i>=u&&(f=a.add(f,j(i,u)));return a.sub(a.sub(l,1),f)},unrank:function(t,r,n){var e,i,u,o,l,a,f=c.Arithmetic,s=this;if(n=n||j(r[0],r[1]),f.equ(0,t))e=s.first(r);else if(f.equ(n,f.add(t,1)))e=s.last(r);else{u=r[1],r=r[0],e=new Array(u),i=n,t=f.sub(f.sub(i,1),t),i=f.div(f.mul(i,f.sub(r,u)),r),l=r-u+1,o=u,a=r-1;do f.lte(i,t)?(e[u-o]=r-l-o+1,f.gt(i,0)&&(t=f.sub(t,i),i=f.div(f.mul(i,o),a)),o--,a--):(i=f.div(f.mul(i,f.sub(a,o)),a),l--,a--);while(o>0)}return e},first:function(t){var r,n=t[1],e=new Array(n);for(r=0;n>r;r++)e[r]=r;return e},last:function(t){var r,n=t[1],e=new Array(n);for(t=t[0],r=0;n>r;r++)e[n-1-r]=t-1-r;return e},succ:function(t,r,n){if(r){var e,i,u,o,l,a=r.slice();if(e=n[1],n=n[0],-1===t){for(i=e-1,u=-1;i>0;){if(a[i]>a[i-1]+1){u=i;break}i--}if(-1===u&&0<a[0]&&(u=0),u>-1){for(l=n,i=e-1;i>u;i--)a[i]=--l;a[u]--}else a=null}else{for(i=e-1,u=-1,o=n-e;i>=0;){if(a[i]<o+i){u=i;break}i--}if(u>-1)for(l=a[u],i=u;e>i;i++)a[i]=++l;else a=null}return a}return null},rand:function(t){var r,n,e,i,u,o,l,a;for(n=t[1],t=t[0],r=new Array(n),e=c.Util.rnd(),u=0,l=0,a=t-n,i=1;n>=i;i++){for(u++,o=(n-i+1)/(t-u+1);e>=o&&a+i>u;)l=o,u++,o=l+(1-l)*((n-i+1)/(t-u+1));r[i-1]=u-1,e=(e-l)/(o-l)}return r},stochastic:n.stochastic,complement:O,choose:function(t,r){var n,e=r.length,i=new Array(e);for(n=0;e>n;n++)i[n]=t[r[n]];return i},pick:I,toMatrix:function(t,r,n){var e,i,u,o;for(i=r[1],r=r[0],e=new Array(r),n=!0===n,u=0;r>u;u++)for(e[u]=new Array(r),o=0;r>o;o++)e[u][o]=0;for(u=0;i>u;u++)n?e[t[u]][u]=1:e[u][t[u]]=1;return e},fromMatrix:function(t,r,n){var e,i,u,o;for(i=r[1],r=r[0],e=new Array(i),n=!0===n,u=0;r>u;u++)for(o=0;r>o;o++)t[u][o]&&(n&&i>o?e[o]=u:!n&&i>u&&(e[u]=o));return e}}}),i.conjugate=i.complement,u=c.CombinationRepeat=A(n,{constructor:function nt(t,r){var e=this;return e instanceof nt?void n.call(e,[t,r]):new nt(t,r)},__static__:{count:function(t){return j(t[0]+t[1]-1,t[1])},dual:i.dual,rank:function(t,r,n){var e,i,u,o,l,a,f=c.Arithmetic,s=0;for(o=r[1],r=r[0],l=r+o-1,a=n?n:j(l,o),e=1;o>=e;e++)i=l-1-t[e-1]-e+1,u=o+1-e,i>=u&&(s=f.add(s,j(i,u)));return f.sub(f.sub(a,1),s)},unrank:function(t,r,n){var e,i,u,o,l,a,f,s=c.Arithmetic,_=this;if(n=n||j(r[0]+r[1]-1,r[1]),s.equ(0,t))return _.first(r);if(s.equ(n,s.add(t,1)))return _.last(r);u=r[1],r=r[0],o=r+u-1,e=new Array(u),i=n,t=s.sub(s.sub(i,1),t),i=s.div(s.mul(i,s.sub(o,u)),o),a=o-u+1,l=u,f=o-1;do s.lte(i,t)?(e[u-l]=o-a-u+1,s.gt(i,0)&&(t=s.sub(t,i),i=s.div(s.mul(i,l),f)),l--,f--):(i=s.div(s.mul(i,s.sub(f,l)),f),a--,f--);while(l>0);return e},first:function(t){var r,n=t[1],e=new Array(n);for(r=0;n>r;r++)e[r]=0;return e},last:function(t){var r,n=t[1],e=new Array(n);for(t=t[0]-1,r=0;n>r;r++)e[r]=t;return e},succ:function(t,r,n){if(r){var e,i,u,o,l=r.slice();if(e=n[1],n=n[0],-1===t){for(i=e-1,u=-1;i>0;){if(l[i]>l[i-1]){u=i;break}i--}if(-1===u&&0<l[0]&&(u=0),u>-1){for(o=n-1,i=u+1;e>i;i++)l[i]=o;l[u]--}else l=null}else{for(i=e-1,u=-1;i>=0;){if(l[i]<n-1){u=i;break}i--}if(u>-1)for(o=l[u]+1,i=u;e>i;i++)l[i]=o;else l=null}return l}return null},rand:function(t){var r,n,e,i,u,o,l,a,f;for(n=t[1],t=t[0],r=new Array(n),e=c.Util.rnd(),u=0,l=0,a=t+n-1,f=a-n,i=1;n>=i;i++){for(u++,o=(n-i+1)/(a-u+1);e>=o&&f+i>u;)l=o,u++,o=l+(1-l)*((n-i+1)/(a-u+1));r[i-1]=u-i,e=(e-l)/(o-l)}return r},stochastic:i.stochastic}}),o=c.Partition=A(n,{constructor:function et(t){var r=this;return r instanceof et?void n.call(r,t):new et(t)},__static__:{count:function(t){var r,n,e=c.Arithmetic.add,i=t>1?2:1;for(r=2;t>r;r++)for(n=t-r+1;n>=1;n--)i=e(i,T(t,r,n));return i},dual:function(t,r){var n,e,i=[],u=t.length;for(n=0;u>n;n++)if(e=r-t[n],!(0>=e)){if(r===e)return[r];i.unshift(e)}return i},rank:function(t,r,n,e,i){var u,o,l,a=c.Arithmetic,f=this,s=t.length,_=r;return n=n||f.count(r),e=e||0,i=i||s,o=e,l=t[o],u=_===l?a.sub(n,1):1===l?0:s>o+1?a.add(1,f.rank(t,r-l,a.sub(n,f.count(r-l)),o+1)):0},unrank:function(t,r,n){},first:function(t){var r,n=new Array(t);for(r=0;t>r;r++)n[r]=1;return n},last:function(t){return[t]},succ:function(t,r,n){if(r){var e,i,u,o,l,a,f=r.slice();if(-1===t)if(f[0]>1){for(i=f.length,e=i-1;e>=0&&1===f[e];)e--;for(u=f[e]-1,f=f.slice(0,e+1),f[e]=u,l=L(f),a=n-l;a>0;)o=a,o>u?(o=u,f.push(o)):f.push(a),a-=o}else f=null;else if(f[0]<n){for(i=f.length,e=i-1,e>0&&e--;e>0&&f[e]===f[e-1];)e--;for(f[e]++,f=f.slice(0,e+1),l=L(f),a=n-l;a>0;)f.push(1),a--}else f=null;return f}return null},rand:function(t){},stochastic:n.stochastic,conjugate:function(t){var r,n,e,i=t.length,u=t[0],o=new Array(u);for(r=0;u>r;r++)o[r]=1;for(n=1;i>n;n++)for(r=0,e=t[n];u>r&&e>0;)o[r++]++,e--;return o},pack:function(t){var r,n=[],e=t.length,i=t[0],u=[i,1];for(r=1;e>r;r++)i===t[r]?u[1]++:(n.push(u),i=t[r],u=[i,1]);return n.push(u),n},unpack:function(t){var r,n,e,i,u,o=[],l=t.length;for(r=0;l>r;r++)if(u=t[r],1===u[1])o.push(u[0]);else for(e=u[1],i=u[0],n=0;e>n;n++)o.push(i);return o}}}),o.transpose=o.conjugate,l=c.Powerset=A(n,{constructor:function it(t){var r=this;return r instanceof it?void n.call(r,t):new it(t)},__static__:{count:function(t){return N(t)},dual:n.dual,rank:function(t){for(var r=c.Arithmetic,n=0,e=0,i=t.length;i>e;)n=r.add(n,r.shl(1,t[e++]));return n},unrank:function(t){for(var r=c.Arithmetic,n=[],e=0;r.gt(t,0);)r.gt(r.band(t,1),0)&&n.unshift(e),r.gt(r.band(t,2),0)&&n.unshift(e+1),r.gt(r.band(t,4),0)&&n.unshift(e+2),r.gt(r.band(t,8),0)&&n.unshift(e+3),r.gt(r.band(t,16),0)&&n.unshift(e+4),r.gt(r.band(t,32),0)&&n.unshift(e+5),r.gt(r.band(t,64),0)&&n.unshift(e+6),r.gt(r.band(t,128),0)&&n.unshift(e+7),e+=8,t=r.shr(t,8);return n},first:function(t){return[]},last:function(t){var r,n=new Array(t);for(r=0;t>r;r++)n[r]=t-1-r;return n},succ:function(t,r,n){var e=this,i=c.Arithmetic;return 1!==t&&-1!==t&&(t=1),-1===t?0===r.length?null:e.unrank(i.add(e.rank(r),t)):n===r.length?null:e.unrank(i.add(e.rank(r),t))},rand:n.rand,stochastic:n.stochastic}}),a=c.Tensor=A(n,{constructor:function ut(){var t=this;return t instanceof ut?void(arguments.length?n.call(t,d.call(arguments)):(t.n=[],t._count=0)):(t=new ut,arguments.length?n.call(t,d.call(arguments)):(t.n=[],t._count=0),t)},__static__:{count:function(t){return t&&t.length?S(t):0},dual:n.dual,rank:function(t,r){var n,e,i=c.Arithmetic,u=r,o=u.length;if(!o)return-1;for(n=0,e=0;o>e;e++)n=i.add(i.mul(n,u[e]),t[e]);return n},unrank:function(t,r){var n,e,i,u,o,l=c.Arithmetic,a=r,f=a.length;if(!f)return[];for(o=new Array(f),n=t,i=f-1;i>=0;i--)e=a[i],u=l.mod(n,e),n=l.div(n,e),o[i]=l.val(u);return o},first:function(t){var r,n=t.length,e=new Array(n);for(r=0;n>r;r++)e[r]=0;return e},last:function(t){var r,n=t,e=n.length,i=new Array(e);for(r=0;e>r;r++)i[r]=n[r]-1;return i},succ:function(t,r,n){if(r){var e,i,u=r.slice(),o=n,l=o.length;if(-1===t){for(e=l-1;e>=0&&u[e]-1<0;)e--;if(e>=0)for(u[e]--,i=e+1;l>i;i++)u[i]=o[i]-1;else u=null}else{for(e=l-1;e>=0&&u[e]+1===o[e];)e--;if(e>=0)for(u[e]++,i=e+1;l>i;i++)u[i]=0;else u=null}return u}return null},rand:function(t){var r,n=c.Arithmetic.rnd,e=t,i=e.length,u=new Array(i);for(r=0;i>r;r++)u[r]=n(0,e[r]-1);return u},stochastic:n.stochastic,product:C,component:function(t,r){var n,e,i,u,o,l,a=[],f=r,c=f.length;for(n=0;c>n;n++)if(i=f[n],o=t[n],u=i[o],u instanceof Array)for(e=0,l=u.length;l>e;e++)a.push(u[e]);else a.push(u);return a}}}),f=c.Tuple=A(n,{constructor:function ot(t,r){var e=this;return e instanceof ot?void n.call(e,[t||1,r||2]):new ot(t,r)},__static__:{count:function(t){return P(t[1],t[0])},dual:function(t,r){return R(t,r[1])},rank:function(t,r){var n,e,i=c.Arithmetic,u=r[0];for(r=r[1],n=0,e=0;u>e;e++)n=i.add(i.mul(n,r),t[e]);return n},unrank:function(t,r){var n,e,i,u,o,l=c.Arithmetic,a=r[0];for(r=r[1],o=new Array(a),n=t,i=a-1;i>=0;i--)e=r,u=l.mod(n,e),n=l.div(n,e),o[i]=l.val(u);return o},first:function(t){var r,n=t[0],e=new Array(n);for(r=0;n>r;r++)e[r]=0;return e},last:function(t){var r,n=t[0],e=new Array(n);for(t=t[1]-1,r=0;n>r;r++)e[r]=t;return e},succ:function(t,r,n){if(r){var e,i,u=r.slice(),o=n[0],n=n[1];if(-1===t){for(e=o-1;e>=0&&u[e]-1<0;)e--;if(e>=0)for(u[e]--,i=e+1;o>i;i++)u[i]=n-1;else u=null}else{for(e=o-1;e>=0&&u[e]+1===n;)e--;if(e>=0)for(u[e]++,i=e+1;o>i;i++)u[i]=0;else u=null}return u}return null},rand:function(t){var r,n=c.Arithmetic.rnd,e=t[0],i=new Array(e);for(t=t[1]-1,r=0;e>r;r++)i[r]=n(0,t);return i},stochastic:a.stochastic}}),c});