/**
*
*   Abacus
*   A combinatorics library for Node/XPCOM/JS, PHP, Python
*   @version: 0.1.0
*   https://github.com/foo123/Abacus
**/
!function(t,r,n){"use strict";var e;"undefined"!=typeof Components&&"object"==typeof Components.classes&&"object"==typeof Components.classesByID&&Components.utils&&"function"==typeof Components.utils["import"]?(t.EXPORTED_SYMBOLS=[r])&&(t[r]=n.call(t)):"object"==typeof module&&module.exports?module.exports=n.call(t):"function"==typeof define&&define.amd&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(r)?define(r,["require","exports","module"],function(){return n.call(t)}):r in t||(t[r]=e=n.call(t))&&"function"==typeof define&&define.amd&&define(function(){return e})}(this,"Abacus",function(t){"use strict";var r,n,e,i,u,o,s,l,f,a={VERSION:"0.1.0"},c="prototype",h="constructor",_="hasOwnProperty",d=Array.prototype.slice,m=Object.create,v=function(t,r){for(var n in r)r[_](n)&&(t[n]=r[n]);return t},p=function(t,r){1===arguments.length&&(r=t,t=Object);var n=r[h];return r[_]("__static__")&&(n=v(n,r.__static__),delete r.__static__),n[c]=v(m(t[c]),r),n},g=Math.log2||function(t){return Math.log(t)/Math.LN2},A=function(t){return function(r){var n,e;return e=r.toString(2),(n=t-e.length)>0&&(e=new Array(n+1).join("0")+e),e}},w=A(32),b=function(t,r,n,e,i,u){var o=t.length;if(arguments.length<5&&(i=o-1),0>i&&(i+=o),arguments.length<4&&(e=0),e>i)return n;if(!0===u){var s,l,f=i-e+1,a=f-1,c=15&f,h=1&c,_=a-c,d=h?r(n,t[i],i):n;for(s=a-h;s>_;s-=2)l=e+s,d=r(r(d,t[l],l),t[l-1],l-1);for(s=_;s>=0;s-=16)l=e+s,d=r(r(r(r(r(r(r(r(r(r(r(r(r(r(r(r(d,t[l],l),t[l-1],l-1),t[l-2],l-2),t[l-3],l-3),t[l-4],l-4),t[l-5],l-5),t[l-6],l-6),t[l-7],l-7),t[l-8],l-8),t[l-9],l-9),t[l-10],l-10),t[l-11],l-11),t[l-12],l-12),t[l-13],l-13),t[l-14],l-14),t[l-15],l-15)}else{var s,l,f=i-e+1,c=15&f,h=1&c,d=h?r(n,t[e],e):n;for(s=h;c>s;s+=2)l=e+s,d=r(r(d,t[l],l),t[l+1],l+1);for(s=c;f>s;s+=16)l=e+s,d=r(r(r(r(r(r(r(r(r(r(r(r(r(r(r(r(d,t[l],l),t[l+1],l+1),t[l+2],l+2),t[l+3],l+3),t[l+4],l+4),t[l+5],l+5),t[l+6],l+6),t[l+7],l+7),t[l+8],l+8),t[l+9],l+9),t[l+10],l+10),t[l+11],l+11),t[l+12],l+12),t[l+13],l+13),t[l+14],l+14),t[l+15],l+15)}return d},y=function(t,r,n,e){if(n>e)return r;var i,u,o=e-n+1,s=15&o,l=1&s,f=l?t(r,n):r;for(i=l;s>i;i+=2)u=n+i,f=t(t(f,u),u+1);for(i=s;o>i;i+=16)u=n+i,f=t(t(t(t(t(t(t(t(t(t(t(t(t(t(t(t(f,u),u+1),u+2),u+3),u+4),u+5),u+6),u+7),u+8),u+9),u+10),u+11),u+12),u+13),u+14),u+15);return f},x=function(t,r,n,e,i){var u=t.length;if(arguments.length<4&&(e=u-1),0>e&&(e+=u),arguments.length<3&&(n=0),n>e)return[];var o,s,l,f,a,c,h=e-n+1,_=new Array(h);if(!0===i){for(l=h-1,a=15&h,c=1&a,f=l-a,c&&(_[0]=r(t[e],e,n,e)),o=l-c;o>f;o-=2)s=n+o,_[o]=r(t[s],s,n,e),_[o+1]=r(t[s-1],s-1,n,e);for(o=f;o>=0;o-=16)s=n+o,_[o]=r(t[s],s,n,e),_[o+1]=r(t[s-1],s-1,n,e),_[o+2]=r(t[s-2],s-2,n,e),_[o+3]=r(t[s-3],s-3,n,e),_[o+4]=r(t[s-4],s-4,n,e),_[o+5]=r(t[s-5],s-5,n,e),_[o+6]=r(t[s-6],s-6,n,e),_[o+7]=r(t[s-7],s-7,n,e),_[o+8]=r(t[s-8],s-8,n,e),_[o+9]=r(t[s-9],s-9,n,e),_[o+10]=r(t[s-10],s-10,n,e),_[o+11]=r(t[s-11],s-11,n,e),_[o+12]=r(t[s-12],s-12,n,e),_[o+13]=r(t[s-13],s-13,n,e),_[o+14]=r(t[s-14],s-14,n,e),_[o+15]=r(t[s-15],s-15,n,e)}else{for(a=15&h,c=1&a,c&&(_[0]=r(t[n],n,n,e)),o=c;a>o;o+=2)s=n+o,_[o]=r(t[s],s,n,e),_[o+1]=r(t[s+1],s+1,n,e);for(o=a;h>o;o+=16)s=n+o,_[o]=r(t[s],s,n,e),_[o+1]=r(t[s+1],s+1,n,e),_[o+2]=r(t[s+2],s+2,n,e),_[o+3]=r(t[s+3],s+3,n,e),_[o+4]=r(t[s+4],s+4,n,e),_[o+5]=r(t[s+5],s+5,n,e),_[o+6]=r(t[s+6],s+6,n,e),_[o+7]=r(t[s+7],s+7,n,e),_[o+8]=r(t[s+8],s+8,n,e),_[o+9]=r(t[s+9],s+9,n,e),_[o+10]=r(t[s+10],s+10,n,e),_[o+11]=r(t[s+11],s+11,n,e),_[o+12]=r(t[s+12],s+12,n,e),_[o+13]=r(t[s+13],s+13,n,e),_[o+14]=r(t[s+14],s+14,n,e),_[o+15]=r(t[s+15],s+15,n,e)}return _},k=function(t,r,n,e,i){var u=t.length;if(arguments.length<4&&(e=u-1),0>e&&(e+=u),arguments.length<3&&(n=0),n>e)return[];var o,s,l,f,a,c,h=e-n+1,_=[];if(trye===i){for(l=h-1,a=15&h,c=1&a,f=l-a,c&&r(t[e],e,t)&&_.push(t[e]),o=l-c;o>f;o-=2)s=n+o,r(t[s],s,t)&&_.push(t[s]),r(t[--s],s,t)&&_.push(t[s]);for(o=f;o>=0;o-=16)s=n+o,r(t[s],s,t)&&_.push(t[s]),r(t[--s],s,t)&&_.push(t[s]),r(t[--s],s,t)&&_.push(t[s]),r(t[--s],s,t)&&_.push(t[s]),r(t[--s],s,t)&&_.push(t[s]),r(t[--s],s,t)&&_.push(t[s]),r(t[--s],s,t)&&_.push(t[s]),r(t[--s],s,t)&&_.push(t[s]),r(t[--s],s,t)&&_.push(t[s]),r(t[--s],s,t)&&_.push(t[s]),r(t[--s],s,t)&&_.push(t[s]),r(t[--s],s,t)&&_.push(t[s]),r(t[--s],s,t)&&_.push(t[s]),r(t[--s],s,t)&&_.push(t[s]),r(t[--s],s,t)&&_.push(t[s]),r(t[--s],s,t)&&_.push(t[s])}else{for(a=15&h,c=1&a,c&&r(t[n],n,t)&&_.push(t[n]),o=c;a>o;o+=2)s=n+o,r(t[s],s,t)&&_.push(t[s]),r(t[++s],s,t)&&_.push(t[s]);for(o=a;h>o;o+=16)s=n+o,r(t[s],s,t)&&_.push(t[s]),r(t[++s],s,t)&&_.push(t[s]),r(t[++s],s,t)&&_.push(t[s]),r(t[++s],s,t)&&_.push(t[s]),r(t[++s],s,t)&&_.push(t[s]),r(t[++s],s,t)&&_.push(t[s]),r(t[++s],s,t)&&_.push(t[s]),r(t[++s],s,t)&&_.push(t[s]),r(t[++s],s,t)&&_.push(t[s]),r(t[++s],s,t)&&_.push(t[s]),r(t[++s],s,t)&&_.push(t[s]),r(t[++s],s,t)&&_.push(t[s]),r(t[++s],s,t)&&_.push(t[s]),r(t[++s],s,t)&&_.push(t[s]),r(t[++s],s,t)&&_.push(t[s]),r(t[++s],s,t)&&_.push(t[s])}return _},U=function(t,r,n,e,i){var u=t.length;if(arguments.length<4&&(e=u-1),0>e&&(e+=u),arguments.length<3&&(n=0),n>e)return t;var o,s,l,f,a,c,h=e-n+1;if(!0===i){for(l=h-1,a=15&h,c=1&a,f=l-a,c&&r(t[e],e,t,n,e),o=l-c;o>f;o-=2)s=n+o,r(t[s],s,t,n,e),r(t[--s],s,t,n,e);for(o=f;o>=0;o-=16)s=n+o,r(t[s],s,t,n,e),r(t[--s],s,t,n,e),r(t[--s],s,t,n,e),r(t[--s],s,t,n,e),r(t[--s],s,t,n,e),r(t[--s],s,t,n,e),r(t[--s],s,t,n,e),r(t[--s],s,t,n,e),r(t[--s],s,t,n,e),r(t[--s],s,t,n,e),r(t[--s],s,t,n,e),r(t[--s],s,t,n,e),r(t[--s],s,t,n,e),r(t[--s],s,t,n,e),r(t[--s],s,t,n,e),r(t[--s],s,t,n,e)}else{for(a=15&h,c=1&a,c&&r(t[n],n,t,n,e),o=c;a>o;o+=2)s=n+o,r(t[s],s,t,n,e),r(t[++s],s,t,n,e);for(o=a;h>o;o+=16)s=n+o,r(t[s],s,t,n,e),r(t[++s],s,t,n,e),r(t[++s],s,t,n,e),r(t[++s],s,t,n,e),r(t[++s],s,t,n,e),r(t[++s],s,t,n,e),r(t[++s],s,t,n,e),r(t[++s],s,t,n,e),r(t[++s],s,t,n,e),r(t[++s],s,t,n,e),r(t[++s],s,t,n,e),r(t[++s],s,t,n,e),r(t[++s],s,t,n,e),r(t[++s],s,t,n,e),r(t[++s],s,t,n,e),r(t[++s],s,t,n,e)}return t},C=function(t,r){for(var n=0,e=0,i=[],u=t.length,o=r.length;u>n&&o>e;)t[n]<r[e]?n++:t[n]>r[e]?e++:(i.push(t[n]),n++,e++);return i},q=function(t,r,n){var e,i,u=0,o=0,s=[],l=t.length,f=r.length;for(n=!1!==n,i=!n;l>u&&f>o;){if(n&&s.length){if(t[u]===e){u++;continue}if(r[o]===e){o++;continue}}t[u]<r[o]?s.push(e=t[u++]):t[u]>r[o]?s.push(e=r[o++]):(s.push(e=t[u]),i&&s.push(r[o]),u++,o++)}for(;l>u;)(i||t[u]!==e)&&s.push(e=t[u++]);for(;f>o;)(i||r[o]!==e)&&s.push(e=r[o++]);return s},E=function(){var t,r,n,e,i,u,o,s,l,f,a=arguments,c=a.length;if(!c)return[];for(l=a[0].length,t=1;c>t;t++)l*=a[t].length;for(f=new Array(l),t=0;l>t;t++){for(s=[],n=t,r=c-1;r>=0;r--)if(e=a[r].length,i=n%e,n=~~(n/e),o=a[r][i],o instanceof Array)for(u=o.length-1;u>=0;u--)s.unshift(o[u]);else s.unshift(o);f[t]=s}return f},I=function(){},O=function(t,r,n){var e,i,u,o,s,l=a.Arithmetic.rnd;for(o=!0===n?t.slice():t,s=!0===r?1:0,e=o.length;s<e--;)i=l(0,e-s),e!==i&&(u=o[e],o[e]=o[i],o[i]=u);return o},R=function(t,r,n){var e,i,u,o,s,l=a.Arithmetic.rnd,f=t.length;for(r=a.Arithmetic.min(r,f),e=new Array(r),n=!1!==n,n&&(i=new Array(r)),u=0;r>u;u++)o=l(0,--f),s=t[o],t[o]=t[f],t[f]=s,e[u]=s,n&&(i[u]=o);if(n)for(u=r-1;u>=0;u--)o=i[u],s=t[f],t[f]=t[o],t[o]=s,f++;return e},M=function(t,r){var n,e,i,u,o=t.length;for(n=new Array(r-o),e=0,i=0,u=0;r>e;)i>=o||e<t[i]?n[u++]=e:i++,e++;return n},L=function(t,r){if(null==t)return null;if(!t.length)return[];var n,e=t.length,i=new Array(e);if(r.length===e)for(n=0;e>n;n++)i[n]=r[n]-1-t[n];else for(n=0;e>n;n++)i[n]=r-1-t[e-1-n];return i},S=function(t){var r,n=[],e=t.length;if(e>1)for(r=e-1;r>=1;r--)n.push([t[0],t[r]]);return n},N=function(t){var r=a.Arithmetic.add;return b(t,r,0)},P=function(t){var r=a.Arithmetic.mul;return b(t,r,1)},X=function(t){return a.Arithmetic.shl(1,t)},j=function(t,r){return a.Arithmetic.pow(t,r)},T=function(t){var r=a.Arithmetic.mul;return 0>t?0:2>t?1:4>t?t<<t-2:y(r,1,2,t)},D=function(t,r){if(r>t-r&&(r=t-r),0>r||1>t)return 0;if(0===r||1===t)return 1;if(1===r)return t;var n,e=a.Arithmetic.mul,i=a.Arithmetic.add,u=t-r,o=1+u;for(n=2;r>=n;n++)o=i(o,e(o,u/n));return a.Arithmetic.round(o)},H=function Z(t,r,n,e){if(n===t&&1===r||r===t&&1===n)return 1;if(n+r>t+1||t>r*n)return 0;var i,u,o=a.Arithmetic.add,s=a.Arithmetic.min(n,t-n-r+2),l=a.Arithmetic.max(1,a.Arithmetic.ceil((t-n)/(r-1))),f=0;for(null==e&&(e={}),i=l;s>=i;i++)u=t-n+","+(r-1)+","+i,null==e[u]&&(e[u]=Z(t-n,r-1,i,e)),f=o(f,e[u]);return f},G=8,V=16,B=32,K=64,Y=128,z=256,F=512,J=G|V|B|K|Y|z|F,Q=function(t){return arguments.length&&null!=t?t.substr?(t=t.toUpperCase(),a.ORDER[_](t)?a.ORDER[t]:G):J&t?t:G:G},W=function(t){return arguments.length?function(){throw new Error('"'+t+'" not implemented')}:function(){throw new Error("Method not implemented")}};return a.Util={rnd:Math.random,rint:function(t,r){return a.Arithmetic.round((r-t)*a.Util.rnd()+t)},shuffle:O,pick:R,operate:b,operation:y,map:x,filter:k,each:U,intersection:C,union:q,kronecker:E,cartesian:I,num:function(t){return parseInt(t,10)},val:function(t){return a.Arithmetic.floor(t.valueOf())},equ:function(t,r){return t===r},gte:function(t,r){return t>=r},lte:function(t,r){return r>=t},gt:function(t,r){return t>r},lt:function(t,r){return r>t},add:function(t,r){return t+r},sub:function(t,r){return t-r},mul:function(t,r){return t*r},div:function(t,r){return a.Arithmetic.floor(t/r)},mod:function(t,r){return t%r},pow:Math.pow,shl:function(t,r){return t<<r},shr:function(t,r){return t>>r},bor:function(t,r){return t|r},band:function(t,r){return t&r},neg:function(t){return a.Arithmetic.sub(0,t)},abs:Math.abs,min:Math.min,max:Math.max,floor:Math.floor,ceil:Math.ceil,round:Math.round,gcd:function(t,r){var n,e,i=1,u=0,o=0,s=1,l=1,f=1;for(0>t&&(t=-t,l=-1),0>r&&(r=-r,f=-1),r>t&&(n=t,t=r,r=n);;){if(e=-a.Arithmetic.floor(t/r),t%=r,i+=e*o,u+=e*s,0===t)return[r*f,o,s];if(e=-a.Arithmetic.floor(r/t),r%=t,o+=e*i,s+=e*u,0===r)return[t*l,i,u]}return[]},sum:N,product:P,pow2:X,powNK:j,factorial:T,binomial:D,partitions:H},a.Arithmetic={num:a.Util.num,val:a.Util.val,equ:a.Util.equ,gte:a.Util.gte,lte:a.Util.lte,gt:a.Util.gt,lt:a.Util.lt,add:a.Util.add,sub:a.Util.sub,mul:a.Util.mul,div:a.Util.div,mod:a.Util.mod,pow:a.Util.pow,shl:a.Util.shl,shr:a.Util.shr,bor:a.Util.bor,band:a.Util.band,neg:a.Util.neg,abs:a.Util.abs,min:a.Util.min,max:a.Util.max,floor:a.Util.floor,ceil:a.Util.ceil,round:a.Util.round,rnd:a.Util.rint,gcd:a.Util.gcd},a.ORDER={LEX:G,LEXICOGRAPHIC:G,REVLEX:V,ANTILEX:V,REVERSELEXICOGRAPHIC:V,ANTILEXICOGRAPHIC:V,COLEX:B,COLEXICOGRAPHIC:B,REVCOLEX:K,ANTICOLEX:K,REVERSECOLEXICOGRAPHIC:K,ANTICOLEXICOGRAPHIC:K,RANDOM:z,RANDOMISED:z,STOCHASTIC:F},r=a.BitArray=p({constructor:function $(t){var r=this;return r instanceof $?(r.length=t,void(r.bits=new Uint32Array(a.Arithmetic.ceil(t/32)))):new $(t)},length:0,bits:null,dispose:function(){var t=this;return t.length=null,t.bits=null,t},clone:function(){var t=this,n=new r(t.length);return n.bits=new Uint32Array(t.bits),n},fromArray:function(t){var r=this;return r.bits=new Uint32Array(t),r},toArray:function(){return d.call(this.bits)},toString:function(){return x(this.toArray(),w).join("")},reset:function(){var t,r=this,n=r.bits,e=n.length;for(t=0;e>t;t++)n[t]=0;return r},isset:function(t){return!!(this.bits[t>>>5]&1<<(31&t))},set:function(t){var r=this;return r.bits[t>>>5]|=1<<(31&t),r},unset:function(t){var r=this;return r.bits[t>>>5]&=~(1<<(31&t)),r},toggle:function(t){var r=this;return r.bits[t>>>5]^=1<<(31&t),r}}),n=a.CombinatorialIterator=p({constructor:function tt(t){var r,n=this;return n instanceof tt?(r=n[h],n.n=t||0,n._count=r.count(n.n),void n.order(G)):new tt(t)},__static__:{count:W(),dual:function(t,r,n){return 0>=r?[]:L(t,r)},rank:W(),unrank:W(),first:W(),last:W(),succ:function(t,r,n,e){var i=this,u=a.Arithmetic;return-1!==t&&1!==t&&(t=1),r?i.unrank(u.add(i.rank(r,n,e),t),n,e):null},rand:function(t,r){var n=this,e=a.Arithmetic,i=r?r:n.count(t),u=e.sub(i,1),o=e.rnd(0,u);return e.equ(0,o)?n.first(t):e.equ(o,u)?n.last(t):n.unrank(o,t,i)},stochastic:W()},n:0,_order:0,_count:0,_index:null,__item:null,_item:null,_prev:null,_next:null,_traversed:null,_stochastic:null,dispose:function(){var t=this;return t.n=null,t._order=null,t._count=0,t._index=null,t.__item=null,t._item=null,t._prev=null,t._next=null,t._stochastic=null,t._traversed&&(t._traversed.dispose(),t._traversed=null),t},_store:function(){var t=this;return[t._order,t._index,t.__item,t._item,t._prev,t._next]},_restore:function(t){var r=this;return t&&(r._order=t[0],r._index=t[1],r.__item=t[2],r._item=t[3],r._prev=t[4],r._next=t[5]),r},total:function(){return this._count},order:function(t,n,e,i){var u,o,s,l=this,f=l[h];if(!arguments.length)return l._order;if(t=Q(t),l._order=t,l._index=0,l._item=l.__item=null,l._prev=!1,l._next=!1,o=l._count,s=l.n,i=!0===i,F&t)if(null==l._stochastic||n){if(!n)throw new Error("No Stochastic Transition Matrix given!");l._stochastic=[n,e?1:0,e?[]:null],l.__item=f.stochastic(l._stochastic[0],s,l._stochastic[2]),l._item=l.__item.slice()}else null!=l._stochastic[2]&&(l._stochastic[2]=[]),l.__item=f.stochastic(l._stochastic[0],s,l._stochastic[2]),l._item=l.__item.slice();else z&t?(l._traversed?l._traversed.reset():l._traversed=new r(o),l._traversed.set(u=l.randomIndex()),l.__item=l.item(u,G),l._item=null!=l.__item?l.__item.slice():null):K&t?(l.__item=i?f.last(s):f.first(s),l._item=f.dual(l.__item,s,K)):B&t?(l.__item=i?f.first(s):f.last(s),l._item=f.dual(l.__item,s,B)):V&t?(l.__item=i?f.first(s):f.last(s),l._item=null!=l.__item?l.__item.slice():null):(l.__item=i?f.last(s):f.first(s),l._item=null!=l.__item?l.__item.slice():null);return l._next=null!=l._item,l},index:function(t){if(!arguments.length)return this._index;var r,n=this,e=a.Arithmetic,i=n[h],u=n.n,o=n._count,s=n._order;return t=e.num(t),e.gt(0,t)&&(t=e.add(t,o)),e.gte(t,0)&&e.lt(t,o)&&(r=e.sub(o,1),K&s?(n._index=t,n.__item=e.equ(0,t)?i.first(u):e.equ(r,t)?i.last(u):i.unrank(t,u,o),n._item=i.dual(n.__item,u,K)):B&s?(n._index=t,n.__item=e.equ(0,t)?i.last(u):e.equ(r,t)?i.first(u):i.unrank(e.sub(r,t),u,o),n._item=i.dual(n.__item,u,B)):V&s?(n._index=t,n.__item=e.equ(0,t)?i.last(u):e.equ(r,t)?i.first(u):i.unrank(e.sub(r,t),u,o),n._item=n.__item.slice()):G&s&&(n._index=t,n.__item=e.equ(0,t)?i.first(u):e.equ(r,t)?i.last(u):i.unrank(t,u,o),n._item=n.__item.slice())),n},item:function(t,r){if(!arguments.length)return this._item;var n,e,i,u=this,o=u.n,s=u._count,l=u[h],f=a.Arithmetic;if(r=null!=r?Q(r):u._order,t=f.num(t),f.gt(0,t)&&(t=f.add(t,s)),f.gte(t,0)&&f.lt(t,s)){if(n=f.sub(s,1),z&r){for(e=u._traversed;e.isset(i=u.randomIndex()););return e.set(i),l.unrank(i,o,s)}return K&r?l.dual(f.equ(0,t)?l.first(o):f.equ(n,t)?l.last(o):l.unrank(t,o,s),o,K):B&r?l.dual(f.equ(0,t)?l.last(o):f.equ(n,t)?l.first(o):l.unrank(f.sub(n,t),o,s),o,B):V&r?f.equ(0,t)?l.last(o):f.equ(n,t)?l.first(o):l.unrank(f.sub(n,t),o,s):f.equ(0,t)?l.first(o):f.equ(n,t)?l.last(o):l.unrank(t,o,s)}return null},randomIndex:function(t,r){var n=this,e=a.Arithmetic,i=n._count,u=arguments.length;return 0===u?(t=0,r=e.sub(i,1)):1===u?(t=e.num(t||0),r=e.sub(i,1)):(t=e.num(t),r=e.num(r)),e.rnd(t,r)},random:function(){var t=this,r=t[h];return r.rand(t.n,t._count)},rewind:function(){var t=this;return t.order(t._order),t._prev=!1,t},hasNext:function(){return F&this._order?!0:this._next},next:function(){var t,r,n=this,e=a.Arithmetic,i=n._order,u=n[h],o=n._item,s=n.n,l=n._count;if(F&i)n.__item=u.stochastic(n._stochastic[0],s,n._stochastic[2]),n._item=n.__item.slice();else if(z&i)if(e.lt(e.add(n._index,1),l)){for(n._index=e.add(n._index,1),t=n._traversed;t.isset(r=n.randomIndex()););t.set(r),n.__item=n.item(r,G),n._item=null!=n.__item?n.__item.slice():null,n._next=null!=n.__item}else n._next=!1,n._traversed&&(n._traversed.dispose(),n._traversed=null);else K&i?(n.__item=u.succ(1,n.__item,s,l),n._item=u.dual(n.__item,s,K)):B&i?(n.__item=u.succ(-1,n.__item,s,l),n._item=u.dual(n.__item,s,B)):V&i?(n.__item=u.succ(-1,n.__item,s,l),n._item=null!=n.__item?n.__item.slice():null):(n.__item=u.succ(1,n.__item,s,l),n._item=null!=n.__item?n.__item.slice():null),n._next=null!=n.__item,n._next&&(n._index=e.add(n._index,1));return o},forward:function(){var t=this,r=a.Arithmetic;return t.order(t._order,null,null,!0),t._prev=r.gte(t._index,0),t._next=!1,t},hasPrev:function(){return(z|F)&this._order?!1:this._prev},prev:function(){var t=this,r=a.Arithmetic,n=t._order,e=t[h],i=t._item,u=t.n,o=t._count;return(z|F)&n?null:(K&n?(t.__item=e.succ(-1,t.__item,u,o),t._item=e.dual(t.__item,u,K)):B&n?(t.__item=e.succ(1,t.__item,u,o),t._item=e.dual(t.__item,u,B)):V&n?(t.__item=e.succ(1,t.__item,u,o),t._item=null!=t.__item?t.__item.slice():null):(t.__item=e.succ(-1,t.__item,u,o),t._item=null!=t.__item?t.__item.slice():null),t._prev=null!=t.__item,t._prev&&(t._index=r.sub(t._index,1)),i)},range:function(t,r){var n,e,i,u,o,s=this,l=a.Arithmetic,f=s._count,c=1,h=arguments.length,_=l.sub(f,1);if(1>h?(t=0,r=_):2>h?(t=l.num(t),r=_):(t=l.num(t),r=l.num(r)),l.lt(t,0)&&(t=l.add(t,f)),l.lt(r,0)&&(r=l.add(r,f)),l.gt(t,r)&&(n=t,t=r,r=n,c=-1),l.lt(t,0)&&(t=0),l.gt(r,_)&&(r=_),l.lte(t,r)){if(o=s._store(),(F|z)&s._order||s.index(t),i=l.val(l.sub(r,t)),e=new Array(i+1),0>c)for(u=i;u>=0;u--)e[u]=s.next();else for(u=0;i>=u;u++)e[u]=s.next();s._restore(o)}else e=[];return e}}),e=a.Permutation=p(n,{constructor:function rt(t){var r=this;return r instanceof rt?void n.call(r,t):new rt(t)},__static__:{count:function(t){return T(t)},dual:n.dual,rank:function(t,r){var n,e,i,u,o=a.Arithmetic,s=0,l=o.ceil(g(r)),f=(1<<1+l)-1,c=new Array(f),h=o.shl(1,l);for(n=0;f>n;n++)c[n]=0;for(n=0;r>n;n++){for(u=t[n],i=o.val(o.add(h,u)),e=0;l>e;e++)1&i&&(u=o.sub(u,c[i>>>1<<1])),c[i]=o.add(c[i],1),i>>>=1;c[i]=o.add(c[i],1),s=o.add(o.mul(s,o.sub(n)),u)}return s},unrank:function(t,r,n){var e,i,u,o,s,l,f,c,h,_,d,m,v=a.Arithmetic,p=this;if(n=n||T(r),v.equ(0,t))return p.first(r);if(v.equ(n,v.add(t,1)))return p.last(r);for(e=new Array(r),i=v.div(n,r),h=v.ceil(g(r)),_=(1<<1+h)-1,d=new Array(_),m=v.shl(1,h),u=0;h>=u;u++)for(o=1,s=1<<u;s>=o;o++)d[s-1+o]=v.shl(1,v.sub(h,u));for(c=r-1,u=0;r>u;u++){for(l=v.div(t,i),f=1,o=0;h>o;o++)d[f]=v.sub(d[f],1),f<<=1,v.gte(l,d[f])&&(l=v.sub(l,d[f]),f++);d[f]=0,e[u]=v.val(v.sub(f,m)),c&&(t=v.mod(t,i),i=v.div(i,c),c--)}return e},first:function(t){var r,n=new Array(t);for(r=0;t>r;r++)n[r]=r;return n},last:function(t){var r,n=new Array(t);for(r=0;t>r;r++)n[r]=t-1-r;return n},succ:function(t,r,n){if(r){var e,i,u,o,s,l=r.slice();if(-1===t){for(e=n-2;e>=0&&l[e]<=l[e+1];)e--;if(e>=0){for(i=n-1;i>e&&l[e]<=l[i];)i--;for(s=l[e],l[e]=l[i],l[i]=s,u=e+1,o=n-1;o>u;)s=l[u],l[u++]=l[o],l[o--]=s}else l=null}else{for(e=n-2;e>=0&&l[e]>=l[e+1];)e--;if(e>=0){for(i=n-1;i>e&&l[e]>=l[i];)i--;for(s=l[e],l[e]=l[i],l[i]=s,u=e+1,o=n-1;o>u;)s=l[u],l[u++]=l[o],l[o--]=s}else l=null}return l}return null},rand:function(t){var r,n=new Array(t);for(r=0;t>r;r++)n[r]=r;return O(n)},stochastic:function(t,r,n){if(t.length!==r||t[0].length!==r)throw new Error("Stochastic Matrix dimensions and Permutation dimensions do not match!");var e,i,u,o,s,l,f,c,h=new Array(r),_=new Array(r),d=0,m=a.Util.rnd,v=!1;for(i=0;r>i;i++)_[i]=0;if(n){if(v=!0,!n.length){for(n.N=0,e=new Array(r),i=0;r>i;i++)e[i]=0;for(i=0;r>i;i++)n.push(e.slice())}d=++n.N}for(c=!v,i=0;r>i;)for(o=m(),f=0,s=t[i],v&&(l=n[i]),u=0;r>u;u++){if(o>f&&o<=f+s[u]){0===_[u]&&(c||l[u]+1<=(d+1)*s[u])&&(_[u]=1,h[i]=u,v&&l[u]++,i++);break}f+=s[u]}return h},inverse:function(t,r){r=r||t.length;var n,e=new Array(r);for(n=0;r>n;n++)e[t[n]]=n;return e},compose:function(){var t,r,n,e=arguments,i=e.length,u=i?e[0]:[],o=u.length;for(r=1;i>r;r++)for(n=u.slice(),t=0;o>t;t++)u[t]=n[e[r][t]];return u},permute:function(t,r,n){var e,i,u,o=t.length;for(!0===n?(i=new Array(o),u=t):(i=t,u=t.slice()),e=0;o>e;e++)i[e]=u[r[e]];return i},reassign:function(t,r){var n,e=t.length,i=new Array(e);for(n=0;e>n;n++)i[n]=r[t[n]];return i},shuffle:O,toCycles:function(t,r,n){r=r||t.length;var e,i,u,o=[],s=!0===n?1:0,l=new Array(r),f=new Array(r);for(e=0;r>e;e++)f[e]=e,l[e]=0;for(u=[i=f.shift()],l[i]=1;f.length;){if(i=t[i],l[i])for(u.length>s&&o.push(u),u=[];f.length&&l[i=f.shift()];);l[i]||(u.push(i),l[i]=1)}return u.length>s&&o.push(u),o},fromCycles:function(t,r){var n,e,i,u,o=new Array(r),s=t.length;for(e=0;r>e;e++)o[e]=e;for(n=0;s>n;n++)if(u=t[n],i=u.length,!(2>i)){for(e=0;i-1>e;e++)o[u[e]]=u[e+1];o[u[i-1]]=u[0]}return o},toSwaps:function(t,r){r=r||t.length;var n,i,u,o=[],s=e.toCycles(t,r,!0);for(n=0,i=s.length;i>n;n++)u=s[n],o=o.concat(S(u));return o},fromSwaps:function(t,r){var n,e,i,u=t.length,o=new Array(r);for(n=0;r>n;n++)o[n]=n;for(n=0;u>n;n++)e=t[n],i=o[e[0]],o[e[0]]=o[e[1]],o[e[1]]=i;return o},toMatrix:function(t,r,n){var e,i,u=new Array(r);for(n=!0===n,e=0;r>e;e++)for(u[e]=new Array(r),i=0;r>i;i++)u[e][i]=0;for(e=0;r>e;e++)n?u[t[e]][e]=1:u[e][t[e]]=1;return u},fromMatrix:function(t,r,n){var e,i,u=new Array(r);for(n=!0===n,e=0;r>e;e++)for(i=0;r>i;i++)t[e][i]&&(n?u[i]=e:u[e]=i);return u},isConnected:function(t,r){var n,e=-(1/0);for(r=r||t.length,n=0;r-1>n;n++)if(t[n]>e&&(e=t[n]),n>=e)return!1;return!0}}}),i=a.Combination=p(n,{constructor:function nt(t,r){var e=this;return e instanceof nt?void n.call(e,[t,r]):new nt(t,r)},__static__:{count:function(t){return D(t[0],t[1])},dual:function(t,r){return L(t,r[0])},rank:function(t,r,n){var e,i,u,o,s,l=a.Arithmetic,f=0;for(o=r[1],r=r[0],s=n?n:D(r,o),e=1;o>=e;e++)i=r-1-t[e-1],u=o+1-e,i>=u&&(f=l.add(f,D(i,u)));return l.sub(l.sub(s,1),f)},unrank:function(t,r,n){var e,i,u,o,s,l,f=a.Arithmetic,c=this;if(n=n||D(r[0],r[1]),f.equ(0,t))e=c.first(r);else if(f.equ(n,f.add(t,1)))e=c.last(r);else{u=r[1],r=r[0],e=new Array(u),i=n,t=f.sub(f.sub(i,1),t),i=f.mul(f.sub(r,u),f.div(i,r)),s=r-u+1,o=u,l=r-1;do f.lte(i,t)?(e[u-o]=r-s-o+1,f.gt(i,0)&&(t=f.sub(t,i),i=f.div(f.mul(o,i),l)),o--,l--):(i=f.div(f.mul(f.sub(l,o),i),l),s--,l--);while(o>0)}return e},first:function(t){var r,n=t[1],e=new Array(n);for(r=0;n>r;r++)e[r]=r;return e},last:function(t){var r,n=t[1],e=new Array(n);for(t=t[0],r=0;n>r;r++)e[n-1-r]=t-1-r;return e},succ:function(t,r,n){if(r){var e,i,u,o,s,l=r.slice();if(e=n[1],n=n[0],-1===t){for(i=e-1,u=-1;i>0;){if(l[i]>l[i-1]+1){u=i;break}i--}if(-1===u&&0<l[0]&&(u=0),u>-1){for(s=n,i=e-1;i>u;i--)l[i]=--s;l[u]--}else l=null}else{for(i=e-1,u=-1,o=n-e;i>=0;){if(l[i]<o+i){u=i;break}i--}if(u>-1)for(s=l[u],i=u;e>i;i++)l[i]=++s;else l=null}return l}return null},rand:function(t){var r,n,e,i,u,o,s,l;for(n=t[1],t=t[0],r=new Array(n),e=a.Util.rnd(),u=0,s=0,l=t-n,i=1;n>=i;i++){for(u++,o=(n-i+1)/(t-u+1);e>=o&&l+i>u;)s=o,u++,o=s+(1-s)*((n-i+1)/(t-u+1));r[i-1]=u-1,e=(e-s)/(o-s)}return r},stochastic:n.stochastic,complement:M,choose:function(t,r){var n,e=r.length,i=new Array(e);for(n=0;e>n;n++)i[n]=t[r[n]];return i},pick:R,toMatrix:function(t,r,n){var e,i,u,o;for(i=r[1],r=r[0],e=new Array(r),n=!0===n,u=0;r>u;u++)for(e[u]=new Array(r),o=0;r>o;o++)e[u][o]=0;for(u=0;i>u;u++)n?e[t[u]][u]=1:e[u][t[u]]=1;return e},fromMatrix:function(t,r,n){var e,i,u,o;for(i=r[1],r=r[0],e=new Array(i),n=!0===n,u=0;r>u;u++)for(o=0;r>o;o++)t[u][o]&&(n&&i>o?e[o]=u:!n&&i>u&&(e[u]=o));return e}}}),i.conjugate=i.complement,u=a.CombinationRepeat=p(n,{constructor:function et(t,r){var e=this;return e instanceof et?void n.call(e,[t,r]):new et(t,r)},__static__:{count:function(t){return D(t[0]+t[1]-1,t[1])},dual:i.dual,rank:function(t,r,n){var e,i,u,o,s,l,f=a.Arithmetic,c=0;for(o=r[1],r=r[0],s=r+o-1,l=n?n:D(s,o),e=1;o>=e;e++)i=s-1-t[e-1]-e+1,u=o+1-e,i>=u&&(c=f.add(c,D(i,u)));return f.sub(f.sub(l,1),c)},unrank:function(t,r,n){var e,i,u,o,s,l,f,c=a.Arithmetic,h=this;if(n=n||D(r[0]+r[1]-1,r[1]),c.equ(0,t))return h.first(r);if(c.equ(n,c.add(t,1)))return h.last(r);u=r[1],r=r[0],o=r+u-1,e=new Array(u),i=n,t=c.sub(c.sub(i,1),t),i=c.mul(c.sub(o,u),c.div(i,o)),l=o-u+1,s=u,f=o-1;do c.lte(i,t)?(e[u-s]=o-l-u+1,c.gt(i,0)&&(t=c.sub(t,i),i=c.div(c.mul(i,s),f)),s--,f--):(i=c.div(c.sub(f,s),f),l--,f--);while(s>0);return e},first:function(t){var r,n=t[1],e=new Array(n);for(r=0;n>r;r++)e[r]=0;return e},last:function(t){var r,n=t[1],e=new Array(n);for(t=t[0]-1,r=0;n>r;r++)e[r]=t;return e},succ:function(t,r,n){if(r){var e,i,u,o,s=r.slice();if(e=n[1],n=n[0],-1===t){for(i=e-1,u=-1;i>0;){if(s[i]>s[i-1]){u=i;break}i--}if(-1===u&&0<s[0]&&(u=0),u>-1){for(o=n-1,i=u+1;e>i;i++)s[i]=o;s[u]--}else s=null}else{for(i=e-1,u=-1;i>=0;){if(s[i]<n-1){u=i;break}i--}if(u>-1)for(o=s[u]+1,i=u;e>i;i++)s[i]=o;else s=null}return s}return null},rand:function(t){var r,n,e,i,u,o,s,l,f;for(n=t[1],t=t[0],r=new Array(n),e=a.Util.rnd(),u=0,s=0,l=t+n-1,f=l-n,i=1;n>=i;i++){for(u++,o=(n-i+1)/(l-u+1);e>=o&&f+i>u;)s=o,u++,o=s+(1-s)*((n-i+1)/(l-u+1));r[i-1]=u-i,e=(e-s)/(o-s)}return r},stochastic:i.stochastic}}),o=a.Partition=p(n,{constructor:function it(t){var r=this;return r instanceof it?void n.call(r,t):new it(t)},__static__:{count:function(t){var r,n,e=a.Arithmetic.add,i=t>1?2:1;for(r=2;t>r;r++)for(n=t-r+1;n>=1;n--)i=e(i,H(t,r,n));return i},dual:function(t,r){var n,e,i=[],u=t.length;for(n=0;u>n;n++)if(e=r-t[n],!(0>=e)){if(r===e)return[r];i.unshift(e)}return i},rank:function(t,r,n,e,i){var u,o,s,l=a.Arithmetic,f=this,c=t.length,h=r;return n=n||f.count(r),e=e||0,i=i||c,o=e,s=t[o],u=h===s?l.sub(n,1):1===s?0:c>o+1?l.add(1,f.rank(t,r-s,l.sub(n,f.count(r-s)),o+1)):0},unrank:function(t,r,n){},first:function(t){var r,n=new Array(t);for(r=0;t>r;r++)n[r]=1;return n},last:function(t){return[t]},succ:function(t,r,n){if(r){var e,i,u,o,s,l,f=r.slice();if(-1===t)if(f[0]>1){for(i=f.length,e=i-1;e>=0&&1===f[e];)e--;for(u=f[e]-1,f=f.slice(0,e+1),f[e]=u,s=N(f),l=n-s;l>0;)o=l,o>u?(o=u,f.push(o)):f.push(l),l-=o}else f=null;else if(f[0]<n){for(i=f.length,e=i-1,e>0&&e--;e>0&&f[e]===f[e-1];)e--;for(f[e]++,f=f.slice(0,e+1),s=N(f),l=n-s;l>0;)f.push(1),l--}else f=null;return f}return null},rand:function(t){},stochastic:n.stochastic,conjugate:function(t){var r,n,e,i=t.length,u=t[0],o=new Array(u);for(r=0;u>r;r++)o[r]=1;for(n=1;i>n;n++)for(r=0,e=t[n];u>r&&e>0;)o[r++]++,e--;return o},pack:function(t){var r,n=[],e=t.length,i=t[0],u=[i,1];for(r=1;e>r;r++)i===t[r]?u[1]++:(n.push(u),i=t[r],u=[i,1]);return n.push(u),n},unpack:function(t){var r,n,e,i,u,o=[],s=t.length;for(r=0;s>r;r++)if(u=t[r],1===u[1])o.push(u[0]);else for(e=u[1],i=u[0],n=0;e>n;n++)o.push(i);return o}}}),o.transpose=o.conjugate,s=a.Powerset=p(n,{constructor:function ut(t){var r=this;return r instanceof ut?void n.call(r,t):new ut(t)},__static__:{count:function(t){return X(t)},dual:n.dual,rank:function(t){for(var r=a.Arithmetic,n=0,e=0,i=t.length;i>e;)n=r.add(n,r.shl(1,t[e++]));return n},unrank:function(t){for(var r=a.Arithmetic,n=[],e=0;r.gt(t,0);)r.gt(r.band(t,1),0)&&n.unshift(e),r.gt(r.band(t,2),0)&&n.unshift(e+1),r.gt(r.band(t,4),0)&&n.unshift(e+2),r.gt(r.band(t,8),0)&&n.unshift(e+3),r.gt(r.band(t,16),0)&&n.unshift(e+4),r.gt(r.band(t,32),0)&&n.unshift(e+5),r.gt(r.band(t,64),0)&&n.unshift(e+6),r.gt(r.band(t,128),0)&&n.unshift(e+7),e+=8,t=r.shr(t,8);return n},first:function(t){return[]},last:function(t){var r,n=new Array(t);for(r=0;t>r;r++)n[r]=t-1-r;return n},succ:function(t,r,n){var e=this,i=a.Arithmetic;return 1!==t&&-1!==t&&(t=1),-1===t?0===r.length?null:e.unrank(i.add(e.rank(r),t)):n===r.length?null:e.unrank(i.add(e.rank(r),t))},rand:n.rand,stochastic:n.stochastic}}),l=a.Tensor=p(n,{constructor:function ot(){var t=this;return t instanceof ot?void(arguments.length?n.call(t,d.call(arguments)):(t.n=[],t._count=0)):(t=new ot,arguments.length?n.call(t,d.call(arguments)):(t.n=[],t._count=0),t)},__static__:{count:function(t){return t&&t.length?P(t):0},dual:n.dual,rank:function(t,r){var n,e,i=a.Arithmetic,u=r,o=u.length;if(!o)return-1;for(n=0,e=0;o>e;e++)n=i.add(i.mul(n,u[e]),t[e]);return n},unrank:function(t,r){var n,e,i,u,o,s=a.Arithmetic,l=r,f=l.length;if(!f)return[];for(o=new Array(f),n=t,i=f-1;i>=0;i--)e=l[i],u=s.mod(n,e),n=s.div(n,e),o[i]=s.val(u);return o},first:function(t){var r,n=t.length,e=new Array(n);for(r=0;n>r;r++)e[r]=0;return e},last:function(t){var r,n=t,e=n.length,i=new Array(e);for(r=0;e>r;r++)i[r]=n[r]-1;return i},succ:function(t,r,n){if(r){var e,i,u=r.slice(),o=n,s=o.length;if(-1===t){for(e=s-1;e>=0&&u[e]-1<0;)e--;if(e>=0)for(u[e]--,i=e+1;s>i;i++)u[i]=o[i]-1;else u=null}else{for(e=s-1;e>=0&&u[e]+1===o[e];)e--;if(e>=0)for(u[e]++,i=e+1;s>i;i++)u[i]=0;else u=null}return u}return null},rand:function(t){var r,n=a.Arithmetic.rnd,e=t,i=e.length,u=new Array(i);for(r=0;i>r;r++)u[r]=n(0,e[r]-1);return u},stochastic:n.stochastic,product:E,component:function(t,r){var n,e,i,u,o,s,l=[],f=r,a=f.length;for(n=0;a>n;n++)if(i=f[n],o=t[n],u=i[o],u instanceof Array)for(e=0,s=u.length;s>e;e++)l.push(u[e]);else l.push(u);return l}}}),f=a.Tuple=p(n,{constructor:function st(t,r){var e=this;return e instanceof st?void n.call(e,[t||1,r||2]):new st(t,r)},__static__:{count:function(t){return j(t[1],t[0])},dual:function(t,r){return L(t,r[1])},rank:function(t,r){var n,e,i=a.Arithmetic,u=r[0];for(r=r[1],n=0,e=0;u>e;e++)n=i.add(i.mul(n,r),t[e]);return n},unrank:function(t,r){var n,e,i,u,o,s=a.Arithmetic,l=r[0];for(r=r[1],o=new Array(l),n=t,i=l-1;i>=0;i--)e=r,u=s.mod(n,e),n=s.div(n,e),o[i]=s.val(u);return o},first:function(t){var r,n=t[0],e=new Array(n);for(r=0;n>r;r++)e[r]=0;return e},last:function(t){var r,n=t[0],e=new Array(n);for(t=t[1]-1,r=0;n>r;r++)e[r]=t;return e},succ:function(t,r,n){if(r){var e,i,u=r.slice(),o=n[0],n=n[1];if(-1===t){for(e=o-1;e>=0&&u[e]-1<0;)e--;if(e>=0)for(u[e]--,i=e+1;o>i;i++)u[i]=n-1;else u=null}else{for(e=o-1;e>=0&&u[e]+1===n;)e--;if(e>=0)for(u[e]++,i=e+1;o>i;i++)u[i]=0;else u=null}return u}return null},rand:function(t){var r,n=a.Arithmetic.rnd,e=t[0],i=new Array(e);for(t=t[1]-1,r=0;e>r;r++)i[r]=n(0,t);return i},stochastic:l.stochastic}}),a});