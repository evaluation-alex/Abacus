/**
*
*   Abacus
*   A combinatorics library for Node/XPCOM/JS, PHP, Python, Java, C/C++
*   @version: 0.8.8
*   https://github.com/foo123/Abacus
**/
!function(n,e,t){"use strict";"undefined"!=typeof Components&&"object"==typeof Components.classes&&"object"==typeof Components.classesByID&&Components.utils&&"function"==typeof Components.utils.import?(n.$deps=n.$deps||{})&&(n.EXPORTED_SYMBOLS=[e])&&(n[e]=n.$deps[e]=t.call(n)):"object"==typeof module&&module.exports?(module.$deps=module.$deps||{})&&(module.exports=module.$deps[e]=t.call(n)):"undefined"!=typeof System&&"function"==typeof System.register&&"function"==typeof System.import?System.register(e,[],function(r){r(e,t.call(n))}):"function"==typeof define&&define.amd&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(e)?define(e,["module"],function(e){return t.moduleUri=e.uri,t.call(n)}):e in n||(n[e]=t.call(n)||1)&&"function"==typeof define&&define.amd&&define(function(){return n[e]})}(this,"Abacus",function(n){"use strict";function e(){throw new Error("Method not implemented!")}function t(n){return n instanceof Array||"[object Array]"===In.call(n)}function r(n){return n instanceof String||"[object String]"===In.call(n)}function u(n){return"function"==typeof n}function o(n){var e=n.toString(2),t=32-e.length;return t>0?new Array(t+1).join("0")+e:e}function s(n,e,r,u,l,i,o){var s,a,f,c,d,m,h,p,_=e,g=null,b=r&&t(r);if(b&&(null==u&&(u=0),null==l&&(l=r.length-1)),null==i&&(i=u>l?-1:1),0===i||b&&!r.length||0>=xn.floor((l-u)/i)+1)return _;if(0>i?((p=(u-l)%-i)&&(g=l),m=l+=p,h=u,c=-1,f=-(-i<<4)):((p=(l-u)%i)&&(g=l),m=u,h=l-=p,c=1,f=i<<4),d=u+i*(15&xn.floor((l-u)/i+1)),b){for(m=xn.max(0,m),h=xn.min(r.length-1,h),s=u;m<=s&&s<=h&&0<c*(d-s);s+=i)_=n(_,r[s],s);for(a=d;m<=a&&a<=h;a+=f)_=n(_=n(_=n(_=n(_=n(_=n(_=n(_=n(_=n(_=n(_=n(_=n(_=n(_=n(_=n(_=n(_,r[s=a],s),r[s+=i],s),r[s+=i],s),r[s+=i],s),r[s+=i],s),r[s+=i],s),r[s+=i],s),r[s+=i],s),r[s+=i],s),r[s+=i],s),r[s+=i],s),r[s+=i],s),r[s+=i],s),r[s+=i],s),r[s+=i],s),r[s+=i],s);!0===o&&null!==g&&0<=g&&g<r.length&&(_=n(_,r[g],g))}else{for(s=u;m<=s&&s<=h&&0<c*(d-s);s+=i)_=n(_,s,s);for(a=d;m<=a&&a<=h;a+=f)_=n(_=n(_=n(_=n(_=n(_=n(_=n(_=n(_=n(_=n(_=n(_=n(_=n(_=n(_=n(_=n(_,s=a,s),s+=i,s),s+=i,s),s+=i,s),s+=i,s),s+=i,s),s+=i,s),s+=i,s),s+=i,s),s+=i,s),s+=i,s),s+=i,s),s+=i,s),s+=i,s),s+=i,s),s+=i,s);!0===o&&null!==g&&(_=n(_,g,g))}return _}function a(n,e,r){var l=t(n)?n:(n|=0)>0?new Array(n):[];if(0<(n=l.length)&&null!=e){r=r||0;var i=e;s(u(e)?function(n,t,r){return n[r]=e(r),n}:e===+e?function(n,e,t){return n[t]=i,i+=r,n}:function(n,t,r){return n[r]=e,n},l,l)}return l}function f(n,e,t){return s(function(n,e,r){return n[r]=e[t],n},n,e)}function c(n,e,r,u,l){return null==e?n:s(t(r)?function(n,e,t){return n[t]=r[t]-1-e,n}:function(n,e,t){return n[t]=r-1-e,n},n,e,u,l)}function d(n,e,t,r,u){if(null==e)return n;if(null==r&&(r=0),null==u&&(u=e.length-1),n!==e||r<u)for(var l,i=r,o=u;i<=o;i++,o--)l=e[i],n[i]=e[o],n[o]=l;return n}function m(n,e){return null==e&&(e=0),t(n)?a(n,t(e)?function(t){return e[t]-1-n[n.length-1-t]}:function(t){return e-n[t]}):n===+n&&e===+e?e-n:yn.Arithmetic.sub(yn.Arithmetic.N(e),n)}function h(n,e,r,u,l){if(null==e)return n;var i=0;return s(t(r)?function(n,e,t){return n[t]=r[t]>0?(e+i)%r[t]:0,i+=r[t]-n[t],n}:function(n,e,t){return n[t]=(e+i)%r,i+=r-n[t],n},n,e,u,l)}function p(n,e,t,r,u){return null==e?n:(null==u&&(u=e.length-1),null==r&&(r=0),n!==e||0!==t?s(function(n,e,r){return n[r+t]=e,n},n,e,0>t?r:u,0>t?u:r,0>t?1:-1):n)}function _(n,e,t,r,u,l,i,o){if(null==e)return null;null==t&&(t=1),null==r&&(r=0),null==u&&(u=0),null==l&&(l=e.length-1),null==i&&(i=u),null==o&&(o=l);var a=0,f=i>o?-1:1,c=i;return s(function(n,e,u){return e=r+t*e,n[c]=e-a,a=e,c+=f,n},n,e,u,l)}function g(n,e,t,r,u,l,i,o){if(null==e)return null;null==t&&(t=1),null==r&&(r=0),null==u&&(u=0),null==l&&(l=e.length-1),null==i&&(i=u),null==o&&(o=l);var a=0,f=i>o?-1:1,c=i;return s(function(n,e,u){return a+=e,n[c]=r+t*a,c+=f,n},n,e,u,l)}function b(n,e,t,r,u,l,i,o,s){s=!0===s,r=-1===r?-1:1,null==u&&(u=0),null==l&&(l=e===+e?e-1:e.length-1),null==i&&(i=0),null==o&&(o=t?t.length-1:-1);var f=u>l?-1:1,c=i>o?-1:1,d=f*(l-u)+1,m=u,h=i,p=0;if(!t||!t.length)return e===+e?a(e,u,f):e?e.slice():e;if(null==n&&(n=new Array(s?2*d:d)),e===+e){for(;0<=f*(l-m)&&0<=c*(o-h);)m===t[h]?(s&&(n[p++]=m),m+=f,h+=c):1===r&&m>t[h]||-1===r&&m<t[h]?h+=c:(n[p++]=m,m+=f);for(;0<=f*(l-m);)n[p++]=m,m+=f}else{for(;0<=f*(l-m)&&0<=c*(o-h);)e[m]===t[h]?(s&&(n[p++]=e[m]),m+=f,h+=c):1===r&&e[m]>t[h]||-1===r&&e[m]<t[h]?h+=c:(n[p++]=e[m],m+=f);for(;0<=f*(l-m);)n[p++]=e[m],m+=f}return p<n.length&&(n.length=p),n}function v(n,e,t,r,u,l,i,o,s,a,f){r=-1===r?-1:1,null==u&&(u=0),null==l&&(l=e.length-1),null==i&&(i=0),null==o&&(o=t.length-1),!0===s?a=!1:(s=!1,a=!1!==a),f=!0===f;var c=u>l?-1:1,d=i>o?-1:1,m=c*(l-u)+1+(d*(o-i)+1),h=u,p=i,_=0,g=null,b=!a;if(null==n&&(n=new Array(m)),0===n.length)return f?e:n;for(;0<=c*(l-h)&&0<=d*(o-p);){if(a&&_){if(e[h]===g){h+=c;continue}if(t[p]===g){p+=d;continue}}s?1===r&&e[h][0]<t[p][0]||-1===r&&e[h][0]>t[p][0]?(n[_++]=g=e[h],h+=c):1===r&&e[h][0]>t[p][0]||-1===r&&e[h][0]<t[p][0]?(n[_++]=g=t[p],p+=d):(1===r&&e[h][1]<t[p][1]||-1===r&&e[h][1]>t[p][1]?(n[_++]=g=e[h],b&&(n[_++]=t[p])):(n[_++]=g=t[p],b&&(n[_++]=e[h])),h+=c,p+=d):1===r&&e[h]<t[p]||-1===r&&e[h]>t[p]?(n[_++]=g=e[h],h+=c):1===r&&e[h]>t[p]||-1===r&&e[h]<t[p]?(n[_++]=g=t[p],p+=d):(n[_++]=g=e[h],b&&(n[_++]=t[p]),h+=c,p+=d)}for(;0<=c*(l-h);)(b||e[h]!==g)&&(n[_++]=g=e[h],h+=c);for(;0<=d*(o-p);)(b||t[p]!==g)&&(n[_++]=g=t[p],p+=d);if(f){for(h=0>c?l:u,_=0;_<m;_++,h++)e[h]=n[_];return e}return _<n.length&&(n.length=_),n}function y(n,e,t,r,u){var l,i,o,s,a,f,c,d,m;for(r[0]=-1,r[1]=-1,r[2]=0,r[3]=-1,r[4]=-1,r[5]=0,f=0,m=0,s=e,a=-1,l=u?n[s][0]:n[s],o=s+1;o<=t;o++){if(i=u?n[o][0]:n[o],l<i){if(-1===f){a=o-1;break}0===f&&(f=1)}else if(l>i){if(1===f){a=o-1;break}0===f&&(f=-1)}l=i}if(0===f&&(f=1),-1===a)a=t,r[0]=s,r[1]=a,r[2]=f;else{for(c=a+1,d=-1,l=u?n[c][0]:n[c],o=c+1;o<=t;o++){if(i=u?n[o][0]:n[o],l<i){if(-1===m){d=o-1;break}0===m&&(m=1)}else if(l>i){if(1===m){d=o-1;break}0===m&&(m=-1)}l=i}-1===d&&(d=t),0===m&&(m=1),r[0]=s,r[1]=a,r[2]=f,r[3]=c,r[4]=d,r[5]=m}}function x(n,e,t,r,u,l){null==u&&(u=0),null==l&&(l=n.length-1);var i=u>l?-1:1,o=i*(l-u)+1;if(r=!0===r,1>=o)return r?1===o?[u]:[]:n;e=-1===e?-1:1;var a,c,m,h,p,_=o,g=1,b=2,x=xn.min,A=new Array(o);if(r&&(n=s(function(n,e,t){return n[t-u]=[e,t],n},new Array(o),n,u,l,1),u=0,l=o-1),!0===t){h=u,p=-1,a=[-1,-1,0,-1,-1,0];do{y(n,u,l,a,r),-1===a[3]?(e!==a[2]&&u<l&&d(n,n,u,l),c=u,m=l):(a[2]=e!==a[2]?1:0,a[5]=e!==a[5]?1:0,v(A,n,n,e,a[2]?a[1]:a[0],a[2]?a[0]:a[1],a[5]?a[4]:a[3],a[5]?a[3]:a[4],r,!1,!0),c=a[0],m=a[4]),-1!==p&&v(A,n,n,e,h,p,c,m,r,!1,!0),p=m,u=m+1}while(u<=l)}else for(;0<_;)s(function(t,l){v(A,n,n,e,u+i*l,u+i*(l+g-1),u+i*(l+g),u+i*x(l+b-1,o-1),r,!1,!0)},null,null,0,o-g-1,b),g<<=1,b<<=1,_>>=1;return r?f(n,n,1):n}function A(n,e,t,r){var u,l,i,o=n.length;if(null==t&&(t=0),null==r&&(r=o-1),null==e||0===e){for(e=0,l=n[t],u=t+1;u<=r;u++){if(i=n[u],l<i){if(-1===e)return 0;0===e&&(e=1)}else if(l>i){if(1===e)return 0;0===e&&(e=-1)}l=i}return 0===e?1:e}if(e=-1===e?-1:1,t>=r)return e;if(-1===e)for(l=n[t],u=t+1;u<=r;u++){if(i=n[u],l<i)return 0;l=i}else for(l=n[t],u=t+1;u<=r;u++){if(i=n[u],l>i)return 0;l=i}return e}function w(n,e,r,u){var l,i=yn.Math.rndInt,o=!0===e?1:0;return t(r)?1<(l=r.length)&&s(function(n){if(o<l--){var e=i(0,l-o),t=n[r[l]];n[r[l]]=n[r[e]],n[r[e]]=t}return n},n,r,0,l-1):(null==r&&(r=0),null==u&&(u=n.length-1),1<(l=u-r+1)&&s(function(n){if(o<l--){var e=i(0,l-o),t=n[r+l];n[r+l]=n[r+e],n[r+e]=t}return n},n,n,0,l-1)),n}function O(n,e,t,r,u,l,i){null==l&&(l=0),null==i&&(i=n.length-1);var o,s,a,f,c=yn.Math.rndInt,d=i-l+1;if(e=xn.min(e,d),t=!0===t,o=new Array(e),!0===r){for(d-=1,s=0;s<e;s++)o[s]=n[l+c(0,d)];return t&&x(o),o}for(s=0;s<e;s++)f=n[l+(a=c(0,--d))],n[l+a]=n[l+d],n[l+d]=f,o[s]=f,u&&(u[s]=a);if(u)for(s=e-1;s>=0;s--)a=u[s],f=n[l+d],n[l+d]=n[l+a],n[l+a]=f,d++;return t&&x(o),o}function M(n,e){return n+e}function I(n,e,t,r){return s(yn.Arithmetic.add,yn.Arithmetic.O,n,e,t,r)}function S(n){var e=yn.Arithmetic;return e.shl(e.I,e.N(n))}function q(n,e){var r,u=yn.Arithmetic,l=u.O,i=u.I,o=u.J,a=u.N,f=u.add,c=(u.sub,u.div),d=u.mul;return null==e?10>=n?0>n?l:0===n?i:a([1,2,6,24,120,720,5040,40320,362880,3628800][n-1]):(r=String(n),null==q.mem1[r]&&(q.mem1[r]=d(q(n-1),n)),q.mem1[r]):!1===e?10>=n?2>n?l:a([1,2,9,44,265,1854,14833,133496,1334961][n-2]):(r="!"+String(n),null==q.mem2[r]&&(q.mem2[r]=f(1&n?o:i,d(q(n-1,!1),n))),q.mem2[r]):!0===e?10>=n?0>n?l:0===n?i:a([1,2,4,10,26,76,232,764,2620,9496][n-1]):(r="I"+String(n),null==q.mem2[r]&&(q.mem2[r]=f(q(n-1,!0),d(q(n-2,!0),n-1))),q.mem2[r]):t(e)?e.length?0>n?l:(r=String(n)+"@"+x(e.slice(),1,!0).join(","),null==q.mem3[r]&&(q.mem3[r]=c(q(n),s(function(n,e){return d(n,q(e))},q(e[e.length-1]),e,e.length-2,0))),q.mem3[r]):0>n?l:q(n):e===+e?0>e?-e>=n?-e===n?q(n):l:(r=String(n)+"@"+String(e),null==q.mem3[r]&&(q.mem3[r]=s(d,i,null,n+e+1,n)),q.mem3[r]):0>e||1>n||e>n?l:(e+e>n&&(e=n-e),0===e||1===n?i:1===e?a(n):(r=String(n)+"@"+String(e),null==q.mem3[r]&&(q.mem3[r]=u.isDefault()?xn.round(s(function(e,t){return e*(1+n/t)},1+(n-=e),null,2,e)):f(q(n-1,e-1),q(n-1,e))),q.mem3[r])):l}function L(n,e,t){var r,u=yn.Arithmetic,l=u.O,i=u.I,o=u.V,s=u.add,a=u.mul;return 0>n||0>e?l:2===t?n===e||1===e&&0>n?i:0===n||0===e?l:(r=String(n)+","+String(e),null==L.mem2[r]&&(L.mem2[r]=s(L(n-1,e-1,2),a(L(n-1,e,2),e))),L.mem2[r]):-1===t?e>n||0===e&&0>n?l:n===e?i:(r="-"+String(n)+","+String(e),null==L.mem1[r]&&(L.mem1[r]=s(L(n-1,e-1,-1),a(L(n-1,e,-1),1-n))),L.mem1[r]):e>n||0===e&&0>n?l:n===e?i:1===e?q(n-1):n-e&1?o(L(n,e,-1)):L(n,e,-1)}function C(n,e,t,r){var u,l,i=yn.Arithmetic,o=i.add,a=i.I,f=i.O;return 0>n||0>=e||t>r||t+e>n+1||e*r<n?f:r===n&&1===e||e===n&&1===r?a:(u=String(n)+","+String(e)+","+String(t)+","+String(r),null==C.mem[u]&&(n-=e*(t-1),r=r-t+1,l=String(n)+","+String(e)+","+String(t)+","+String(r),null==C.mem[l]&&(C.mem[l]=s(function(t,u){return o(t,C(n-r,e-1,1,u))},f,null,xn.max(1,xn.ceil((n-r)/(e-1))),xn.min(r,n-r-e+2),1)),C.mem[u]=C.mem[l]),C.mem[u])}function E(n,e,t){e=null==e?null:0|e,t=null==t?null:0|t;var r,u=yn.Arithmetic,l=u.add,i=t||0,o=t||1,a=e||1,f=e||n,c=u.O;return 0>n||e&&t&&(e+t>n+1||e*t<n)||t&&t>n||e&&e>n?c:(t&&!e&&(i=0,o=1,a=t,f=t,e=t,t=null),r=String(n)+"|"+String(e)+"|"+String(t),null==E.mem[r]&&(E.mem[r]=s(function(e,t){return s(function(e,r){return l(e,C(n,t,1,r))},e,null,o,i||n-t+1,1)},c,null,a,f,1)),E.mem[r])}function $(n,e,t,r){var u,l=yn.Arithmetic,i=l.add,o=l.O,a=l.I;return 0>n||0>=e||t>r||t*e>n||e*r<n?o:1===e?t<=n&&n<=r?a:o:n===e?t<=1&&1<=r?a:o:t===r?e*t===n?a:o:n===r?q(n-e*t+e-1,e-1):(u=String(n)+","+String(e)+","+String(t)+","+String(r),null==$.mem[u]&&($.mem[u]=s(function(n,u){return i(n,$(u,e-1,t,r))},o,null,xn.max(n-r,0),n-t,1)),$.mem[u])}function k(n,e,t){e=null==e?null:0|e,t=null==t?null:0|t;var r,u=yn.Arithmetic,l=u.O,i=u.I,o=u.add,a=(u.mul,u.div,l);return 0>n||e&&t&&(e+t>n+1||e*t<n)||t&&t>n||e&&e>n?a:(r=String(n)+"|"+String(e)+"|"+String(t),null==k.mem[r]&&(k.mem[r]=e&&t?e*t===n?i:$(n,e,1,t):e?$(n,e,1,n):t?n===t?i:s(function(e,r){return o(e,$(n,r,1,t))},a,null,xn.ceil(n/t),n-t+1,1):1<=n?S(n-1):i),k.mem[r])}function D(n){var e,t=yn.Arithmetic,r=t.O,u=t.N,l=t.div,i=t.mul;return 14>=n?0>n?r:u([1,1,2,5,14,42,132,429,1430,4862,16796,58786,208012,742900][n]):(e=String(n),null==D.mem[e]&&(D.mem[e]=l(i(D(n-1),4*n-2),n+1)),D.mem[e])}function R(n){var e,t=yn.Arithmetic,r=t.O,u=t.N,l=t.add,i=t.mul;return 12>=n?0>n?r:u([1,1,2,5,15,52,203,877,4140,21147,115975,678570][n]):(e=String(n),null==R.mem[e]&&(R.mem[e]=s(function(e,t){return l(e,i(q(n-1,t),R(t)))},r,null,0,n-1,1)),R.mem[e])}function N(n){var e,t=yn.Arithmetic,r=t.O,u=t.N,l=t.add;return 29>=n?0>n?r:u([0,1,1,2,3,5,8,13,21,34,55,89,144,233,377,610,987,1597,2584,4181,6765,10946,17711,28657,46368,75025,121393,196418,317811][n]):(e=String(n),null==N.mem[e]&&(N.mem[e]=l(N(n-1),N(n-2))),N.mem[e])}function U(n){if(!arguments.length||null==n)return Vn;var e=0;if(r(n)){for(var t=0,u=(n=n.toUpperCase().split(",")).length;t<u;t++)e|=Mn.call(U,n[t])?U[n[t]]:0;0<e&&!((Wn|Hn)&e)&&(e|=Vn),0>=e&&(e=Vn)}else e=Bn&n?Bn&n:Vn;return Hn&e&&Wn&e&&(e&=~Wn),Fn&e&&(Gn|Vn)&e&&(e&=~(Gn|Vn)),Gn&e&&Vn&e&&(e&=~Vn),Hn&e&&(e&=~Xn),e}function P(){var n,e,r,u,l,i,o,s,a,f,c,d=arguments.length;if(!d)return[];if(!0===arguments[0]){for(f=arguments[1].length,n=2;n<d;n++)f*=arguments[n].length;for(c=new Array(f),n=0;n<f;n++){for(s=0,i=1,r=n,e=1;e<d;e++)l=r%(u=arguments[e].length),r=~~(r/u),s+=i*(o=arguments[e][l]),i*=u;c[n]=s}}else{for(f=arguments[0].length,n=1;n<d;n++)f*=arguments[n].length;for(c=new Array(f),n=0;n<f;n++){for(s=new Array(d),a=0,r=n,e=d-1;e>=0;e--)if(u=arguments[e].length,l=r%u,r=~~(r/u),o=arguments[e][l],t(o))for(i=o.length-1;i>=0;i--)s[d-++a]=o[i];else s[d-++a]=o;c[n]=s}}return c}function T(n,e,t){var r,l,i,o,s,a,f,c,d,m,h,p,_,g,b,v,y,x,A,w,O,M,I,S,q=n.length,L=null,C=null;if(!q)return[];for(u(t)?(C=t,t=!0):t=!1,Rn!==e&&Nn!==e&&Un!==e&&Pn!==e&&Tn!==e&&jn!==e&&(e=!1),y=new Array(q),v=[],l=1,r=0;r<q;r++)if(u(n[r][0]))null==y[n[r][1]]?y[n[r][1]]=[[n[r][0],r]]:y[n[r][1]].push([n[r][0],r]);else if(v.push(r),!(l*=n[r].length)||0>=l)return[];if(!v.length)return[];for(g=new Array(l),_=0,p=q-1,x=v.length-1,w=new Array(q),O=0,r=0;r<l;r++){for(m=new Array(q),A=!1,o=r,i=x;i>=0;i--)if(b=v[i],s=n[b].length,a=o%s,o=~~(o/s),m[b]=n[b][a],null!=y[b]){w[0]=b,O=1;do{for(M=y[b=w[--O]],f=m[b],I=0,S=M.length;I<S;I++)m[b=M[I][1]]=M[I][0](f),null!=y[b]&&(w[O++]=b)}while(0<O)}if(e||t)if(t&&!C(m,p,p))A=!0;else for(d=m[p],Nn===e&&((L={})[d]=1),h=p-1;h>=0;h--){if(c=m[h],Rn===e&&d!==c||Nn===e&&1===L[c]||Un===e&&c>=d||Pn===e&&c<=d||Tn===e&&c<d||jn===e&&c>d||t&&!C(m,h,p)){A=!0;break}Nn===e&&(L[c]=1),d=c}A||(g[_++]=m)}return g.length>_&&(g.length=_),g}function j(n,e,t){if(null==e||!e.length||1>=e.length)return 1===e.length?a(n-1,function(n){return n<e[0]?n:n+1}):a(n,0,1);if(!0===t){var r=A(e);-1===r?e=d(new Array(e.length),e):0===r&&(e=x(e.slice(),1,!0))}return b(null,n,e)}function X(n,e){if(0>=e)return[];var t,r=a(e,0,0),u=n.length;for(e-=1,t=0;t<u;t++)r[e-n[t]]=1;return r}function J(n,e){e=xn.min(e||n.length,n.length);var t,r=[];for(e-=1,t=0;t<=e;t++)0<n[t]&&r.push(e-t);return r}function V(n,e,t){return null==n?null:(e=e||n.length,g(new Array(e),n,1,-1,-1===t?e-1:0,-1===t?0:e-1,0,e-1))}function G(n,e,t){return null==n?null:(e=e||n.length,_(new Array(e),n,1,1,-1===t?e-1:0,-1===t?0:e-1,0,e-1))}function F(n,e,r){if(null==e)return null;var u,l=null,i=e.length;if(r=-1===r?-1:1,n)1>=(u=s(M,0,e))?l=e.slice():(0<(u-=s(M,0,l=G(j(u-1,V(e,i-1,r)))))&&l.push(u),0>r&&d(l,l));else{var o,f,c,m,h,p=1,_=0,g=0,b="push";if(0>r&&(p=-p,_=i-1-_,b="unshift"),t(e[_]))for(l=[[(h=e[_])[1],h[0]]],o=0,c=1,m=p+_;c<i;c++,m+=p)h=e[m],f=0>r?0:o,h[1]===l[f][0]?l[f][1]+=h[0]:(l[b]([h[1],h[0]]),o++);else for(l=a(u=e[_],1,0),0>r&&(g=u-1-g),c=1,m=p+_;c<i;c++,m+=p)for(o=0,f=g,h=e[m];o<u&&h>0;)l[f]++,h--,o++,f+=p}return l}function H(n,e){if(null==n)return null;var t,r,u,l,i=[],o=n.length,s=1,a=0,f="push";for(-1===e&&(s=-s,a=o-1-a,f="unshift"),l=[u=n[a],1],t=1;t<o;t++)u===n[r=s*t+a]?l[1]++:(i[f](l),l=[u=n[r],1]);return i[f](l),i}function W(n,e){if(null==n)return null;var t,r,u,l,i,o=[],s=n.length,a=1,f=0,c="push";for(-1===e&&(a=-a,f=s-1-f,c="unshift"),t=0;t<s;t++)if(1===(i=n[a*t+f])[1])o[c](i[0]);else for(u=i[1],l=i[0],r=0;r<u;r++)o[c](l);return o}function B(n,e,t){var r,u,l=e.length,i=l*l;for(n=n||new Array(i),r=0,u=0;r<i;)n[r+u]=0,++u>=l&&(u=0,r+=l);if(!0===t)for(r=0;r<l;r++)n[l*e[r]+r]=1;else for(r=0,u=0;u<l;u++,r+=l)n[r+e[r]]=1;return n}function Y(n,e,t){var r,u,l=e.length,i=xn.floor(xn.sqrt(l));if(n=n||new Array(i),!0===t)for(r=0,u=0;r<i;)e[i*r+u]&&(n[u]=r),++u>=i&&(u=0,r++);else for(r=0,u=0;r<i;)e[r+u]&&(n[r]=u),++u>=i&&(u=0,r++);return n}function z(n,e,t){var r=n?n.length:0,u=1,l=0,i=0,o=i<r?n[i]||1:1;return-1===t&&(u=-1,l=(r||e)-1),s(function(e,t){return 0>=o&&(l+=u,o=++i<r?n[i]||1:1),o--,e[t]=l,e},new Array(e),null,0,e-1)}function K(n){return Z(null,x(n,1,!1,!0))}function Q(n,e){return e&&e.length?s(function(n,t,r){return n[r]=t<e.length?e[t]:t,n},n,n):n}function Z(n,e){return s(function(n,e,t){return n[e]=t,n},n||new Array(e.length),e)}function nn(n,e,t){var r=e.length,u=xn.ceil(Sn(t||r)),l=1<<u,i=a((1<<1+u)-1,0,0);return s(function(n,e,t){for(var r=e+l,o=0;o<u;o++)1&r&&(e-=i[r>>>1<<1]),i[r]+=1,r>>>=1;return i[r]+=1,n[t]=e,n},n||new Array(r),e)}function en(n,e,t){var r,u,l,i=e.length,o=xn.ceil(Sn(t||i)),a=1<<o,f=(1<<1+o)-1,c=new Array(f);for(r=0;r<=o;r++)for(l=1,u=1<<r;l<=u;l++)c[u-1+l]=1<<o-r;return s(function(n,e,t){for(var r=1,u=0;u<o;u++)c[r]-=1,e>=c[r<<=1]&&(e-=c[r],r++);return c[r]=0,n[t]=r-a,n},n||new Array(i),e)}function tn(n,e,t){var r,u=n.length,l=null==e;if(u>1)for(l&&(e=new Array(u-1),t=0),r=u-1;r>=1;r--)e[t++]=[n[0],n[r]];else l&&(e=[]);return l?e:t}function rn(n,e){var t,r,u,l,i=n.length,o=new Array(i),s=!0===e?1:0,a=new Array(i),f=0,c=0;for(t=0;t<i;t++)a[t]=0;for(l=0,r=f++,(u=new Array(i))[l++]=r,a[r]=1;f<i;){if(r=n[r],a[r])for(l>s&&(u.length=l,o[c++]=u),u=new Array(i),l=0;f<i&&a[r=f];)++f;a[r]||(u[l++]=r,a[r]=1)}return l>s&&(u.length=l,o[c++]=u),c<o.length&&(o.length=c),o}function un(n){var e,t,r=n.length,u=new Array(r),l=0,i=rn(n,!0);for(e=0,t=i.length;e<t;e++)l=tn(i[e],u,l);return l<u.length&&(u.length=l),u}function ln(n,e){var t,r,u,l=n.length,i=new Array(e);for(t=0;t<e;t++)i[t]=t;for(t=0;t<l;t++)swap=r[t],u=i[r[0]],i[r[0]]=i[r[1]],i[r[1]]=u;return i}function on(n,e,t){var r=n.length,u=e.length;if(!0===t)return s(r<u?function(t,u){return t[u]=e[u]<r?n[e[u]]:n[u],t}:r>u?function(t,r){return t[r]=r<u?n[e[r]]:n[r],t}:function(t,r){return t[r]=n[e[r]],t},new Array(r),null,0,r-1,1);for(var l=n.slice(),i=0;i<r;i++)n[i]=l[e[i]];return n}function sn(n){return s(function(n,e){return on(n,e,!0)},n.length?n[0].slice():[],n,1,n.length-1,1)}function an(n){var e,t,r,u=n.length,l=0;for(t=0;t<u;t++)l+=n[t].length;return e=0,t=0,r=u?n[t].length:0,a(l,function(u){return u>=e+r&&(e+=r,r=n[++t].length),e+n[t][u-e]})}function fn(n,e,t,r,u,l){var i,o,s,a,f,c,d,m,h,p=e;if("tuple"===r?(i=p[0],p=p[1]):i=p.length,0,h=i-1,c=1,a=h,f=0,d=1,m=0,Gn&u&&(c=-c,a=h-a,f=h-f,d=-d,m=h-m),Jn&u&&(c=-c,a=h-a,f=h-f,d=-d,m=h-m),Xn&u&&(t=-t),0>t)if("tuple"===r){for(o=a;0<=o&&h>=o&&0===n[o];)o-=c;if(0<=o&&h>=o)for(p-=1,n[o]=n[o]-1,s=o+c;0<=s&&h>=s;s+=c)n[s]=p;else n=null}else{for(o=a;0<=o&&h>=o&&0===n[o];)o-=c;if(0<=o&&h>=o)for(n[o]=n[o]-1,s=o+c;0<=s&&h>=s;s+=c)n[s]=p[d*s+m]-1;else n=null}else if("tuple"===r){for(o=a;0<=o&&h>=o&&n[o]+1===p;)o-=c;if(0<=o&&h>=o)for(n[o]=n[o]+1,s=o+c;0<=s&&h>=s;s+=c)n[s]=0;else n=null}else{for(o=a;0<=o&&h>=o&&n[o]+1===p[d*o+m];)o-=c;if(0<=o&&h>=o)for(n[o]=n[o]+1,s=o+c;0<=s&&h>=s;s+=c)n[s]=0;else n=null}return n}function cn(n,e,t,r,u,l,i){var o,s,a,f,c,d,m,h,p,_,g,b,v,y=e,x=null==l?y:l;if(0,v=y-1,h=1,m=v,p=1,_=0,g=1,b=0,Gn&u&&(h=-h,m=v-m,p=-p,_=x-1-_,t=-t),Jn&u&&(h=-h,m=v-m,g=-1,b=x-1),Xn&u&&(t=-t),0>t)if("cyclic"===r)if(o=v-m,p*n[o]+_>0)for(g=y-1,h=y+h,a=0;a<y;a++)c=(p*n[o]+_+g)%y,n[o]=p*c+_,o=(o+h)%y;else n=null;else if("involution"===r)n=null;else if("connected"===r)n=null;else do{for(d=!1,o=m-h;0<=o&&o<=v&&p*n[o]<=p*n[o+h];)o-=h;if(0<=o&&o<=v){for(s=m;0<=s&&s<=v&&h*(s-o)>0&&p*n[o]<=p*n[s];)s-=h;for(c=n[o],n[o]=n[s],n[s]=c,a=o+h,f=m;0<=a&&a<=v&&0<=f&&f<=v&&h*(f-a)>0;)c=n[a],n[a]=n[f],n[f]=c,d=d||g*a+b===n[a]||g*f+b===n[f],a+=h,f-=h;if("derangement"===r)for(0<=s&&s<=v&&(d=d||g*s+b===n[s]),0<=f&&f<=v&&(d=d||g*f+b===n[f]),d=d||g*o+b===n[o],a=o-h;!d&&0<=a&&a<=v;a-=h)d=g*a+b===n[a];else d=!1}else n=null}while(n&&d);else if("cyclic"===r)if(o=v-m,p*n[o]+_<y-1)for(g=y+1,h=y+h,a=0;a<y;a++)c=(p*n[o]+_+g)%y,n[o]=p*c+_,o=(o+h)%y;else n=null;else if("involution"===r){for(o=y,d=!0;d&&o--;)for(s=n[o],n[o]=o,n[s]=s;s--;)if(n[s]===s){n[o]=s,n[s]=o,d=!1;break}d&&(n=null)}else if("connected"===r)n=null;else do{for(d=!1,o=m-h;0<=o&&o<=v&&p*n[o]>=p*n[o+h];)o-=h;if(0<=o&&o<=v){for(s=m;0<=s&&s<=v&&h*(s-o)>0&&p*n[o]>=p*n[s];)s-=h;for(c=n[o],n[o]=n[s],n[s]=c,a=o+h,f=m;0<=a&&a<=v&&0<=f&&f<=v&&h*(f-a)>0;)c=n[a],n[a]=n[f],n[f]=c,d=d||g*a+b===n[a]||g*f+b===n[f],a+=h,f-=h;if("derangement"===r)for(0<=s&&s<=v&&(d=d||g*s+b===n[s]),0<=f&&f<=v&&(d=d||g*f+b===n[f]),d=d||g*o+b===n[o],a=o-h;!d&&0<=a&&a<=v;a-=h)d=g*a+b===n[a];else d=!1}else n=null}while(n&&d);return n}function dn(n,e,t,r,u){if(null==n)return null;var l,i=null;if("ordered"===u)for(i={},l=0;l<t;l++)i[n[l]]=1;return i}function mn(n,e,t,r,u,l){var i,o,s,a,f,c,d,m,h,p,_,g,b,v=e[1],y=e[0];if(0,d=v-1,c=1,f=d,m=1,h=0,p=1,_=0,Gn&u&&(m=-m,h=y-1-h,c=-c,f=d-f,p=-p,_=d-_),Jn&u&&(c=-c,f=d-f,p=-p,_=d-_),Xn&u&&(t=-t),0>t)if("ordered+repeated"===r){for(i=f;0<=i&&i<=d&&0===n[i];)i-=c;if(0<=i&&i<=d)for(y-=1,n[i]=n[i]-1,o=i+c;0<=o&&o<=d;o+=c)n[o]=y;else n=null}else if("ordered"===r){for(null==l&&(l=dn(n,y,v,u,r)),i=f,s=-1;-1===s&&0<=i&&i<=d;){if(m*n[i]+h-m>=0)for(o=m*n[i]+h-m;0<=o&&o<y;o-=m)if(a=m*o+h,null==l[a]){s=i,l[a]=1;break}l[n[i]]=null,i-=c}if(-1<s)for(n[s]=a,a=m*(o=y-1-h)+h,i=s+c;0<=i&&i<=d;i+=c){for(;0<=o&&o<y&&null!=l[a];)a=m*(o-=m)+h;n[i]=a,l[a]=1}else n=null}else if(b="repeated"===r,g=b?0:1,Gn&u)if(c=-c,f=d-f,p=-p,_=d-_,i=d-f,o=0>c?0:d,!b&&n[o]+1>v||b&&n[o]>0){if(b)for(;0<=i&&i<=d&&0===n[i];)i+=c;else for(;0<=i&&i<=d&&p*i+_===n[i];)i+=c;for(n[i]-=1,i-=c;0<=i&&i<=d;)n[i]=n[i+c]-g,i-=c}else n=null;else{for(s=-1,i=f;0<=i-c&&i-c<=d;i-=c)if(n[i]>n[i-c]+g){s=i;break}if(!(0<=s&&s<=d)&&0<n[0>c?d:0]&&(s=0>c?d:0),0<=s&&s<=d){for(a=y-1+g,i=f;0<=i&&i<=d&&0<c*(i-s);i-=c)a-=g,n[i]=a;n[s]--}else n=null}else if("ordered+repeated"===r){for(i=f;0<=i&&i<=d&&n[i]+1===y;)i-=c;if(0<=i&&i<=d)for(n[i]=n[i]+1,o=i+c;0<=o&&o<=d;o+=c)n[o]=0;else n=null}else if("ordered"===r){for(null==l&&(l=dn(n,y,v,u,r)),i=f,s=-1;-1===s&&0<=i&&i<=d;){if(m*n[i]+h+m<y)for(o=m*n[i]+h+m;0<=o&&o<y;o+=m)if(a=m*o+h,null==l[a]){s=i,l[a]=1;break}l[n[i]]=null,i-=c}if(-1<s)for(n[s]=a,a=m*(o=h)+h,i=s+c;0<=i&&i<=d;i+=c){for(;0<=o&&o<y&&null!=l[a];)a=m*(o+=m)+h;n[i]=a,l[a]=1}else n=null}else if(b="repeated"===r,g=b?0:1,Gn&u)if(c=-c,f=d-f,p=-p,_=d-_,i=d-f,!b&&n[i]+v<y||b&&n[i]+1<y){for(a=p*i+_;0<=i+c&&i+c<=d&&n[i]+g===n[i+c];)n[i]=a,i+=c,a+=g;n[i]+=1}else n=null;else{if(b){for(s=-1,o=y-1,i=f;0<=i&&i<=d;i-=c)if(n[i]<o){s=i;break}}else for(s=-1,o=y-v,i=f;0<=i&&i<=d;i-=c)if(n[i]<o+p*i+_){s=i;break}if(0<=s&&s<=d){if(a=n[s]+1,o=b?y-1:y-v+p*s+_,a===o)n[s]=a;else if(a<o)for(i=s;0<=i&&i<=d;i+=c)n[i]=a,a+=g}else n=null}return n}function hn(n,e,t,r){var u,l,i,o,s,a=e,f=e-1;return i=1,1,0,Gn&r?null:(Jn&r&&(i=-i),Xn&r&&(t=-t),0>i?(o=e-1,s=u=e-(n[a]||1)):(o=u=0,s=n[a]-1),0>t?0<n[a]?(l=n[s])>0?1===n[a]||l>n[s-i]+1?(n[s]-=1,n[s+i]=f,n[a]++):n[a]--:n[a]=0:n=null:0===n[a]?(n[u]=0,n[a]=1):1*n[o]+0<f?1*n[s]+0<f?(n[s+i]=n[s]+1,n[a]++):(n[s-i]+=1,n[a]--):n=null,n)}function pn(n,e,t,r,u,l,i){var o,s,a,f,c,d,m,h,p,_,g=e,b=r||(u?g-u+1:g);if(h=1,Jn&l&&(h=-h),Xn&l&&(t=-t),0>h?(a=_=b-1,f=p=b-(n[b]||1)):(a=p=0,f=_=n[b]-1),0>t)if(r)n=null;else if(Gn&l)n=null;else if(s=u?a+h:a,p<=s&&s<=_&&n[s]>1){for(o=f,m=0;p<=o&&o<=_&&h*(o-s)>=0&&1===n[o];)m+=n[o],o-=h;if(d=n[o]-1,m++,n[o]=d,n[b]=0>h?b-o:o+1,d<m){for(s=m%d,m=xn.floor(m/d);0<m--;)n[o+=h]=d,n[b]++;0<s&&(n[o+=h]=s,n[b]++)}else 0<m&&(n[o+=h]=m,n[b]++)}else n=null;else if(r)n=null;else if(Gn&l)n=null;else if(u?(d=xn.min(u,g-u),c=xn.floor(g/u)+(g%u?1:0)-1,d=n[b]-1>c||n[a+(c-1)*h]<d,s=a+h):(d=n[a]<g,s=a),p<=s&&s<=_&&d){for(0<_?(o=f-h,m=n[f]):(o=f,m=0);p<=o&&o<=_&&p<=o-h&&o-h<=_&&h*(o-s)>0&&n[o]===n[o-h];)m+=n[o],o-=h;for(n[o]++,m--,n[b]=0>h?b-o:o+1;0<m--;)n[o+=h]=1,n[b]++}else n=null;return n}function _n(n,e,t,r,u,l,i){var o,s,a,f,c,d,m,h,p=e,_=r||(u?p-u+1:p);if(d=1,Jn&l&&(d=-d),Xn&l&&(t=-t),0>d?(s=h=_-1,a=m=_-(n[_]||1)):(s=m=0,a=h=n[_]-1),0>t)if(r)if(u)n=null;else if(Gn&l)if(f=n[s],p-r+1>f){for(n[s]=1,o=s+d;m<=o&&o<=h&&1===n[o];)o+=d;n[o]--,m<=o-d&&o-d<=h&&(n[o-d]=1+f)}else n=null;else if(f=n[a],p-r+1>f){for(n[a]=1,o=a;m<=o&&o<=h&&1===n[o];)o-=d;n[o]--,m<=o+d&&o+d<=h&&(n[o+d]=1+f)}else n=null;else if(u)n=null;else if(Gn&l)n=null;else if(p>n[_]){for(o=a,c=0;m<=o&&o<=h&&1===n[o];)o-=d,c++;if(f=n[o]-1,n[o]=f,0<++c)if(m<=o+d&&o+d<=h)n[o+=d]=c,c=0,n[_]=0>d?_-o:o+1;else for(;0<c--;)n[o+=d]=1,n[_]++}else n=null;else if(r)if(u)n=null;else if(Gn&l)if(p-r+1>n[a]){for(o=s;m<=o&&o<=h&&1===n[o];)o+=d;f=n[o],n[o]=1,n[s]=f-1,m<=o+d&&o+d<=h&&n[o+d]++}else n=null;else if(p-r+1>n[s]){for(o=a;m<=o&&o<=h&&1===n[o];)o-=d;f=n[o],n[o]=1,n[a]=f-1,m<=o-d&&o-d<=h&&n[o-d]++}else n=null;else if(u)n=null;else if(Gn&l)n=null;else if(p>n[s])for(c=n[a],n[a-d]++,n[_]--,o=a-d,c--;0<c--;)n[o+=d]=1,n[_]++;else n=null;return n}var gn,bn,vn,yn={VERSION:"0.8.8"},xn=Math,An="prototype",wn="constructor",On=Array.prototype.slice,Mn=Object[An].hasOwnProperty,In=Object[An].toString,Sn=xn.log2||function(n){return xn.log(n)/xn.LN2},qn=/^\s+|\s+$/g,Ln=(String.prototype.trim,/\[(\d+)\]/g),Cn=/^\{(\d+(?:(?:\.\.\d+)?|(?:,\d+)*))\}$/,En=/^!\{(\d+(?:(?:\.\.\d+)?|(?:,\d+)*))\}$/,$n=Object.create,kn=function(n,e){for(var t in e)Mn.call(e,t)&&(n[t]=e[t]);return n},Dn=function(n,e){1===arguments.length&&(e=n,n=Object);var t=e[wn];return Mn.call(e,"__static__")&&(t=kn(t,e.__static__),delete e.__static__),t[An]=kn($n(n[An]),e),t},Rn=1,Nn=-1,Un=3,Pn=-3,Tn=-2,jn=2,Xn=1,Jn=2,Vn=4,Gn=8,Fn=16,Hn=32,Wn=Vn|Gn|Fn,Bn=Wn|Hn|Xn|Jn;return q.mem1={},q.mem2={},q.mem3={},L.mem1={},L.mem2={},C.mem={},E.mem={},$.mem={},k.mem={},D.mem={},R.mem={},N.mem={},yn.Class=Dn,yn.Options={MAXMEM:1e6,RANDOM:"index"},U.LEX=U.LEXICOGRAPHIC=Vn,U.COLEX=U.COLEXICOGRAPHIC=Gn,U.MINIMAL=U.GRAY=Fn,U.RANDOM=Hn,U.REV=U.ANTI=U.REVERSE=U.REVERSED=Xn,U.REF=U.REFLECT=U.REFLECTED=Jn,U.REVLEX=U.ANTILEX=U.REVERSELEXICOGRAPHIC=U.ANTILEXICOGRAPHIC=Vn|Xn,U.REFLEX=U.REFLECTEDLEXICOGRAPHIC=Vn|Jn,U.REVCOLEX=U.ANTICOLEX=U.REVERSECOLEXICOGRAPHIC=U.ANTICOLEXICOGRAPHIC=Gn|Xn,U.REFCOLEX=U.REFLECTEDCOLEXICOGRAPHIC=Gn|Jn,yn.ORDER=U,yn.Math={O:0,I:1,J:-1,N:function(n){return yn.Arithmetic.add(yn.Arithmetic.O,n)},V:function(n){return yn.Arithmetic.sub(yn.Arithmetic.O,n)},rnd:xn.random,rndInt:function(n,e){return yn.Math.round((e-n)*yn.Math.rnd()+n)},equ:function(n,e){return n===e},gte:function(n,e){return n>=e},lte:function(n,e){return n<=e},gt:function(n,e){return n>e},lt:function(n,e){return n<e},inside:function(n,e,t,r){return r?n>=e&&n<=t:n>e&&n<t},clamp:function(n,e,t){return n<e?e:n>t?t:n},wrap:function(n,e,t){return n<e?t:n>t?e:n},wrapR:function(n,e){return n<0?n+e:n},add:M,sub:function(n,e){return n-e},mul:function(n,e){return n*e},div:function(n,e){return yn.Math.floor(n/e)},mod:function(n,e){return n%e},pow:xn.pow,shl:function(n,e){return n<<e},shr:function(n,e){return n>>e},bor:function(n,e){return n|e},band:function(n,e){return n&e},xor:function(n,e){return n^e},abs:xn.abs,min:xn.min,max:xn.max,floor:xn.floor,ceil:xn.ceil,round:xn.round,num:function(n){return"number"==typeof n?yn.Math.floor(n):parseInt(n,10)},val:function(n){return yn.Math.floor(n.valueOf())},sum:I,product:function(n,e,t,r){return s(yn.Arithmetic.mul,yn.Arithmetic.I,n,e,t,r)},pow2:S,exp:function(n,e){var t=yn.Arithmetic,r=t.N;return t.pow(r(n),r(e))},factorial:q,stirling:L,partitions:E,compositions:k,bell:R,catalan:D,fibonacci:N},yn.Arithmetic={isDefault:function(){return 0===yn.Arithmetic.O&&yn.Arithmetic.add===M},O:0,I:1,J:-1,N:yn.Math.N,V:yn.Math.V,equ:yn.Math.equ,gte:yn.Math.gte,lte:yn.Math.lte,gt:yn.Math.gt,lt:yn.Math.lt,inside:yn.Math.inside,clamp:yn.Math.clamp,wrap:yn.Math.wrap,wrapR:yn.Math.wrapR,add:yn.Math.add,sub:yn.Math.sub,mul:yn.Math.mul,div:yn.Math.div,mod:yn.Math.mod,pow:yn.Math.pow,shl:yn.Math.shl,shr:yn.Math.shr,bor:yn.Math.bor,band:yn.Math.band,xor:yn.Math.xor,abs:yn.Math.abs,min:yn.Math.min,max:yn.Math.max,floor:yn.Math.floor,ceil:yn.Math.ceil,round:yn.Math.round,rnd:yn.Math.rndInt,num:yn.Math.num,val:yn.Math.val},yn.Util={array:a,operate:s,intersection:function(n,e,t,r,u,l,i,o){r=-1===r?-1:1,null==u&&(u=0),null==l&&(l=e.length-1),null==i&&(i=0),null==o&&(o=t.length-1);var s=u>l?-1:1,a=i>o?-1:1,f=s*(l-u)+1,c=a*(o-i)+1,d=u,m=i,h=0;if(null==n&&(n=new Array(xn.min(f,c))),0===n.length)return n;for(;0<=s*(l-d)&&0<=a*(o-m);)1===r&&e[d]<t[m]||-1===r&&e[d]>t[m]?d+=s:1===r&&e[d]>t[m]||-1===r&&e[d]<t[m]?m+=a:(n[h++]=e[d],d+=s,m+=a);return h<n.length&&(n.length=h),n},difference:b,multi_difference:function(n,e,t,r,u,l,i,o){null==u&&(u=0),null==l&&(l=t.length-1),null==i&&(i=0),null==o&&(o=r?r.length-1:-1);var s=u>l?-1:1,a=i>o?-1:1,f=s*(l-u)+1,c=u,d=i,m=0;if(!r||!r.length)return t?t.slice():t;for(null==n&&(n=new Array(f));0<=s*(l-c)&&0<=a*(o-d);)t[c]===r[d]?1<e[t[c]]?e[t[c]]--:(c+=s,d+=a):t[c]>r[d]?d+=a:(n[m++]=t[c],e[t[c]]--,c+=s);for(;0<=s*(l-c);)0<e[t[c]]&&(n[m++]=t[c]),e[t[c]]--,c+=s;return m<n.length&&(n.length=m),n},union:v,search:function(n,e,t,r,u){t=-1===t?-1:1,null==r&&(r=0),null==u&&(u=e.length-1);var l,i,o=r,s=u;if(n===e[o])return o;if(n===e[s])return s;for(;o<s;){if(l=o+(s-o+1>>>1),i=e[l],n===i)return l;1===t&&n<i||-1===t&&n>i?s=l-1:o=l+1}return-1},complementation:c,reflection:d,reversion:m,gray:h,finitedifference:_,partialsum:g,sort:x,shuffle:w,pick:O,pluck:f},yn.BitArray=Dn({constructor:function n(e){var t=this;if(!(t instanceof n))return new n(e);t.length=e,t.bits=new Uint32Array(xn.ceil(e/32))},length:0,bits:null,dispose:function(){var n=this;return n.length=null,n.bits=null,n},clone:function(){var n=this,e=new yn.BitArray(n.length);return e.bits=new Uint32Array(n.bits),e},fromArray:function(n){var e=this;return e.bits=new Uint32Array(n),e},toArray:function(){return On.call(this.bits)},toString:function(){var n,e,t=this.toArray();for(n=0,e=t.length;n<e;n++)t[n]=o(t[n]);return t.join("")},reset:function(){var n,e=this,t=e.bits,r=t.length;for(n=0;n<r;n++)t[n]=0;return e},isset:function(n){return!!(this.bits[n>>>5]&1<<(31&n))},set:function(n){var e=this;return e.bits[n>>>5]|=1<<(31&n),e},unset:function(n){var e=this;return e.bits[n>>>5]&=~(1<<(31&n)),e},toggle:function(n){var e=this;return e.bits[n>>>5]^=1<<(31&n),e}}),gn=yn.CombinatorialIterator=Dn({constructor:function n(e,r,u,l){var i=this;yn.Arithmetic;if(!(i instanceof n))return new n(e,r,u,l);if(i[wn],t(e)&&(e[0]instanceof n||e[e.length-1]instanceof n)){i.$=u=r||{},u.seq=e,e=null,i.n=r=u.seq.length,u.type="sequence",u.rand=u.rand||{},u.rand.sequence=1;var o=1/0,a=-1/0,f=1/0,c=-1/0;s(function(n,e){var t=e.base(),r=e.dimension();t>a&&(a=t),t<o&&(o=t),r>c&&(c=r),r<f&&(f=r)},null,u.seq),u.base=u.maxbase=a,u.minbase=o,u.dimension=u.maxdimension=c,u.mindimension=f}else i.n=r||0,i.$=u=u||{};i.name=e||"CombinatorialIterator",u.type=String(u.type||"default").toLowerCase(),u.order=u.order||Vn,u.rand=u.rand||{},u.sub=null,u.instance=i,i.init().order(u.order),l&&l.iter instanceof n&&i.fuse(l.method,l.iter,l.pos,l.cascade)},__static__:{Iterable:function n(e,t){var r=this;if(!(r instanceof n))return new n(e,t);t=-1===t?-1:1,r.next=function(){return e.hasNext(t)?{value:e.next(t)}:{done:!0}}},C:function(n,e,t,r){if(t+1===n.length){var u=-1===r;c(n,n,e,u?t-(n[t]||1):0,u?t-1:n[t]-1)}else c(n,n,e);return n},D:function(n,e,t,r){if(t+1===n.length){var u,l=-1===r;(u=(n=j(e,n=l?n.slice(t-n[t],t):n.slice(0,n[t]),!0)).length)<t&&n[l?"unshift":"push"].apply(n,new Array(t-u)),n.push(u)}else n=j(e,n);return n},P:function(n,e,t){return e+1===n.length?n=-1===t?p(n,d(n,n,e,e-(n[e]||1),e-1),-e+n[e],e-(n[e]||1),e-1):p(n,d(n,n,e,0,n[e]-1),e-n[e],0,n[e]-1):d(n,n),n},T:function(n,e,t){return m(n,e)},DUAL:function(n,e,t,r){if(null==n)return null;if(t&&"sequence"===t.type)return n;var u=this,l=t&&null!=t.order?t.order:Vn,i=t&&null!=t.base?t.base:e,o=t&&null!=t.dimension?t.dimension:e;return r=-1===r?-1:1,n=Gn&l?Jn&l?u.C(n,i,o,t,r):u.P(u.C(n,i,o,t,r),o,r):Jn&l?u.P(n,o,r):n},count:function(n,e){var t=yn.Arithmetic,r=t.O;return e&&"sequence"===e.type&&e.seq&&e.seq.length?s(function(n,e){return t.add(n,e.total())},r,e.seq):r},initial:function(n,e,t,r){return e&&"sequence"===e.type&&e.seq&&e.seq.length?!0===r?this.succ(0,0,n,e,t):0>(t=-1===t?-1:1)||Xn&(e&&null!=e.order?e.order:Vn)?e.seq[e.seq.length-1].item0(t):e.seq[0].item0(t):null},succ:function(n,e,t,r,u,l){if(null==t||null==n)return null;var i,o,s,a,f,c=this,d=yn.Arithmetic;if(u=-1===u?-1:1,r&&"sequence"===r.type){if(!(f=r.seq)||!f.length)return null;for(Xn&(r&&null!=r.order?r.order:Vn)?(i=-1,o=f.length-1):(i=1,o=0),a=i*r.seq_curr+o,s=i*u;0<=a&&a<f.length&&!f[a].hasNext(u);)r.seq_curr+=u,a+=s;return 0<=a&&a<f.length?f[a].next(u):null}return null==e?null:c.unrank(d.add(e,0>u?d.J:d.I),t,r)},rand:function(n,e){var t,r,u,l,i,o=this,s=yn.Arithmetic,a=s.O;if(e&&"sequence"===e.type){if(!(u=e.seq)||!u.length)return null;for(t=null!=e.last?e.last:s.sub(o.count(n,e),s.I),r=s.rnd(a,t),l=0,i=u.length;s.gte(r,u[l].total())&&(r=s.sub(r,u[l].total()),!(++l>=i||s.lt(r,a))););return l<i&&s.gte(r,a)?u[l].random():null}return t=e&&null!=e.last?e.last:s.sub(o.count(n,e),s.I),r=s.rnd(a,t),s.equ(a,r)?o.initial(n,e,1):s.equ(t,r)?o.initial(n,e,-1):o.unrank(r,n,e)},rank:e,unrank:function(n,t,r){if(r&&"sequence"===r.type){var u,l,i=this,o=yn.Arithmetic,s=o.O,a=r.seq;if(!a||!a.length)return null;if(null==n||!o.inside(n,o.J,null!=r.count?r.count:i.count(t,r)))return null;for(l=a.length,u=0;o.gte(n,a[u].total())&&(n=o.sub(n,a[u].total()),!(++u>=l||o.lt(n,s))););return u<l&&o.gte(n,s)?a[u][wn].unrank(n,a[u].n,a[u].$):null}return e()},fusion:function(n,e,t,r,u,l,i){if(-1===i){var o=e;e=t,t=o}if(null==e||null==t)return e||t||null;if("multiply"===n)return P(!0,e,t);if("add"===n||"connect"===n||"concat"===n){var s=e.length?e[0]+1:0;return a(e.length+t.length,"add"===n?function(n){return n<e.length?e[n]:e.length+t[n-e.length]}:"connect"===n?function(n){return n<e.length?(e[n]+1>s&&(s=e[n]+1),e[n]):s+t[n-e.length]}:function(n){return n<e.length?e[n]:t[n-e.length]})}if("complete"===n||"interleave"===n||"combine"===n){var f=e.length,c=t.length,d=f+c,m=0,h=0,p=0,_=h<f?e[h]:-1,g=null!=l?h<l.length?l[h]:-1:_,b="complete"===n?j(u,e,!0):null;return a(d,"complete"===n?function(n){var r;return g===n?(r=_,_=++h<f?e[h]:-1,g=null!=l?h<l.length?l[h]:-1:_):r=b[t[m++]],r}:"interleave"===n?function(n){var r;return g===n?(r=_,_=++h<f?e[h]:-1,g=null!=l?h<l.length?l[h]:-1:_):r=t[m++],r}:function(n){var r;return _===n?(r=_,_=++h<f?e[h]:-1,p++):r=p+t[m++],r})}return a(e.length,function(n){return 0<=e[n]&&e[n]<t.length?t[e[n]]:e[n]})},output:function(n,e,l,i){var o=i&&i.type?i.type:null,a=i&&null!=i.output?i.output:null;return null==n?null:null==a?"sequence"===o?n:n.slice():u(a)?a(n,l):t(a)?s(function(n,e,t){return n[t]=0<=e&&e<a.length?a[e]:e,n},new Array(n.length),n):r(a)?s(function(n,e,t){return n+=0<=e&&e<a.length?a.charAt(e):String(e)},"",n):"sequence"===o?n:n.slice()}},name:"CombinatorialIterator",n:0,$:null,__index:null,_index:null,__item:null,item__:null,_item:null,__subindex:null,_subindex:null,__subitem:null,_subitem:null,_prev:null,_next:null,_traversed:null,dispose:function(n){var e=this;return!0!==n&&e.$.sub&&(e.$.sub.dispose(),e.$.sub=null),"sequence"===e.$.type&&e.$.seq&&e.$.seq.length&&s(function(n,e){e.dispose()},null,e.$.seq),e.name=null,e.n=null,e.$=null,e.__index=null,e._index=null,e.__item=null,e.item__=null,e._item=null,e.__subindex=null,e._subindex=null,e.__subitem=null,e._subitem=null,e._prev=null,e._next=null,e._traversed&&(e._traversed.dispose(),e._traversed=null),e},init:function(){var n=this,e=n[wn],t=n.$,r=n.n,u=yn.Arithmetic;return t.base=t.base||0,t.minbase=null!=t.minbase?t.minbase:t.base,t.maxbase=null!=t.maxbase?t.maxbase:t.base,t.dimension=t.dimension||0,t.mindimension=null!=t.mindimension?t.mindimension:t.dimension,t.maxdimension=null!=t.maxdimension?t.maxdimension:t.dimension,t.count=e.count(r,t),t.first=u.O,t.last=u.gt(t.count,u.O)?u.sub(t.count,u.I):u.J,n},fuse:function(n,e,t,r){var u=this,l=u.$;return 1===arguments.length&&!1===n?l.sub&&(l.sub=null,l.submethod=null,l.subpos=null,l.subcascade=null,l.subcount=null,l.subdimension=null,l.subposition=null,u.rewind()):e instanceof gn&&(n=String(n||"project").toLowerCase(),t=t||null,r=-1===r?-1:1,l.sub=e,l.submethod=n,l.subpos=t,l.subcascade=r,l.subcount=yn.Arithmetic.mul(l.count,l.sub.total()),l.subdimension="multiply"===n?l.dimension*l.sub.dimension():"add"===n||"connect"===n||"concat"===n||"complete"===n||"interleave"===n||"combine"===n?l.dimension+l.sub.dimension():l.dimension,u.rewind()),u},unfuse:function(){return this.fuse(!1)},multiplyWith:function(n,e){return this.fuse("multiply",n,null,e)},addWith:function(n,e){return this.fuse("add",n,null,e)},connectWith:function(n,e){return this.fuse("connect",n,null,e)},concatWith:function(n,e){return this.fuse("concat",n,null,e)},completeWith:function(n,e,t){return-1!==e&&1!==e||(t=e,e=null),this.fuse("complete",n,e||this.position(),t)},interleaveWith:function(n,e,t){return-1!==e&&1!==e||(t=e,e=null),this.fuse("interleave",n,e||this.position(),t)},combineWith:function(n,e,t){return-1!==e&&1!==e||(t=e,e=null),this.fuse("combine",n,e||this.position(),t)},projectOn:function(n,e){return this.fuse("project",n,null,e)},base:function(n){var e=this.$;return e.sub&&!0!==n?e.subbase||e.base||0:e.base||0},dimension:function(n){var e=this.$;return e.sub&&!0!==n?e.subdimension||e.dimension||0:e.dimension||0},position:function(n){var e=this.$;return e.sub&&!0!==n?e.subposition||e.position||null:e.position||null},total:function(n){var e=this.$;return e.sub&&!0!==n?e.subcount||e.count||0:e.count||0},_reset:function(n){var e,t,r,u=this,l=u[wn],i=u.$,o=u.n,s=yn.Arithmetic,a=s.O,f=(s.I,i.order);return u.__index=u._index=a,u._item=u.__item=u.item__=null,u._prev=!1,u._next=!1,t=i.count,r=i.last,"sequence"===i.type&&(i.seq_curr=i.seq&&i.seq.length?0>n?i.seq.length-1:0:-1),Hn&f?("gen"===yn.Options.RANDOM||1===i.rand[i.type]||s.gt(t,yn.Options.MAXMEM)||s.isDefault()&&0>t?(u.__item=l.rand(o,i),u.__index=a):(u._traversed&&u._traversed.dispose(),u._traversed=new yn.BitArray(s.val(t)),e=u.random("index"),u._traversed.set(+e),u.__item=l.unrank(e,o,i),null!=u.__item&&(u.__index=e)),u._index=a):(u.__item=l.initial(o,i,n,!0),null!=u.__item&&(u.__index=0>n?r:a,u._update()),u._index=u.__index),u._item=l.output(u.__item,u.__index,o,i),u._prev=!(Hn&f||0<n)&&null!=u.__item,u._next=!(0>n&&!(Hn&f))&&null!=u.__item,u},_update:function(){return this.item__=null,this},order:function(n,e){if(!arguments.length)return this._order;var t,u,l,i,o,s,a=this,f=a[wn],c=yn.Arithmetic,d=(c.O,c.I,!0===n);if(e=-1===e,a.n,l=a.$,a._traversed&&(a._traversed.dispose(),a._traversed=null),d?n=l.order:r(n)&&-1<(u=n.indexOf("|"))?(t=n.substr(u+1),n=U(n.substr(0,u))):t=n=U(n),i=e?-1:1,l.order=n,l.sub?(d?l.sub.rewind(i):l.sub.order(t,i),a.__subindex=l.sub.index(),a.__subitem=l.sub.next(i),a._subindex=null,a._subitem=null):(a.__subindex=null,a.__subitem=null,a._subindex=null,a._subitem=null),"sequence"===l.type&&l.seq&&l.seq.length)for(o=0,s=l.seq.length;o<s;o++)d?l.seq[o].rewind(i):l.seq[o].order(n,i);return a._reset(i),l.sub&&(a._prev=a._prev&&null!=a.__subitem,a._next=a._next&&null!=a.__subitem,a._subindex=c.add(c.mul(a.__subindex,l.count),a._index),a._subitem=f.fusion(l.submethod,a._item,a.__subitem,a.dimension(),a.base(),l.subpos,l.subcascade)),a},index:function(n,e){if(e=!0===e,!arguments.length)return this.$.sub?this._subindex:this._index;var t,r=this,u=r[wn],l=yn.Arithmetic,i=l.O,o=(l.I,l.J),s=r.n,a=r.$,f=a.sub&&!e?a.subcount:a.count,c=a.sub&&!e?r._subindex:r._index,d=a.order;return n=l.wrapR(l.N(n),f),!l.equ(n,c)&&l.inside(n,o,f)&&(f=a.count,t=a.last,a.sub&&!e&&(a.sub.index(l.div(n,f)),r.__subindex=a.sub.index(),r.__subitem=a.sub.item(),n=l.mod(n,f)),Hn&d||(r.__index=n,r._index=n,r.__item=l.equ(i,n)?u.initial(s,a,1):l.equ(t,n)?u.initial(s,a,-1):u.unrank(n,s,a),r._update(),r._item=u.output(r.__item,r.__index,s,a),r._prev=null!=r.__item,r._next=null!=r.__item),a.sub&&(r._prev=r._prev&&null!=r.__subitem,r._next=r._next&&null!=r.__subitem,r._subindex=l.add(l.mul(r.__subindex,f),r._index),r._subitem=u.fusion(a.submethod,r._item,r.__subitem,r.dimension(),r.base(),a.subpos,a.subcascade))),r},item0:function(n){var e=this;return e[wn].initial(e.n,e.$,-1===n?-1:1)},item:function(n,e){if(!arguments.length)return this.$.sub?this._subitem:this._item;var u,l,i,o,s,a,f=this,c=f[wn],d=f.n,m=f.$,h=m.sub?m.subcount:m.count,p=m.sub?f._subindex:f._index,_=yn.Arithmetic,g=_.O,b=(_.I,_.J),v=null;return r(e)?-1<(a=e.indexOf("|"))?(v=e.substr(a+1),e=U(e.substr(0,a))):v=e=U(e):null!=e?v=e=U(e):(e=m.order,v=null),m.sub||(v=null),t(n)?(h=m.count,u=m.last,i=m.order,m.order=e,f.__item=n.slice(),f._update(),f.__index=c.rank(f.__item,d,m),f._item=c.output(f.__item,f.__index,d,m),f._index=f.__index,f._prev=null!=f.__item,f._next=null!=f.__item,f):(n=_.wrapR(_.N(n),h),e===m.order&&null===v&&_.equ(n,p)?m.sub?f._subitem:f._item:_.inside(n,b,h)?(s=null,h=m.count,u=m.last,m.sub&&(s=m.sub.item(_.div(n,h),v),n=_.mod(n,h)),Hn&e?(l=null,i=m.order,m.order=e,o=c.output(c.rand(d,m),l,d,m),m.order=i,m.sub&&(o=c.fusion(m.submethod,o,s,f.dimension(),f.base(),m.subpos,m.subcascade)),o):(l=n,i=m.order,m.order=e,o=c.output(_.equ(g,n)?c.initial(d,m,1):_.equ(u,n)?c.initial(d,m,-1):c.unrank(l,d,m),l,d,m),m.order=i,m.sub&&(o=c.fusion(m.submethod,o,s,f.dimension(),f.base(),m.subpos,m.subcascade)),o)):null)},random:function(n,e,t,r){var u,l=this,i=l[wn],o=l.$,s=o.order;if(r=!0===r,"index"===n){var a,f,c=yn.Arithmetic,d=c.N,m=c.O,h=c.I;return e===!!e&&(r=e,e=null,t=null),o.sub&&!r?(a=o.subcount,f=c.sub(a,h)):(a=o.count,f=o.last),null==e&&null==t?(e=m,t=f):null==t?(e=d(e||0),t=f):(e=d(e),t=d(t)),c.rnd(e,t)}return o.order|=Hn,u=i.rand(l.n,o),o.order=s,u=i.output(u,null,l.n,o),o.sub&&!r?i.fusion(o.submethod,u,o.sub.random(),l.dimension(),l.base(),o.subpos,o.subcascade):u},rewind:function(n){return this.order(!0,-1===n?-1:1)},hasNext:function(n){var e=this;return-1===n?!(Hn&e.$.order)&&e._prev:e._next},next:function(n){var e,t,r,u,o,s,a=this,f=a[wn],c=yn.Arithmetic,d=c.O,m=c.I,h=c.J,p=a.n,_=a.$,g=_.order,b=_.count,v=_.sub?a._subitem:a._item,y=null!=v;if(0>(n=-1===n?-1:1)&&Hn&g)return null;if(e=0>n?h:m,Hn&g)if(u=_.last,c.lt(a._index,u))if(t=a._traversed){for(r=a.random("index"),o=yn.Math.rnd()>.5?h:m;t.isset(+r);)r=c.wrap(c.add(r,o),d,u);t.set(+r),a.__item=f.unrank(r,p,_),null!=a.__item&&(a.__index=r)}else a.__item=f.rand(p,_),a.__index=null;else a._item=a.__item=null,a._traversed&&(a._traversed.dispose(),a._traversed=null);else a.__item=f.succ(a.__item,a.__index,p,_,n,a.item__),null!=a.__item&&(a.__index=c.add(a.__index,e));if(s=null!=a.__item)a._index=c.add(a._index,e),null===a.__index&&(a.__index=a._index),0>n?(a._prev=s,a._next=y):(a._prev=y,a._next=s);else if(_.sub&&_.sub.hasNext(n)){if(a.__subindex=_.sub.index(),a.__subitem=_.sub.next(n),"sequence"===_.type&&_.seq&&_.seq.length)for(i=0,l=_.seq.length;i<l;i++)_.seq[i].rewind(n);a._reset(n),s=null!=a.__item}else a.__subindex=null,a.__subitem=null,0>n?(a._prev=s,a._next=y):(a._prev=y,a._next=s);return a._item=f.output(a.__item,a.__index,p,_),_.sub&&(s=s&&null!=a.__subitem,a._subindex=s?c.add(c.mul(a.__subindex,b),a._index):null,a._subitem=s?f.fusion(_.submethod,a._item,a.__subitem,a.dimension(),a.base(),_.subpos,_.subcascade):null,0>n?a._prev=s:a._next=s),v},range:function(n,e){var t,r,u,l,i=this,o=yn.Arithmetic,a=o.N,f=o.O,c=o.I,d=i.$,m=d.sub?d.subcount:d.count,h=d.sub?o.sub(m,c):d.last,p=1,_=arguments.length,g=!(Hn&d.order);return _<1?(n=f,e=h):_<2?(n=a(n),e=h):(n=a(n),e=a(e)),n=o.wrapR(n,m),e=o.wrapR(e,m),o.gt(n,e)&&(t=n,n=e,e=t,p=-1),n=o.clamp(n,f,h),g&&(e=o.clamp(e,f,h)),o.lte(n,e)?(l=[i.$.order,i.__index,i._index,i.__item&&i.__item.slice(),i._item,i.__subindex,i._subindex,i.__subitem,i._subitem,i._prev,i._next],g&&i.index(n),u=o.val(o.sub(e,n)),r=s(function(n,e,t){return n[t]=i.next(),n},new Array(u+1),null,0>p?u:0,0>p?0:u,0>p?-1:1),i.$.order=l[0],i.__index=l[1],i._index=l[2],i.__item=l[3],i._item=l[4],i.__subindex=l[5],i._subindex=l[6],i.__subitem=l[7],i._subitem=l[8],i._prev=l[9],i._next=l[10],i._update()):r=[],r},__iter__:function(){return new gn.Iterable(this)}}),"undefined"!=typeof Symbol&&void 0!==Symbol.iterator&&(gn[An][Symbol.iterator]=gn[An].__iter__),yn.Tensor=Dn(gn,{constructor:function n(){var e,u=this,l=null,i=On.call(arguments);if(e=!i.length||i[i.length-1]instanceof gn||t(i[i.length-1])||i[i.length-1]===+i[i.length-1]?{}:i.pop()||{},i.length&&t(i[0])&&(i=i[0]),i&&i.length||(i=[]),!(u instanceof n))return new n(i,e);if(e.type=String(e.type||"tensor").toLowerCase(),e.order=e.order||Vn,e.rand=e.rand||{},"partial"===e.type){i=t(i)&&i.length?i[0]:i;var o=-1,f=e.data||[],c=e.position||null;i instanceof gn?o=i=(l=i).base():l=e.sub,i=+(i||0)||0,f.length&&(r(f[0])||f[0].length&&(!0===f[0][0]||!1===f[0][0]))&&(o===i&&(i+=f.length,o=-1),f=n.generate(i,f,c,e.ordering||null)),o===i&&(i+=(f.length?f[0].length:0)||0,o=-1),e.data=f,e.position=c||a((f.length?f[0].length:0)||0,0,1),e.dimension=e.position.length,e.base=i,e.rand.partial=1}else if("tuple"===e.type)i[0]=i[0]||1,i[1]=i[1]||1,i[0]instanceof gn?(l=i[0],i[0]=l.dimension()):i[1]instanceof gn?(l=i[1],i[1]=l.base()):l=e.sub,e.base=i[1],e.dimension=i[0],"gray"===e.output&&(e.output=function(e,t){return n.gray(e,t[1])});else{var d=s(function(n,e){return e<n[0]&&(n[0]=e),e>n[1]&&(n[1]=e),n},[1/0,0],i);if(e.base=i,e.minbase=d[0],e.maxbase=d[1],e.dimension=i.length,"gray"===e.output)e.output=function(e,t){return n.gray(e,t)};else if(t(e.output)){var m=e.output;e.output=function(e,t){return n.component(e,m)}}}gn.call(u,"Tensor",i,e,l?{method:"partial"===e.type?e.submethod||"complete":e.submethod,iter:l,pos:"partial"===e.type?e.subpos||e.position:e.subpos,cascade:e.subcascade}:null)},__static__:{C:gn.C,P:gn.P,T:gn.T,DUAL:gn.DUAL,count:function(n,e){var t=yn.Arithmetic.O,r=e&&e.type?e.type:"tensor";return"partial"===r?e.data&&e.data.length?yn.Arithmetic.N(e.data.length):t:"tuple"===r?!n||0>=n[0]?t:yn.Math.exp(n[1],n[0]):n&&n.length?yn.Math.product(n):t},initial:function(n,e,t){var r,u=this,l=e&&e.type?e.type:"tensor",i=e&&e.order?e.order:Vn;return t=-1===t?-1:1,(!(Gn&i)&&Xn&i||Gn&i&&!(Xn&i))&&(t=-t),"partial"===l?r=e.data&&e.data.length?0>t?e.data[e.data.length-1]:e.data[0]:null:(r="tuple"===l?n[0]?0>t?a(n[0],n[1]-1,0):a(n[0],0,0):[]:n.length?0>t?a(n.length,function(e){return n[e]-1}):a(n.length,0,0):[],r=u.DUAL(r,n,e)),r},succ:function(n,e,t,r,u,l){if(!t||null==n)return null;var i=r&&r.type?r.type:"tensor",o=r&&null!=r.order?r.order:Vn;if(u=-1===u?-1:1,"partial"===i){if(!r.data||!r.data.length)return null;Xn&o&&(u=-u);var s=null==e?r.data.indexOf(n):yn.Arithmetic.val(e);return 0>u?0<=s-1?r.data[s-1]:null:0<=s&&s+1<r.data.length?r.data[s+1]:null}return!t[0]||0>=t[0]?null:fn(n,t,u,i,o)},rand:function(n,e){var t,r=yn.Math.rndInt,u=this,l=e&&e.type?e.type:"tensor";return"partial"===l?t=e.data&&e.data.length?e.data[r(0,e.data.length-1)]:null:(t="tuple"===l?n[0]?a(n[0],function(e){return r(0,n[1]-1)}):[]:n.length?a(n.length,function(e){return r(0,n[e]-1)}):[],t=u.DUAL(t,n,e)),t},randu:gn.rand,rank:function(n,e,t){var r,u,l=this,i=yn.Arithmetic,o=t&&null!=t.order?t.order:Vn,s=t&&t.type?t.type:"tensor",a=i.add,f=i.sub,c=i.mul,d=i.O,m=i.J;if("partial"===s)d=i.N(t.data&&t.data.length?t.data.indexOf(n):-1);else if(n=l.DUAL(n,e,t),"tuple"===s){if(!(r=e[0]))return m;for(e=e[1],u=0;u<r;u++)d=a(c(d,e),n[u])}else{if(!(r=e.length))return m;for(u=0;u<r;u++)d=a(c(d,e[u]),n[u])}return(!(Gn&o)&&Xn&o||Gn&o&&!(Xn&o))&&(d=f(t&&null!=t.last?t.last:f(l.count(e,t),i.I),d)),d},unrank:function(n,e,t){var r,u,l,i,o,s,a=this,f=yn.Arithmetic,c=t&&null!=t.order?t.order:Vn,d=t&&t.type?t.type:"tensor",m=f.sub,h=f.mod,p=f.div,_=f.val;if(null==n||!f.inside(n,f.J,t&&null!=t.count?t.count:a.count(e,t)))return null;if((!(Gn&c)&&Xn&c||Gn&c&&!(Xn&c))&&(n=m(t&&null!=t.last?t.last:m(a.count(e,t),f.I),n)),"partial"===d){if(!t.data||!t.data.length)return null;o=0<=(n=_(n))&&n<t.data.length?t.data[n]:null}else{if("tuple"===d){if(!(s=e[0]))return[];for(o=new Array(s),u=e[1],r=n,l=s-1;l>=0;l--)i=h(r,u),r=p(r,u),o[l]=_(i)}else{if(!(s=e.length))return[];for(o=new Array(s),r=n,l=s-1;l>=0;l--)i=h(r,u=e[l]),r=p(r,u),o[l]=_(i)}o=a.DUAL(o,e,t)}return o},fusion:gn.fusion,output:gn.output,gray:function(n,e){return h(new Array(n.length),n,e)},product:P,directsum:function(){var n,e,t=arguments,r=t.length,u=0;for(e=0;e<r;e++)u+=t[e].length;return n=0,e=0,a(u,function(r){return r>=n+t[e].length&&(n+=t[e++].length),n+t[e][r-n]})},component:function(n,e){return null==n?null:null==e?n:a(n.length,function(t){return t<e.length&&0<=n[t]&&n[t]<e[t].length?e[t][n[t]]:n[t]})},conditional:T,generate:function(n,e,l,i,o){var s,f,c,m,h,p,_,g,b,v=null==(o=o||{}).min?0:o.min,y=null==o.max?n-1:o.max,w=y-v+1,O=e,M=O.length,I=!1,S=[],q=[],L={},C=function(n){return v<=n&&n<=y};for(e=[],I=!1,h=0,c=0;c<M;c++,h++)if(f=O[c],r(f))if(s=f.match(En)){if(!(m=0<s[1].indexOf("..")?(s=s[1].split("..").map(Number))[0]>s[1]?j(n,a(s[0]-s[1]+1,s[1],1).filter(C)).reverse():j(n,a(s[1]-s[0]+1,s[0],1).filter(C)):j(n,s[1].split(",").map(Number).filter(C))).length){I=!0;break}e.push(m)}else if(s=f.match(Cn)){if(!(m=0<s[1].indexOf("..")?((s=s[1].split("..").map(Number))[0]>s[1]?a(s[0]-s[1]+1,s[0],-1):a(s[1]-s[0]+1,s[0],1)).filter(C):s[1].split(",").map(Number).filter(C)).length){I=!0;break}e.push(m)}else{if(p=-1,_=null,g=null,f=f.replace(Ln,function(n,e){return null===_&&(p=parseInt(e,10),_="v"+String(p)),_}),!C(p)){l&&l.splice(h--,1);continue}try{g=new Function(_,"return Math.floor("+f+");")}catch(n){g=null}if(!u(g)){l&&l.splice(h--,1);continue}L[p]?L[p].push(g):L[p]=[g],0>l.indexOf(p)&&q.push(p),S.push([g,null,null,p,l[h]]),e.push(S[S.length-1])}else if(t(f)){if(!(m=!1===f[0]?j(n,f.slice(1).filter(C)):f.slice(1).filter(C)).length){I=!0;break}e.push(m)}if(I&&(e=[]),q.length)for(c=0,M=q.length;c<M;c++)l.push(q[c]),I||e.push(a(w,v,1));if(-1===(c=A(l))?(d(l,l),I||d(e,e)):0===c&&(on(l,f=x(l,1,!1,!0)),I||on(e,f)),I)return[];if(S.length)for(c=0,M=S.length;c<M;c++)if(s=S[c],s[1]=l.indexOf(s[3]),s[2]=l.indexOf(s[4]),g=L[s[3]],!u(e[s[1]][0])){if(!(m=e[s[1]].filter(function(n){for(var e,t=0,r=g.length;t<r;t++)if(e=g[t](n),v>e||e>y)return!1;return!0})).length){I=!0;break}e[s[1]]=m}return I?[]:(i="="===i?Rn:"!="===i||"<>"===i?Nn:"<"===i?Un:"<="===i||"=<"===i?jn:">"===i?Pn:(">="===i||"=>"===i)&&Tn,b=u(o.extra_conditions)?function(n,e,t){return v<=n[e]&&n[e]<=y&&o.extra_conditions(n,e,t)}:function(n,e,t){return v<=n[e]&&n[e]<=y},!0===o.lazy?e:T(e,i,b))}}}),yn.Permutation=Dn(gn,{constructor:function n(e,r){var u=this,l=null;if(!(u instanceof n))return new n(e,r);(r=r||{}).type=String(r.type||"permutation").toLowerCase(),(e=e||0)instanceof gn?e=(l=e).dimension():l=r.sub,r.base=r.dimension=e,r.rand=r.rand||{},r.rand.derangement=1,r.rand.involution=1,r.rand.connected=1,"multiset"===r.type&&(r.multiplicity=t(r.multiplicity)&&r.multiplicity.length?r.multiplicity.slice():a(e,1,0),r.multiplicity=r.multiplicity.concat(a(e-s(M,0,r.multiplicity),1,0)),r.base=r.multiplicity.length,r.multiset=z(r.multiplicity,e)),gn.call(u,"Permutation",e,r,l?{method:r.submethod,iter:l,pos:r.subpos,cascade:r.subcascade}:null)},__static__:{C:gn.C,P:gn.P,T:gn.T,DUAL:gn.DUAL,count:function(n,e){var t=yn.Arithmetic,r=t.O,u=yn.Math.factorial,l=yn.Math.stirling,i=e&&e.type?e.type:"permutation",o=e&&null!=e["cycles="]?0|e["cycles="]:null,s=e&&null!=e["fixed="]?0|e["fixed="]:null;return 0>n?r:"cyclic"===i?t.N(n):"multiset"===i?u(n,e.multiplicity):"derangement"===i?s?2>n-s?r:t.mul(u(n,s),u(n-s,!1)):2>n?r:u(n,!1):"involution"===i?u(n,!0):"connected"===i?u(n-1):o?l(n,o,1):u(n)},initial:function(n,e,t){var r,u=this,l=e&&e.type?e.type:"permutation",i=e&&null!=-e.order?e.order:Vn,o=e&&null!=e["cycles="]?0|e["cycles="]:null,s=e&&null!=e["fixed="]?0|e["fixed="]:null;if(0===n)return[];if(t=-1===t?-1:1,(!(Gn&i)&&Xn&i||Gn&i&&!(Xn&i))&&(t=-t),"cyclic"===l)r=0>t?[n-1].concat(a(n-1,0,1)):a(n,0,1);else if("derangement"===l){if(s||2>n)return null;if(1&n){var f=xn.floor(n/2);r=0>t?a(n-f-1,n-1,-1).concat([f-1,f]).concat(a(f-1,f-2,-1)):a(n-3,function(n){return 1&n?n-1:n+1}).concat([n-2,n-1,n-3])}else r=0>t?a(n,n-1,-1):a(n,function(n){return 1&n?n-1:n+1})}else r="multiset"===l?0>t?e.multiset.slice().reverse():e.multiset.slice():"connected"===l?null:"involution"===l?0>t?a(n,n-1,-1):a(n,0,1):o?null:0>t?a(n,n-1,-1):a(n,0,1);return r=u.DUAL(r,n,e)},succ:function(n,e,t,r,u,l){if(!t||0>=t||null==n)return null;var i=r&&r.type?r.type:"permutation",o=r&&null!=r["cycles="]?0|r["cycles="]:null,s=r&&null!=r["fixed="]?0|r["fixed="]:null;return"derangement"===i&&s||"permutation"===i&&o?null:(u=-1===u?-1:1,cn(n,t,u,i,r&&null!=r.order?r.order:Vn,r&&null!=r.base?r.base:null))},rand:function(n,e){var t,r=yn.Math.rndInt,u=this,l=e&&e.type?e.type:"permutation",i=e&&null!=e["cycles="]?0|e["cycles="]:null,o=e&&null!=e["fixed="]?0|e["fixed="]:null;if(0===n)return[];if("cyclic"===l){var s=r(0,n-1);t=0<s?a(n-s,s,1).concat(a(s,0,1)):a(n,0,1)}else if("derangement"===l){if(o)return null;t=new Array(n);var f,c,d=!1;do{for(f=0;f<n;f++)t[f]=f;for(f=n-1,d=!1;0<=f;){if(c=r(0,f),t[c]===f){d=!0;break}_=t[f],t[f]=t[c],t[c]=_,f--}d=d||0===t[0]}while(d)}else if("involution"===l){t=a(n,0,1);for(var m,h,p,_,g,b=yn.Math.rnd,v=.5,y=1,x=n,A=[1].concat(a(n-1,function(){var n=v;return y+=1,v=1/(1+y*v),n})),O=a(n,0,1);2<=x;)m=O[x-1],v=A[--x],(_=b())>v&&(p=O[h=r(0,x-1)],--x,g=O[h],O[h]=O[x],O[x]=g,g=t[p],t[p]=t[m],t[m]=g)}else if("multiset"===l)t=w(e.multiset.slice());else if("connected"===l)t=w(a(n,0,1),!0);else{if(i)return null;t=w(a(n,0,1))}return t=u.DUAL(t,n,e)},randu:gn.rand,rank:function(n,t,r){var u,l,i,o,s,a=this,f=yn.Arithmetic,c=r&&r.type?r.type:"permutation",d=r&&null!=r["cycles="]?0|r["cycles="]:null,m=(r&&null!=r["fixed="]&&r["fixed="],r&&null!=-r.order?r.order:Vn),h=f.sub,p=f.add,_=f.mul,g=f.div,b=f.O,v=f.I,y=f.J;if(!(t=t||n.length))return b;if(n=a.DUAL(n,t,r),"cyclic"===c)b=f.NUM(n[0]);else{if("derangement"===c||"involution"===c||"connected"===c)return e();if("multiset"===c)for(s=r.multiplicity.slice(),o=r&&null!=r.count?r.count:yn.Math.factorial(t,s),i=t-1,u=0;u<i&&f.gt(o,v);u++)b=p(b,g(_(o,I(s,0,(l=n[u])-1,1)),t-u)),o=g(_(o,s[l]),t-u),s[l]--;else{if(d)return y;for(n=nn(null,n),i=t-1,u=0;u<i;u++)b=p(_(b,t-u),n[u])}}return(!(Gn&m)&&Xn&m||Gn&m&&!(Xn&m))&&(b=h(r&&null!=r.last?r.last:h(a.count(t,r),v),b)),b},unrank:function(n,t,r){var u,l,i,o,s,f,c,d,m=this,h=yn.Arithmetic,p=r&&r.type?r.type:"permutation",_=r&&null!=r["cycles="]?0|r["cycles="]:null,g=(r&&null!=r["fixed="]&&r["fixed="],r&&null!=-r.order?r.order:Vn),b=h.mod,v=h.div,y=h.mul,x=h.sub,A=h.val;if(null==n||!h.inside(n,h.J,r&&null!=r.count?r.count:m.count(t,r)))return null;if(!t)return[];if((!(Gn&g)&&Xn&g||Gn&g&&!(Xn&g))&&(n=x(r&&null!=r.last?r.last:x(m.count(t,r),h.I),n)),"cyclic"===p)n=A(n),u=a(t,function(e){return(n+e)%t});else{if("derangement"===p||"involution"===p||"connected"===p)return e();if("multiset"===p)for(d=r.multiplicity.slice(),u=a(t),c=r&&null!=r.count?r.count:yn.Math.factorial(t,d),i=0;i<t;i++){for(s=0,o=0,l=A(v(y(n,t-i),c));o<d.length&&s+d[o]<=l;)s+=d[o++];n=x(n,v(y(c,s),t-i)),c=v(y(c,d[o]),t-i),d[o]--,u[i]=o}else{if(_)return null;for((u=a(t))[t-1]=0,l=n,i=t-2;i>=0;i--)f=b(l,s=t-i),l=v(l,s),u[i]=A(f);en(u,u)}}return u=m.DUAL(u,t,r)},fusion:gn.fusion,output:gn.output,permute:on,shuffle:function(n,e){if("cyclic"===e){var t=n.length,r=yn.Math.rndInt(0,t-1);return 0<r&&n.push.apply(n,n.splice(0,r)),n}return"connected"===e?w(n,!0):w(n)},product:function(){return arguments.length?sn(t(arguments[0])&&t(arguments[0][0])?arguments[0]:On.call(arguments)):null},directsum:function(){return arguments.length?an(t(arguments[0])&&t(arguments[0][0])?arguments[0]:On.call(arguments)):null},cycles:function(n,e){return-1===e?cycles2permutation(n):rn(n)},swaps:function(n,e){return-1===e?ln(n):un(n)},inversion:function(n,e){return-1===e?en(null,n):nn(null,n)},inverse:function(n){return Z(null,n)},multiset:function(n,e,t){return n===+n?z(e,n,-1===t?-1:1):-1===t?K(n):Q(n,e)},matrix:function(n,e,t){return-1===t?Y(null,n,e):B(null,n,e)},parity:e,is_permutation:function(n,e){if((e=e||n.length)!==n.length)return!1;var t,r,u=a(e,0,0);for(t=0;t<e;t++){if(0>(r=n[t])||r>=e||0<u[r])return!1;u[r]++}for(t=0;t<e;t++)if(1!==u[t])return!1;return!0},is_identity:function(n){for(var e=n.length,t=0;t<e;t++)if(n[t]!==t)return!1;return!0},is_cyclic:function(n){for(var e=n.length,t=1,r=n[0];t<e;t++)if(n[t]!==(r+t)%e)return!1;return!0},is_derangement:function(n,e,t){e|=0;for(var r=0,u=n.length,l=0;l<u;l++)if(n[l]===l&&++r>e)return!1;return!0!==t||r===e},is_involution:function(n){for(var e=n.length,t=0,r=n[t];t<e;t++,r=n[t])if(0>r||e<=r||n[r]!==t)return!1;return!0},is_kthroot:function(n,e){if(1>(e=e||1))return!1;var t,r,u,l=n.length;for(t=0;t<l;t++){for(r=n[t],u=1;u<=e&&t!==r;)u++,r=n[r];if(t!==r||u!==e&&(u>=e||0<e%u))return!1}return!0},is_connected:function(n){for(var e=n.length-1,t=-1,r=0,u=n[r];r<e;r++,u=n[r])if(u>t&&(t=u),t<=r)return!1;return!0},is_kcycle:function(n,e,t,r){if(!n.length||0>=e)return!1;r=!1!==r;var u,l,i,o,s,a=n.length;for(u=0,i=0,s=0,o=new Array(a);s<a;){if(l=n[u],u===l||1===o[l])for((r||u!==l)&&i++,o[l]=1,u=0;u<a&&1===o[n[u]];)u++;else o[l]=1,u=l;s++}return"<="===t?i<=e:">="===t?i>=e:i===e}},_update:function(){var n=this;return n.item__=(n.__item,n.n,n.$.order,n.$.type,null),n}}),bn=yn.Combination=Dn(gn,{constructor:function n(e,r,u){var l=this,i=null;if(!(l instanceof n))return new n(e,r,u);if(t(e)?(u=r||{},r=e[1]||0,e=e[0]||0):(u=u||{},e=e||0,r=r||0),u.type=String(u.type||"unordered").toLowerCase(),-1<u.type.indexOf("+")){var o=u.type.split("+");o.sort(),u.type=o.join("+")}r instanceof gn?r=(i=r).dimension():e instanceof gn?e=(i=e).base():i=u.sub,u.base=e,u.dimension=r,"binary"===u.output?u.output=function(e,t){return n.binary(e,t[0],1)}:"conjugate"===u.output&&(u.output=function(e,t){return n.complement(e,t[0])}),gn.call(l,"Combination",[e,r],u,i?{method:u.submethod,iter:i,pos:u.subpos,cascade:u.subcascade}:null)},__static__:{C:gn.C,P:gn.P,T:gn.T,DUAL:gn.DUAL,count:function(n,e){var t=yn.Math.factorial,r=e&&e.type?e.type:"unordered";return"ordered+repeated"===r?yn.Math.exp(n[0],n[1]):"repeated"===r?t(n[0]+n[1]-1,n[1]):"ordered"===r?t(n[0],-n[1]):t(n[0],n[1])},initial:function(n,e,t){var r,u=this,l=e&&e.type?e.type:"unordered",i=e&&null!=e.order?e.order:Vn;return 0===n[1]?[]:(t=-1===t?-1:1,(!(Gn&i)&&Xn&i||Gn&i&&!(Xn&i))&&(t=-t),r="ordered+repeated"===l||"repeated"===l?0>t?a(n[1],n[0]-1,0):a(n[1],0,0):"ordered"===l?0>t?a(n[1],n[0]-1,-1):a(n[1],0,1):0>t?a(n[1],n[0]-n[1],1):a(n[1],0,1),r=u.DUAL(r,n,e))},succ:function(n,e,t,r,u,l){return!t||!t[0]||0>=t[0]||0===t[1]||null==n?null:(u=-1===u?-1:1,mn(n,t,u,r&&r.type?r.type:"unordered",r&&null!=r.order?r.order:Vn,l))},rand:function(n,e){var t,r,u,l,i=this,o=e&&e.type?e.type:"unordered",s=n[1],f=yn.Math.rndInt;return 0===s?[]:(n=n[0],r=n-s,u=n-1,"repeated"===o||"ordered+repeated"===o?(t=1===s?[f(0,u)]:a(s,function(){return f(0,u)}),1<s&&"repeated"===o&&x(t,1,!0)):"ordered"===o?(l={},t=1===s?[f(0,u)]:n===s?w(a(s,0,1)):a(s,function(){for(var e=f(0,u);1===l[e];)e=(e+1)%n;return l[e]=1,e})):(l={},t=1===s?[f(0,u)]:n===s?a(s,0,1):r<s?j(n,a(r,function(){for(var e=f(0,u);1===l[e];)e=(e+1)%n;return l[e]=1,e}),!0):x(a(s,function(){for(var e=f(0,u);1===l[e];)e=(e+1)%n;return l[e]=1,e}),1,!0)),t=i.DUAL(t,n,e))},randu:gn.rand,rank:function(n,e,t){var r,u,l,i,o,s=this,a=yn.Arithmetic,f=a.add,c=a.sub,d=a.mul,m=a.O,h=a.I,p=m,_=e[1],g=t&&null!=t.order?t.order:Vn,b=t&&t.type?t.type:"unordered",v=yn.Math.factorial;if(0===_)return m;if(n=s.DUAL(n,e,t),"ordered+repeated"===b)for(i=e[0],r=0;r<_;r++)p=f(d(p,i),n[r]);else if("repeated"===b){for(i=e[0]+_-1,o=t&&t.count?t.count:v(i,_),r=1;r<=_;r++)(l=_+1-r)<=(u=i-1-n[r-1]-r+1)&&(p=f(p,v(u,l)));p=c(c(o,h),p)}else if("ordered"===b)for(n=nn(null,n,i=e[0]),r=0;r<_;r++)p=f(d(p,i-r),n[r]);else{for(i=e[0],o=t&&t.count?t.count:v(i,_),r=1;r<=_;r++)(l=_+1-r)<=(u=i-1-n[r-1])&&(p=f(p,v(u,l)));p=c(c(o,h),p)}return(!(Gn&g)&&Xn&g||Gn&g&&!(Xn&g))&&(p=c(t&&null!=t.last?t.last:c(s.count(e,t),h),p)),p},unrank:function(n,e,t){var r,u,l,i,o,s,f,c=this,d=yn.Arithmetic,m=d.O,h=d.I,p=d.sub,_=d.div,g=d.mod,b=d.mul,v=d.lte,y=d.gt,x=d.val,A=e[1],w=t&&t.type?t.type:"unordered",O=t&&null!=t.order?t.order:Vn;if(e=e[0],null==n||!d.inside(n,d.J,t&&null!=t.count?t.count:c.count(e,t)))return null;if(0===A)return[];if((!(Gn&O)&&Xn&O||Gn&O&&!(Xn&O))&&(n=p(t&&null!=t.last?t.last:p(c.count(e,t),d.I),n)),r=a(A),"ordered+repeated"===w)for(i=n,s=A-1;s>=0;s--)o=g(i,e),i=_(i,e),r[s]=x(o);else if("ordered"===w){for(i=n,s=A-1;s>=0;s--)o=g(i,l=e-s),i=_(i,l),r[s]=x(o);en(r,r,l)}else{l=(f="repeated"===w)?e+A-1:e,n=p(p(u=t&&t.count?t.count:yn.Math.factorial(l,A),h),n),u=_(b(u,l-A),l),o=l-A+1,i=A,s=l-1;do{v(u,n)?(r[A-i]=f?l-o-A+1:l-o-i+1,y(u,m)&&(n=p(n,u),u=_(b(u,i),s)),i--,s--):(u=_(b(u,s-i),s),o--,s--)}while(i>0)}return r=c.DUAL(r,e,t)},fusion:gn.fusion,output:gn.output,complement:function(n,e,t){return!0===t?w(j(e,n,!0)):j(e,n)},binary:function(n,e,t){return-1===t?J(n,e):X(n,e)},pick:function(n,e,t){return 0<e&&n.length?O(n,e,"ordered+repeated"!==t&&"ordered"!==t,"ordered+repeated"===t||"repeated"===t,new Array(e)):[]},choose:function(n,e){return e&&e.length?a(e.length,function(t){return 0<=e[t]&&e[t]<n.length?n[e[t]]:null}):[]}},_update:function(){var n=this;return n.item__=dn(n.__item,n.n[0],n.n[1],n.$.order,n.$.type),n}}),bn.conjugate=bn.complement,bn.project=bn.choose,yn.Powerset=yn.Subset=Dn(gn,{constructor:function n(e,t){var r=this,u=null;if(!(r instanceof n))return new n(e,t);t=t||{},(e=e||0)instanceof gn?e=(u=e).base():u=t.sub,t.type=t.type||"subset",t.rand=t.rand||{},t.rand.subset=1,t.base=e,t.dimension=e,t.mindimension=0,t.maxdimension=e,"binary"===t.output&&(t.output=function(e,t){return n.binary(e,t,1)}),gn.call(r,"Subset",e,t,u?{method:t.submethod,iter:u,pos:t.subpos,cascade:t.subcascade}:null)},__static__:{C:gn.D,P:gn.P,T:gn.T,DUAL:function(n,e,t,r){if(null==n)return null;var u,l=this,i=null;return t&&"binary"===t.type&&(u=t&&null!=t.order?t.order:Vn,i=t.order,t.order=Jn&u?u&~Jn:u|Jn),n=gn.DUAL.call(l,n,e,t,r),t&&null!=i&&(t.order=i),n},count:function(n,e){return yn.Math.pow2(n)},initial:function(n,e,t){var r,u=this,l=e&&null!=e.order?e.order:Vn;return t=-1===t?-1:1,(!(Gn&l)&&Xn&l||Gn&l&&!(Xn&l))&&(t=-t),r=new Array(n+1),r[n]=0,e&&"binary"===e.type?0>t&&s(function(n,e){r[e]=e},null,null,0,n,1):0>t&&(r[0]=n-1,r[n]=1),r=u.DUAL(r,n,e,1)},succ:function(n,e,t,r,u,l){return null==n?null:r&&"binary"===r.type?gn.succ.call(this,n,e,t,r,u):hn(n,t,-1===u?-1:1,r&&null!=r.order?r.order:Vn)},rand:function(n,e){for(var t,r=this,u=yn.Math.rndInt,l=null,i=n-1;i>=0;i--)u(0,1)&&(l={len:l?l.len+1:1,k:i,next:l});return t=l?a(l.len,function(n){var e=l.k;return l=l.next,e}):[],t=t.concat(t.length<n?new Array(n-t.length):[]).concat(t.length),t=r.DUAL(t,n,e,1)},randu:gn.rand,rank:function(n,t,r){var u,l,i,o=this,s=yn.Arithmetic,a=s.O,f=s.I,c=s.add,d=s.shl,m=s.sub,h=r&&null!=r.order?r.order:Vn;if(!r||"binary"!==r.type)return e();for(u=a,l=0,i=(n=o.DUAL(n,t,r,-1))[t];l<i;)u=c(u,d(f,n[l++]));return(!(Gn&h)&&Xn&h||Gn&h&&!(Xn&h))&&(u=m(r&&null!=r.last?r.last:m(o.count(t,r),f),u)),u},unrank:function(n,t,r){var u,l,i=this,o=yn.Arithmetic,s=o.O,a=o.band,f=o.shr,c=o.gt,d=o.sub,m=r&&null!=r.order?r.order:Vn;if(null==n||!o.inside(n,o.J,r&&null!=r.count?r.count:i.count(t,r)))return null;if(!r||"binary"!==r.type)return e();for((!(Gn&m)&&Xn&m||Gn&m&&!(Xn&m))&&(n=d(r&&null!=r.last?r.last:d(count,o.I),n)),(u=new Array(t+1))[t]=0,l=0;c(n,s);)c(a(n,1),s)&&(u[u[t]++]=l),c(a(n,2),s)&&(u[u[t]++]=l+1),c(a(n,4),s)&&(u[u[t]++]=l+2),c(a(n,8),s)&&(u[u[t]++]=l+3),c(a(n,16),s)&&(u[u[t]++]=l+4),c(a(n,32),s)&&(u[u[t]++]=l+5),c(a(n,64),s)&&(u[u[t]++]=l+6),c(a(n,128),s)&&(u[u[t]++]=l+7),l+=8,n=f(n,8);return u=i.DUAL(u,t,r,1)},fusion:gn.fusion,output:function(n,e,t,r){if(null==n)return null;if(t+1===n.length){var u=r&&null!=r.order?r.order:Vn,l=r&&"binary"===r.type,i=Gn&u&&!(Jn&u)||Jn&u&&!(Gn&u);n=l&&!i||i&&!l?n.slice(t-n[t],t):n.slice(0,n[t])}return gn.output.call(this,n,e,t,r)},binary:function(n,e,t){return-1===t?J(n,e):X(n,e)}}}),vn=yn.Partition=Dn(gn,{constructor:function n(e,t){var r=this,u=null;if(!(r instanceof n))return new n(e,t);(t=t||{}).type=t.type||"partition",(e=e||1)instanceof gn?e=(u=e).base():u=t.sub;var l=t["max="]?0|t["max="]:null,i=t["parts="]?0|t["parts="]:null,o=i||(l?e-l+1:e),s=i||(l?xn.ceil(e/l):1);t.base=e,t.dimension=i||(l?e-l+1:e),t.mindimension=xn.min(s,o),t.maxdimension=xn.max(s,o),t.rand=t.rand||{},t.rand.partition=1,t.rand.composition=1,"conjugate"===t.output?t.output=function(n,e){return F(0,n,Jn&t.order&&!(Gn&t.order)||Gn&t.order&&!(Jn&t.order)?-1:1)}:"subset"===t.output?t.output=function(e,t){return n.subset(e,1)}:"packed"===t.output&&(t.output=function(e,t){return n.pack(e,1)}),gn.call(r,"Partition",e,t,u?{method:t.submethod,iter:u,pos:t.subpos,cascade:t.subcascade}:null)},__static__:{C:function(n,e,t,r,u){var l="composition"===(r&&r.type?r.type:"partition"),i=r&&r["max="]?0|r["max="]:null;if((r&&r["parts="]?0|r["parts="]:null)||i)return n;if(t+1===n.length){var o,s=-1===u;(o=(n=F(l,n=s?n.slice(t-n[t],t):n.slice(0,n[t]),u)).length)<t&&n[s?"unshift":"push"].apply(n,new Array(t-o)),n.push(o)}else n=F(l,n,u);return n},P:gn.P,T:gn.T,DUAL:function(n,e,t,r){if(null==n)return null;var u=this,l=(t&&t.type&&t.type,t&&null!=t.order?t.order:Vn),i=null;return Gn&l&&(i=t.order,t.order=Jn&l?l&~Jn:l|Jn),n=gn.DUAL.call(u,n,e,t,r),t&&null!=i&&(t.order=i),n},count:function(n,e){var t=e&&e["max="]?0|e["max="]:null,r=e&&e["parts="]?0|e["parts="]:null;return"composition"===(e&&e.type?e.type:"partition")?yn.Math.compositions(n,r,t):yn.Math.partitions(n,r,t)},initial:function(n,e,t){var r,u,l,i=this,o=e&&e.type?e.type:"partition",f=e&&e["max="]?0|e["max="]:null,c=e&&e["parts="]?0|e["parts="]:null,m=e&&null!=e.order?e.order:Vn,h=c||(f?n-f+1:n),p="composition"===o;return 0>=n||c&&f&&(c+f>n+1||c*f<n)||c&&c>n||f&&f>n?null:(t=-1===t?-1:1,(!(Gn&m)&&Xn&m||Gn&m&&!(Xn&m))&&(t=-t),r=new Array(h+1),r[h]=0,c&&f?(r[h]=c,1===c&&(r[0]=f),p?(r=s(function(n,e,t){return n[t]=e,n},r,[(n-f)%(l=xn.min(f,xn.ceil((n-f)/(c-1))))||l].concat(a(c-2,l,0)).concat([f])),0>t&&d(r,r,c,0,c-1)):0>t?(c-=u=xn.min(c,xn.floor(n/f)||1),0===(n-=u*f)&&0<c&&(u--,c++,n+=f),r=s(function(n,e,t){return n[t]=e,n},r,[f].concat(a(u-1,f,0)).concat(0<n&&0<c?[n-c+1].concat(a(c-1,1,0)):[]))):(l=xn.min(f,xn.ceil((n-f)/(c-1))),r=s(function(n,e,t){return n[t]=e,n},r,[f].concat(a(c-2,l,0).concat([(n-f)%l||l]))))):c?(r[h]=c,p?(r=s(function(n,e,t){return n[t]=e,n},r,a(c-1,1,0).concat([n-c+1])),0>t&&d(r,r,c,0,c-1)):(u=n%(l=xn.ceil(n/c))||l,r=s(function(n,e,t){return n[t]=e,n},r,0>t?[n-c+1].concat(a(c-1,1,0)):a(c-1,l,0).concat([u])))):f?(u=xn.floor(n/f),l=n%f,r=p?s(function(n,e,t){return n[t]=e,n[h]++,n},r,0>t?a(u,f,0).concat(l?[l]:[]):a(n-f,1,0).concat([f])):s(function(n,e,t){return n[t]=e,n[h]++,n},r,0>t?a(u,f,0).concat(l?[l]:[]):[f].concat(a(n-f,1,0)))):r=s(function(n,e,t){return n[t]=e,n[h]++,n},r,0>t?[n]:a(n,1,0)),r=i.DUAL(r,n,e,1))},succ:function(n,e,t,r,u,l){if(null==t||null==n)return null;var i=r&&r.type?r.type:"partition",o=r&&r["max="]?0|r["max="]:null,s=r&&r["parts="]?0|r["parts="]:null;return 0>=t||s&&o&&(s+o>t+1||s*o<t)||s&&s>t||o&&o>t?null:(u=-1===u?-1:1,"composition"===i?_n(n,t,u,s,o,r&&null!=r.order?r.order:Vn):pn(n,t,u,s,o,r&&null!=r.order?r.order:Vn))},rand:function(n,e){var t,r,u,l,i,o,s=this,f=yn.Math.rndInt,c=e&&e.type?e.type:"partition",d=(e&&null!=e.order&&e.order,e&&e["max="]?0|e["max="]:null),m=e&&e["parts="]?0|e["parts="]:null,h=0,p=0,_=m||(d?n-d+1:n),g="composition"===c,b=!1;if(0>=n||m&&d&&(m+d>n+1||m*d<n)||m&&m>n||d&&d>n)return null;if(m&&d)return null;if(d&&!m&&(m=d,b=!0),m)1===m?(r=[n],p=n):n===m?(r=a(m,1,0),p=n):(t={},u=n-2,a(r=x(a(m-1,function(){for(i=f(0,u);1===t[i];)i=(i+1)%(u+1);return t[i]=1,i+1})),function(n){return i=r[n],l=i-h,h=i,p+=l,l}));else{for(t=null,i=1;i<n;i++)f(0,1)&&(l=i-h,h=i,p+=l,t={len:t?t.len+1:1,x:l,next:t});r=t?a(t.len,function(){return l=t.x,t=t.next,l}):[]}return p<n&&(r.length?r.splice(f(0,r.length-1),0,n-p):r.push(n-p)),g?b&&(r=w(F(0,x(r,-1)))):(r=x(r,-1),b&&(r=F(0,r))),(o=r.length)<_&&r.push.apply(r,new Array(_-o)),r.push(o),r=s.DUAL(r,n,e,1)},randu:gn.rand,rank:e,unrank:e,fusion:gn.fusion,output:function(n,e,t,r){if(null==n)return null;var u=r&&r["max="]?0|r["max="]:null,l=r&&r["parts="]?0|r["parts="]:null,i=r&&null!=r.order?r.order:Vn,o=l||(u?t-u+1:t);if(o+1===n.length){n=Jn&i?n.slice(o-n[o],o):n.slice(0,n[o])}return gn.output.call(this,n,e,t,r)},conjugate:function(n,e){return F("composition"===e,n)},subset:function(n,e){return-1===e?G(n):V(n)},pack:function(n,e){return-1===e?W(n):H(n)}},_update:function(){var n=this;return n.item__=(n.__item,n.n,n.$.order,n.$.type,n.$,null),n}}),vn.transpose=vn.conjugate,yn});