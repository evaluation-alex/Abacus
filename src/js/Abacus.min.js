/**
*
*   Abacus
*   A combinatorics library for Node/XPCOM/JS, PHP, Python
*   @version: 0.7.0
*   https://github.com/foo123/Abacus
**/
!function(n,e,t){"use strict";"undefined"!=typeof Components&&"object"==typeof Components.classes&&"object"==typeof Components.classesByID&&Components.utils&&"function"==typeof Components.utils["import"]?(n.$deps=n.$deps||{})&&(n.EXPORTED_SYMBOLS=[e])&&(n[e]=n.$deps[e]=t.call(n)):"object"==typeof module&&module.exports?(module.$deps=module.$deps||{})&&(module.exports=module.$deps[e]=t.call(n)):"undefined"!=typeof System&&"function"==typeof System.register&&"function"==typeof System["import"]?System.register(e,[],function(r){r(e,t.call(n))}):"function"==typeof define&&define.amd&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(e)?define(e,["module"],function(e){return t.moduleUri=e.uri,t.call(n)}):e in n||(n[e]=t.call(n)||1)&&"function"==typeof define&&define.amd&&define(function(){return n[e]})}(this,"Abacus",function(n){"use strict";function e(){throw new Error("Method not implemented!")}function t(n){if(!arguments.length||null==n)return vn;if(fn(n)){for(var e=0,t=n.toUpperCase().split(","),r=0,i=t.length;i>r;r++)n=t[r],e|=un.call(nn.ORDER,n)?nn.ORDER[n]:0;return e>0?e:vn}return wn&n?n:vn}function r(n,e,t){n=0|n;var r,i,u,l,o,a=n>0?new Array(n):[];if(n>0&&null!=e)if(i=15&n,r=1&i,e===+e){for(t=t||0,o=e,r&&(a[0]=o,o+=t),l=r;i>l;l+=2)u=l,a[u]=o,o+=t,u+=1,a[u]=o,o+=t;for(l=i;n>l;l+=16)u=l,a[u]=o,o+=t,u+=1,a[u]=o,o+=t,u+=1,a[u]=o,o+=t,u+=1,a[u]=o,o+=t,u+=1,a[u]=o,o+=t,u+=1,a[u]=o,o+=t,u+=1,a[u]=o,o+=t,u+=1,a[u]=o,o+=t,u+=1,a[u]=o,o+=t,u+=1,a[u]=o,o+=t,u+=1,a[u]=o,o+=t,u+=1,a[u]=o,o+=t,u+=1,a[u]=o,o+=t,u+=1,a[u]=o,o+=t,u+=1,a[u]=o,o+=t,u+=1,a[u]=o,o+=t}else if("function"==typeof e){for(r&&(a[0]=e(0)),l=r;i>l;l+=2)u=l,a[u]=e(u),u+=1,a[u]=e(u);for(l=i;n>l;l+=16)u=l,a[u]=e(u),u+=1,a[u]=e(u),u+=1,a[u]=e(u),u+=1,a[u]=e(u),u+=1,a[u]=e(u),u+=1,a[u]=e(u),u+=1,a[u]=e(u),u+=1,a[u]=e(u),u+=1,a[u]=e(u),u+=1,a[u]=e(u),u+=1,a[u]=e(u),u+=1,a[u]=e(u),u+=1,a[u]=e(u),u+=1,a[u]=e(u),u+=1,a[u]=e(u),u+=1,a[u]=e(u)}else{for(r&&(a[0]=e),l=r;i>l;l+=2)u=l,a[u]=e,u+=1,a[u]=e;for(l=i;n>l;l+=16)u=l,a[u]=e,u+=1,a[u]=e,u+=1,a[u]=e,u+=1,a[u]=e,u+=1,a[u]=e,u+=1,a[u]=e,u+=1,a[u]=e,u+=1,a[u]=e,u+=1,a[u]=e,u+=1,a[u]=e,u+=1,a[u]=e,u+=1,a[u]=e,u+=1,a[u]=e,u+=1,a[u]=e,u+=1,a[u]=e,u+=1,a[u]=e}return a}function i(n,e,t,r,i,u){var l,o,a=e;if(t&&an(t)){if(l=t.length,null==r&&(r=0),null==i&&(i=l-1),null==u&&(u=1),l>0)if(0>u)for(o=r;o>=i;o+=u)a=n(a,t[o],o);else for(o=r;i>=o;o+=u)a=n(a,t[o],o)}else if(u=u||1,l=(i-r)/u+1,l>0)if(0>u)for(o=r;o>=i;o+=u)a=n(a,o,o);else for(o=r;i>=o;o+=u)a=n(a,o,o);return a}function u(){var n,e,t,r,i,u,l,o,a,f,s=arguments,c=s.length;if(!c)return[];if(!0===s[0]){for(a=s[1].length,n=2;c>n;n++)a*=s[n].length;for(f=new Array(a),n=0;a>n;n++){for(o=0,u=1,t=n,e=1;c>e;e++)r=s[e].length,i=t%r,t=~~(t/r),l=s[e][i],o+=u*l,u*=r;f[n]=o}}else{for(a=s[0].length,n=1;c>n;n++)a*=s[n].length;for(f=new Array(a),n=0;a>n;n++){for(o=[],t=n,e=c-1;e>=0;e--)if(r=s[e].length,i=t%r,t=~~(t/r),l=s[e][i],an(l))for(u=l.length-1;u>=0;u--)o.unshift(l[u]);else o.unshift(l);f[n]=o}}return f}function l(n){return i(nn.Arithmetic.add,nn.Arithmetic.O,n)}function o(n){return i(nn.Arithmetic.mul,nn.Arithmetic.I,n)}function a(n){var e=nn.Arithmetic;return e.shl(e.I,e.N(n))}function f(n,e){var t=nn.Arithmetic;return t.pow(t.N(n),t.N(e))}function s(n,e){var t,r,u,l,o,a=nn.Arithmetic,f=a.O,c=a.I,d=a.N,_=a.add,m=a.sub,h=a.div,b=a.mul;if(null==e)return n=d(n),a.lt(n,0)?f:a.lt(n,2)?c:a.lt(n,4)?a.shl(n,a.sub(n,2)):(o=String(n),null==s.mem1[o]&&(s.mem1[o]=i(b,c,null,2,a.val(n))),s.mem1[o]);if(!0===e)return u=d(n),i(function(n,e){return u===n?n:m(b(n,e),n)},u,null,n,1,-1);if(!1===e)return 1>n?f:(o=String(n),null==s.mem2[o]&&(s.mem2[o]=i(function(e,t){return e[1]=-1===e[2]?m(e[1],e[0]):_(e[1],e[0]),e[2]=-e[2],t>1&&n>=t&&(e[0]=b(e[0],t)),t>n?e[1]:e},[c,f,1],null,0,n+1)),s.mem2[o]);if(an(e)){if(o=String(n)+"@"+e.join(","),null==s.mem3[o]){if(t=s(n),a.gt(t,f))for(l=e.length,r=0;l>r;r++)t=h(t,s(e[r]));s.mem3[o]=t}return s.mem3[o]}return e===+e?0>e?-e>n?f:(o=String(n)+"@"+String(e),null==s.mem3[o]&&(s.mem3[o]=i(b,c,null,n+e+1,n)),s.mem3[o]):(e+e>n&&(e=n-e),0>e||1>n?f:0===e||1===n?c:1===e?d(n):(o=String(n)+"@"+String(e),null==s.mem3[o]&&(s.mem3[o]=h(s(n,-e),s(e))),s.mem3[o])):f}function c(n,e,t){var r,i,u,l,o=nn.Arithmetic,a=o.add,f=o.O;if(t===n&&1===e||e===n&&1===t)return o.I;if(t+e>n+1||n>e*t)return f;if(r=String(n)+","+String(e)+","+String(t),null==c.mem[r]){for(l=sn.max(1,sn.ceil((n-t)/(e-1))),u=sn.min(t,n-t-e+2),i=l;u>=i;i++)f=a(f,c(n-t,e-1,i));c.mem[r]=f}return c.mem[r]}function d(n,e){if(null==n)return null;if(!n.length)return[];var t,r=n.length,i=new Array(r);if(an(e))for(t=0;r>t;t++)i[t]=e[t]-1-n[t];else if(0>e)for(t=0;r>t;t++)i[t]=r-1-n[t];else for(e-=1,t=0;r>t;t++)i[t]=e-n[t];return i}function _(n){if(null==n)return null;for(var e=n.length-1,t=new Array(e+1),r=0;e>=r;r++)t[r]=n[e-r];return t}function m(n,e){if(null==e&&(e=0),an(n)){for(var t=n.length,r=new Array(t),i=0;t>i;i++)r[i]=e-n[i];return r}return n===+n&&e===+e?e-n:nn.Arithmetic.sub(nn.Arithmetic.N(e),n)}function h(n,e,t,r,i,u,l){null==t&&(t=0),null==r&&(r=n.length-1),null==i&&(i=0),null==u&&(u=e.length-1);var o=t>r?-1:1,a=i>u?-1:1,f=o*(r-t)+1,s=a*(u-i)+1,c=t,d=i,_=0;if(null===l&&(l=new Array(sn.min(f,s))),0===l.length)return l;for(;o*(r-c)>=0&&a*(u-d)>=0;)n[c]<e[d]?c+=o:n[c]>e[d]?d+=a:(l[_++]=n[c],c+=o,d+=a);return _<l.length&&(l.length=_),l}function b(n,e,t,i,u,l,o){null==t&&(t=0),null==i&&(i=n===+n?n-1:n.length-1),null==u&&(u=0),null==l&&(l=e?e.length-1:-1);var a=t>i?-1:1,f=u>l?-1:1,s=a*(i-t)+1,c=t,d=t,_=0;if(!e||!e.length)return n===+n?r(n,t,a):n?n.slice():n;if(null==o&&(o=new Array(s)),n===+n){for(;a*(i-c)>=0&&f*(l-d)>=0;)c===e[d]?(c+=a,d+=a):c>e[d]?d+=f:(o[_++]=c,c+=a);for(;a*(i-c)>=0;)o[_++]=c,c+=a}else{for(;a*(i-c)>=0&&f*(l-d)>=0;)n[c]===e[d]?(c+=a,d+=a):n[c]>e[d]?d+=f:(o[_++]=n[c],c+=a);for(;a*(i-c)>=0;)o[_++]=n[c],c+=a}return _<o.length&&(o.length=_),o}function p(n,e,t,r,i,u,l,o,a){null==t&&(t=0),null==r&&(r=n.length-1),null==i&&(i=0),null==u&&(u=e.length-1),l=!1!==l;var f,s=t>r?-1:1,c=i>u?-1:1,d=s*(r-t)+1,_=c*(u-i)+1,m=d+_,h=t,b=i,p=0,v=!l;if(null==a&&(a=new Array(m)),0===a.length)return!0===o?n:a;for(;s*(r-h)>=0&&c*(u-b)>=0;){if(l&&p){if(n[h]===f){h+=s;continue}if(e[b]===f){b+=c;continue}}n[h]<e[b]?(a[p++]=f=n[h],h+=s):n[h]>e[b]?(a[p++]=f=e[b],b+=c):(a[p++]=f=n[h],v&&(a[p++]=e[b]),h+=s,b+=c)}for(;s*(r-h)>=0;)(v||n[h]!==f)&&(a[p++]=f=n[h]),h+=s;for(;c*(u-b)>=0;)(v||e[b]!==f)&&(a[p++]=f=e[b]),b+=c;if(!0===o){for(h=t,p=0;m>p;p++,h+=s)n[h]=a[p];return n}return p<a.length&&(a.length=p),a}function v(n,e,t){null==e&&(e=0),null==t&&(t=n.length-1);var r=e>t?-1:1,i=r*(t-e)+1;if(1>=i)return n;for(var u,l,o=i,a=1,f=2,s=sn.min,c=new Array(i);o;){for(l=i-a,u=0;l>u;u+=f)p(n,n,e+r*u,e+r*(u+a-1),e+r*(u+a),e+r*s(u+f-1,i-1),!1,!0,c);a<<=1,f<<=1,o>>=1}return n}function g(n,e,t,r,i){var u,l,o,a,f,s,c=nn.Math.rndInt;if(a=!0===t?n.slice():n,f=!0===e?1:0,an(r))for(s=r,u=s.length;f<u--;)l=c(0,u-f),o=a[s[u]],a[s[u]]=a[s[l]],a[s[l]]=o;else for(null==r&&(r=0),null==i&&(i=n.length-1),u=i-r+1;f<u--;)l=c(0,u-f),o=a[r+u],a[r+u]=a[r+l],a[r+l]=o;return a}function x(n,e,t,r,i,u,l){null==u&&(u=0),null==l&&(l=n.length-1);var o,a,f,s,c=nn.Math.rndInt,d=l-u+1;if(e=sn.min(e,d),t=!0===t,o=new Array(e),!0===r){for(d-=1,a=0;e>a;a++)o[a]=n[u+c(0,d)];return t&&v(o),o}for(a=0;e>a;a++)f=c(0,--d),s=n[u+f],n[u+f]=n[u+d],n[u+d]=s,o[a]=s,i&&(i[a]=f);if(i)for(a=e-1;a>=0;a--)f=i[a],s=n[u+d],n[u+d]=n[u+f],n[u+f]=s,d++;return t&&v(o),o}function y(n,e){if(0>e)return[];var t,i=r(e,0,0),u=n.length;for(t=0;u>t;t++)i[n[t]]=1;return i}function A(n,e){e=sn.min(e||n.length,n.length);var t,r=[];for(t=0;e>t;t++)0<n[t]&&r.push(t);return r}function w(n,e){if(null==n)return null;var t,i,u,l,o,a=n.length;if(!0===e)for(l=n[u],o=[[l[1],l[0]]],u=1;a>u;u++)l=n[u],l[1]===o[u-1][0]?o[u-1][1]+=l[0]:o.push([l[1],l[0]]);else for(t=n[0],o=r(t,1,0),u=1;a>u;u++)for(i=0,l=n[u];t>i&&l>0;)o[i++]++,l--;return o}function M(n){if(null==n)return null;var e,t=[],r=n.length,i=n[0],u=[i,1];for(e=1;r>e;e++)i===n[e]?u[1]++:(t.push(u),i=n[e],u=[i,1]);return t.push(u),t}function I(n){if(null==n)return null;var e,t,r,i,u,l=[],o=n.length;for(e=0;o>e;e++)if(u=n[e],1===u[1])l.push(u[0]);else for(r=u[1],i=u[0],t=0;r>t;t++)l.push(i);return l}function C(n){if(null==n)return null;var e=0;return r(n.length,function(t){var i=n[t],u=r(i,e,1);return e+=i,u})}function E(n){return null==n?null:r(n.length,function(e){return n[e].length})}function O(n,e,t){e=e||n.length;var r,i,u,l,o,a=n.length,f=new Array(a),s=nn.Math.ceil(cn(e)),c=(1<<1+s)-1,d=new Array(c),_=1<<s,m=-1===t?a-1:0,h=-1===t?-1:1;for(r=0;c>r;r++)d[r]=0;for(i=m,r=0;a>r;r++,i+=h){for(o=n[r],l=_+o,u=0;s>u;u++)1&l&&(o-=d[l>>>1<<1]),d[l]+=1,l>>>=1;d[l]+=1,f[i]=o}return f}function R(n,e,t){e=e||n.length;var r,i,u,l,o,a,f,s,c,d,_=n.length,m=new Array(_),h=-1===t?_-1:0,b=-1===t?-1:1;for(f=nn.Math.ceil(cn(e)),s=(1<<1+f)-1,c=new Array(s),d=1<<f,r=0;f>=r;r++)for(u=1,l=1<<r;l>=u;u++)c[l-1+u]=1<<f-r;for(i=h,r=0;_>r;r++,i+=b){for(o=n[r],a=1,u=0;f>u;u++)c[a]-=1,a<<=1,o>=c[a]&&(o-=c[a],a++);c[a]=0,m[i]=a-d}return m}function S(n,e,t){var r,i=n.length,u=null==e;if(i>1)for(u&&(e=new Array(i-1),t=0),r=i-1;r>=1;r--)e[t++]=[n[0],n[r]];else u&&(e=[]);return u?e:t}function k(n,e){var t,r,i,u,l=n.length,o=new Array(l),a=!0===e?1:0,f=new Array(l),s=0,c=0;for(t=0;l>t;t++)f[t]=0;for(i=new Array(l),u=0,r=s++,i[u++]=r,f[r]=1;l>s;){if(r=n[r],f[r])for(u>a&&(i.length=u,o[c++]=i),i=new Array(l),u=0;l>s&&f[r=s];)++s;f[r]||(i[u++]=r,f[r]=1)}return u>a&&(i.length=u,o[c++]=i),c<o.length&&(o.length=c),o}function $(n){var e,t,r=n.length,i=new Array(r),u=0,l=k(n,!0);for(e=0,t=l.length;t>e;e++)u=S(l[e],i,u);return u<i.length&&(i.length=u),i}function P(n,e){var t,r,i,u=n.length,l=new Array(e);for(t=0;e>t;t++)l[t]=t;for(t=0;u>t;t++)swap=r[t],i=l[r[0]],l[r[0]]=l[r[1]],l[r[1]]=i;return l}function L(n,e){var t,r,i=n.length,u=new Array(i);for(t=0;i>t;t++)for(u[t]=new Array(i),r=0;i>r;r++)u[t][r]=0;if(!0===e)for(t=0;i>t;t++)u[n[t]][t]=1;else for(t=0;i>t;t++)u[t][n[t]]=1;return u}function T(n,e){var t,r,i=n.length,u=new Array(i);if(!0===e)for(t=0;i>t;t++)for(r=0;i>r;r++)n[t][r]&&(u[r]=t);else for(t=0;i>t;t++)for(r=0;i>r;r++)n[t][r]&&(u[t]=r);return u}function N(n){var e,t=n.length,r=new Array(t);for(e=0;t>e;e++)r[n[e]]=e;return r}function X(n,e){if(e=e||n.length,e!==n.length)return!1;var t,r,i=new Array(e);for(t=0;e>t;t++)i[t]=0;for(t=0;e>t;t++){if(r=n[t],0>r||r>=e||0!==i[r])return!1;i[r]++}for(t=0;e>t;t++)if(1!==i[t])return!1;return!0}function q(n){var e,t,r,i=n,u=i.length,l=u?i[0]:[],o=l.length;for(t=1;u>t;t++)for(r=l.slice(),e=0;o>e;e++)l[e]=r[i[t][e]];return l}function j(n){var e,t,r,i,u,l,o=n,a=o.length,f=0;for(r=0;a>r;r++)f+=o[r].length;for(e=new Array(f),i=0,r=0;a>r;r++){for(u=o[r],l=u.length,t=0;l>t;t++)e[i+t]=i+u[t];i+=l}return e}function V(n){for(var e=n.length,t=0;e>t;t++)if(n[t]!==t)return!1;return!0}function D(n){for(var e=n.length,t=1,r=n[0];e>t;t++)if(n[t]!==(r+t)%e)return!1;return!0}function G(n,e){e=e||1;var t,r=new Array(e+1);for(t=0;e>=t;t++)r[t]=n;return V(q(r))}function J(n,e,t){e=0|e;for(var r=0,i=n.length,u=0;i>u;u++)if(n[u]===u&&r++,r>e)return!1;return!0===t?r===e:!0}function H(n,e,t,r){if(n){var i,u,l,o=e,a=o.length,f=null;if(0>t)if("tuple"===r){for(i=o[0],o=o[1],u=i-1;u>=0&&n[u]<1;)u--;if(u>=0)for(f=n.slice(),f[u]--,o-=1,l=u+1;i>l;l++)f[l]=o}else{for(u=a-1;u>=0&&n[u]<1;)u--;if(u>=0)for(f=n.slice(),f[u]--,l=u+1;a>l;l++)f[l]=o[l]-1}else if("tuple"===r){for(i=o[0],o=o[1],u=i-1;u>=0&&n[u]+1===o;)u--;if(u>=0)for(f=n.slice(),f[u]++,l=u+1;i>l;l++)f[l]=0}else{for(u=a-1;u>=0&&n[u]+1===o[u];)u--;if(u>=0)for(f=n.slice(),f[u]++,l=u+1;a>l;l++)f[l]=0}return f}return null}function F(n,e,t,r){if(n){var i,u,l,o,a,f=e,s=null;if(0>t)if("cyclic"===r)n[0]>0&&(s=[n[f-1]].concat(n.slice(0,-1)));else{for(i=f-2;i>=0&&n[i]<=n[i+1];)i--;if(i>=0){for(s=n.slice(),u=f-1;u>i&&s[i]<=s[u];)u--;for(a=s[i],s[i]=s[u],s[u]=a,l=i+1,o=f-1;o>l;)a=s[l],s[l++]=s[o],s[o--]=a}}else if("cyclic"===r)n[0]+1<f&&(s=n.slice(1).concat([n[0]]));else{for(i=f-2;i>=0&&n[i]>=n[i+1];)i--;if(i>=0){for(s=n.slice(),u=f-1;u>i&&s[i]>=s[u];)u--;for(a=s[i],s[i]=s[u],s[u]=a,l=i+1,o=f-1;o>l;)a=s[l],s[l++]=s[o],s[o--]=a}}return s}return null}function U(n,e,t,r){if(n){var i,u,l,o,a,f,s,c=e[1],d=e[0],_=null;if(0>t)if("ordered+repeated"===r){for(u=c-1;u>=0&&n[u]<1;)u--;if(u>=0)for(_=n.slice(),_[u]--,d-=1,l=u+1;c>l;l++)_[l]=d}else if("ordered"===r){for(i={},u=0;c>u;u++)i[n[u]]=u;for(u=c-1,o=-1;-1===o&&u>=0;){if(n[u]-1>=0)for(l=n[u]-1;l>=0;l--)if(null==i[l]){o=u,i[l]=o;break}i[n[u]]=null,u--}if(o>-1)for(_=n.slice(),_[o]=l,l=d-1,u=o+1;c>u;u++){for(;l>=0&&null!=i[l];)l--;_[u]=l,i[l]=u}}else{for(s="repeated"===r?0:1,u=c-1,o=-1;u>0;){if(n[u]>n[u-1]+s){o=u;break}u--}if(-1===o&&0<n[0]&&(o=0),o>-1){for(_=n.slice(),f=d-1+s,u=c-1;u>o;u--)f-=s,_[u]=f;_[o]--}}else if("ordered+repeated"===r){for(u=c-1;u>=0&&n[u]+1===d;)u--;if(u>=0)for(_=n.slice(),_[u]++,l=u+1;c>l;l++)_[l]=0}else if("ordered"===r){for(i={},u=0;c>u;u++)i[n[u]]=u;for(u=c-1,o=-1;-1===o&&u>=0;){if(n[u]+1<d)for(l=n[u]+1;d>l;l++)if(null==i[l]){o=u,i[l]=o;break}i[n[u]]=null,u--}if(o>-1)for(_=n.slice(),_[o]=l,l=0,u=o+1;c>u;u++){for(;d>l&&null!=i[l];)l++;_[u]=l,i[l]=u}}else{if(u=c-1,o=-1,"repeated"===r)for(s=0;u>=0;){if(n[u]+1<d){o=u;break}u--}else for(s=1,a=d-c;u>=0;){if(n[u]<a+u){o=u;break}u--}if(o>-1)for(_=n.slice(),f=_[o]+1-s,u=o;c>u;u++)f+=s,_[u]=f}return _}return null}function B(n,e,t,i,u){if(n){var l,o,a,f,s,c,d=e,_=null;if(0>t){if(i){if(u)for(d-=u,i-=1,s=sn.min(u,sn.floor(d/i)||1),o=1,a=1;i>=a&&u===n[a];)a++;else s=sn.ceil(d/i),o=0,a=0;if(n[a]>s){for(_=n.slice(),f=o+i-1;f>a&&_[f]+1>=_[f-1];)f--;if(f===o)for(_[o]--,_[o+1]=d-_[o]-i+2,l=o+2;o+i>l;l++)_[l]=1;else _[f]++,_[f-1]--}}else if(o=u?1:0,n.length>o&&n[o]>1){for(_=n.slice(),l=_.length-1,c=0;l>=o&&1===_[l];)c+=_[l],l--;s=_[l]-1,c++,_[l]=s,_=_.slice(0,l+1),c>s?_=_.concat(r(sn.floor(c/s),s),(c%=s)?[c]:[]):c>0&&(_=_.concat([c]))}}else if(i){if(u?(d-=u,i-=1,s=sn.min(u,d-i+1),o=1):(s=d-i+1,o=0),n[o]<s){for(_=n.slice(),f=o+1;o+i>f&&_[f]+1>_[f-1];)f++;for(f===o+i&&(f=o),l=o+i-1;l>f&&2>_[l];)l--;l===f&&(l=f+1),_[f]++,_[l]--}}else if(o=u?1:0,a=u?n.length-1:0,s=u?d%u||u:d,n.length>o&&n[a]<s){for(_=n.slice(),f=_.length,f>1?(l=f-2,c=_[f-1]):(l=f-1,c=0);l>o&&_[l]===_[l-1];)c+=_[l],l--;_[l]++,c--,_=c>0?_.slice(0,l+1).concat(r(c,1)):_.slice(0,l+1)}return _}return null}var Y,z,K,Q,W,Z,nn={VERSION:"0.7.0"},en="prototype",tn="constructor",rn=Array.prototype.slice,un=Object[en].hasOwnProperty,ln=Object[en].toString,on=/^\s+|\s+$/g,an=(String.prototype.trim?function(n){return n.trim()}:function(n){return n.replace(on,"")},function(n){return n instanceof Array||"[object Array]"===ln.call(n)}),fn=function(n){return n instanceof String||"[object String]"===ln.call(n)},sn=Math,cn=sn.log2||function(n){return sn.log(n)/sn.LN2},dn=function(n){var e=n.toString(2),t=32-e.length;return t>0?new Array(t+1).join("0")+e:e},_n=Object.create,mn=function(n,e){for(var t in e)un.call(e,t)&&(n[t]=e[t]);return n},hn=function(n,e){1===arguments.length&&(e=n,n=Object);var t=e[tn];return un.call(e,"__static__")&&(t=mn(t,e.__static__),delete e.__static__),t[en]=mn(_n(n[en]),e),t},bn=1,pn=2,vn=4,gn=8,xn=16,yn=32,An=vn|gn|xn,wn=An|yn|bn|pn;return s.mem1={},s.mem2={},s.mem3={},c.mem={},nn.$={MAXMEM:1e6},nn.ORDER={LEX:vn,LEXICOGRAPHIC:vn,REVLEX:vn|bn,ANTILEX:vn|bn,REVERSELEXICOGRAPHIC:vn|bn,ANTILEXICOGRAPHIC:vn|bn,REFLEX:vn|pn,REFLECTEDLEXICOGRAPHIC:vn|pn,COLEX:gn,COLEXICOGRAPHIC:gn,REVCOLEX:gn|bn,ANTICOLEX:gn|bn,REVERSECOLEXICOGRAPHIC:gn|bn,ANTICOLEXICOGRAPHIC:gn|bn,REFCOLEX:gn|pn,REFLECTEDCOLEXICOGRAPHIC:gn|pn,REV:bn,REVERSE:bn,REVERSED:bn,REF:pn,REFLECT:pn,REFLECTED:pn,RANDOM:yn,GRAY:xn,MINIMAL:xn},nn.Util={array:r,operate:i,intersect:h,difference:b,merge:p,conjugation:d,parity:_,inversion:m,mergesort:v,shuffle:g,pick:x},nn.Math={O:0,I:1,J:-1,N:function(n){return nn.Arithmetic.add(nn.Arithmetic.O,n)},V:function(n){return nn.Arithmetic.sub(nn.Arithmetic.O,n)},rnd:sn.random,rndInt:function(n,e){return nn.Math.round((e-n)*nn.Math.rnd()+n)},equ:function(n,e){return n===e},gte:function(n,e){return n>=e},lte:function(n,e){return e>=n},gt:function(n,e){return n>e},lt:function(n,e){return e>n},inside:function(n,e,t,r){return r?n>=e&&t>=n:n>e&&t>n},clamp:function(n,e,t){return e>n?e:n>t?t:n},wrap:function(n,e,t){return e>n?t:n>t?e:n},wrapR:function(n,e){return 0>n?n+e:n},add:function(n,e){return n+e},sub:function(n,e){return n-e},mul:function(n,e){return n*e},div:function(n,e){return nn.Math.floor(n/e)},mod:function(n,e){return n%e},pow:sn.pow,shl:function(n,e){return n<<e},shr:function(n,e){return n>>e},bor:function(n,e){return n|e},band:function(n,e){return n&e},xor:function(n,e){return n^e},abs:sn.abs,min:sn.min,max:sn.max,floor:sn.floor,ceil:sn.ceil,round:sn.round,num:function(n){return"number"==typeof n?nn.Math.floor(n):parseInt(n,10)},val:function(n){return nn.Math.floor(n.valueOf())},sum:l,product:o,pow2:a,exp:f,factorial:s,partitions:c},nn.Arithmetic={O:0,I:1,J:-1,N:nn.Math.N,V:nn.Math.V,equ:nn.Math.equ,gte:nn.Math.gte,lte:nn.Math.lte,gt:nn.Math.gt,lt:nn.Math.lt,inside:nn.Math.inside,clamp:nn.Math.clamp,wrap:nn.Math.wrap,wrapR:nn.Math.wrapR,add:nn.Math.add,sub:nn.Math.sub,mul:nn.Math.mul,div:nn.Math.div,mod:nn.Math.mod,pow:nn.Math.pow,shl:nn.Math.shl,shr:nn.Math.shr,bor:nn.Math.bor,band:nn.Math.band,xor:nn.Math.xor,abs:nn.Math.abs,min:nn.Math.min,max:nn.Math.max,floor:nn.Math.floor,ceil:nn.Math.ceil,round:nn.Math.round,rnd:nn.Math.rndInt,num:nn.Math.num,val:nn.Math.val},nn.Class=hn,nn.BitArray=hn({constructor:function Mn(n){var e=this;return e instanceof Mn?(e.length=n,void(e.bits=new Uint32Array(nn.Math.ceil(n/32)))):new Mn(n)},length:0,bits:null,dispose:function(){var n=this;return n.length=null,n.bits=null,n},clone:function(){var n=this,e=new nn.BitArray(n.length);return e.bits=new Uint32Array(n.bits),e},fromArray:function(n){var e=this;return e.bits=new Uint32Array(n),e},toArray:function(){return rn.call(this.bits)},toString:function(){var n,e,t=this.toArray();for(n=0,e=t.length;e>n;n++)t[n]=dn(t[n]);return t.join("")},reset:function(){var n,e=this,t=e.bits,r=t.length;for(n=0;r>n;n++)t[n]=0;return e},isset:function(n){return!!(this.bits[n>>>5]&1<<(31&n))},set:function(n){var e=this;return e.bits[n>>>5]|=1<<(31&n),e},unset:function(n){var e=this;return e.bits[n>>>5]&=~(1<<(31&n)),e},toggle:function(n){var e=this;return e.bits[n>>>5]^=1<<(31&n),e}}),Y=nn.CombinatorialIterator=hn({constructor:function In(n,e,t){var r=this,i=r[tn];r.name=n||"CombinatorialIterator",r.n=e||0,r.$=t=t||{},t.type=String(t.type||"default").toLowerCase(),t.order=t.order||vn,t.base=t.base||0,t.dimension=t.dimension||0,t.count=i.count(r.n,r.$),t.sub instanceof In&&(t.subcount=nn.Arithmetic.mul(t.count,t.sub.total())),r.order(t.order)},__static__:{Iterable:function Cn(n,e){var t=this;return t instanceof Cn?(e=-1===e?-1:1,void(t.next=function(){return n.hasNext(e)?{value:n.next(e)}:{done:!0}})):new Cn(n)},C:function(n,e){return d(n,e)},P:function(n,e){return _(n)},T:function(n,e){return m(n,e)},count:e,initial:e,cascade:function(n,e,t){return"concatenate"===t?n&&e?n.concat(e):n||e||null:"compose"===t?n&&e?u(!0,n,e):n||e||null:null==n||null==e?null:r(n.length,function(t){return n[t]<e.length?e[n[t]]:null})},dual:function(n,e,t,r){if(null==n)return null;var i=this,u=r&&r.order?r.order:0,l=i.C,o=i.P;i.T;return n=yn&u?pn&u?o(n,t):n:xn&u?pn&u?o(n,t):n.slice():gn&u?pn&u?l(n,t):o(l(n,t),t):pn&u?o(n,t):n.slice()},succ:function(n,e,t,r,i){var u=this,l=nn.Arithmetic;return null==e?null:u.unrank(l.add(t,0>n?l.J:l.I),r,i)},rand:function(n,e){var t=this,r=nn.Arithmetic,i=r.sub(e&&e.count?e.count:t.count(n,e),r.I),u=r.O,l=r.rnd(u,i);return r.equ(u,l)?t.initial(1,n,e):r.equ(i,l)?t.initial(-1,n,e):t.unrank(l,n,e)},rank:e,unrank:e},name:"CombinatorialIterator",n:0,$:null,__index:null,_index:null,__item:null,_item:null,__subindex:null,_subindex:null,__subitem:null,_subitem:null,_prev:null,_next:null,_traversed:null,dispose:function(n){var e=this;return!0===n&&e.$.sub&&(e.$.sub.dispose(!0),e.$.sub=null),e.name=null,e.n=null,e.$=null,e.__index=null,e._index=null,e.__item=null,e._item=null,e.__subindex=null,e._subindex=null,e.__subitem=null,e._subitem=null,e._prev=null,e._next=null,e._traversed&&(e._traversed.dispose(),e._traversed=null),e},base:function(){return this.$.base||0},dimension:function(){return this.$.dimension||0},total:function(n){var e=this.$;return!0===n?e.count||0:e.subcount||e.count||0},_init:function(n,e){var t,r,i,u=this,l=u[tn],o=u.$,a=u.n,f=nn.Arithmetic,s=f.O,c=f.I,d=o.order;return u.__index=u._index=s,u._item=u.__item=null,u._prev=!1,u._next=!1,r=o.count,i=f.sub(r,c),yn&d?f.gt(r,nn.$.MAXMEM)?(u._traversed&&(u._traversed.dispose(),u._traversed=null),u.__item=l.rand(a,o),u.__index=null):(u._traversed?u._traversed.reset():u._traversed=new nn.BitArray(f.val(r)),u._traversed.set(t=u.random("index")),u.__item=l.unrank(t,a,o),null!=u.__item&&(u.__index=t)):gn&d?(u.__item=l.initial(-n,a,o),null!=u.__item&&(u.__index=-1===n?s:i)):(u.__item=l.initial(n,a,o),null!=u.__item&&(u.__index=-1===n?i:s)),u._item=null==u.__item?null:l.dual(u.__item,u.__index,a,o),u._index=!e||yn&d?s:i,yn&d&&null===u.__index&&(u.__index=u._index),u._prev=yn&d||!e?!1:null!=u.__item,u._next=!e||yn&d?null!=u.__item:!1,u},order:function(n,e,r){if(!arguments.length)return this._order;var i,u,l,o,a,f=this,s=f[tn],c=nn.Arithmetic;c.O,c.I;return e=-1===e,fn(n)&&-1<(u=n.indexOf("|"))?(i=n.substr(u+1),n=t(n.substr(0,u))):i=n=t(n),l=f.n,o=f.$,a=bn&n?-1:1,a=e?-a:a,o.order=n,o.sub?(!0===r?o.sub.rewind(e?-1:1):o.sub.order(i,e?-1:1),f.__subindex=o.sub.index(),f.__subitem=o.sub.next(e?-1:1),f._subindex=null,f._subitem=null):(f.__subindex=null,f.__subitem=null,f._subindex=null,f._subitem=null),f._init(a,e),o.sub&&(f._prev=f._prev&&null!=f.__subitem,f._next=f._next&&null!=f.__subitem,f._subindex=c.add(c.mul(f._index,o.sub.total()),f.__subindex),f._subitem=s.cascade(f._item,f.__subitem)),f},index:function(n,e){if(e=!0===e,!arguments.length)return this.$.sub?this._subindex:this._index;var t,r=this,i=r[tn],u=nn.Arithmetic,l=u.O,o=u.I,a=u.J,f=r.n,s=r.$,c=s.sub&&!e?s.subcount:s.count,d=s.sub&&!e?r._subindex:r._index,_=s.order,m=bn&_?-1:1;return n=u.wrapR(u.N(n),c),!u.equ(n,d)&&u.inside(n,a,c)&&(s.sub&&!e&&(s.sub.index(u.mod(n,s.sub.total())),r.__subindex=s.sub.index(),r.__subitem=s.sub.item(),n=u.div(n,s.sub.total()),c=s.count),t=u.sub(c,o),gn&_?(r.__index=-1===m?n:u.sub(t,n),r._index=n,r.__item=u.equ(l,n)?i.initial(-m,f,s):u.equ(t,n)?i.initial(m,f,s):i.unrank(r.__index,f,s),r._item=i.dual(r.__item,r.__index,f,s),r._prev=null!=r.__item,r._next=null!=r.__item):yn&_||(r.__index=-1===m?u.sub(t,n):n,r._index=n,r.__item=u.equ(l,n)?i.initial(m,f,s):u.equ(t,n)?i.initial(-m,f,s):i.unrank(r.__index,f,s),r._item=i.dual(r.__item,r.__index,f,s),r._prev=null!=r.__item,r._next=null!=r.__item),s.sub&&(r._prev=r._prev&&null!=r.__subitem,r._next=r._next&&null!=r.__subitem,r._subindex=u.add(u.mul(r._index,s.sub.total()),r.__subindex),r._subitem=i.cascade(r._item,r.__subitem))),r},item:function(n,e){if(!arguments.length)return this.$.sub?this._subitem:this._item;var r,i,u,l,o,a,f,s=this,c=s[tn],d=s.n,_=s.$,m=_.sub?_.subcount:_.count,h=_.sub?s._subindex:s._index,b=nn.Arithmetic,p=b.O,v=b.I,g=b.J,x=null;return fn(e)?-1<(f=e.indexOf("|"))?(x=e.substr(f+1),e=t(e.substr(0,f))):x=e=t(e):null!=e?x=e=t(e):(e=_.order,x=null),_.sub||(x=null),an(n)?(m=_.count,u=bn&e?-1:1,r=b.sub(m,v),s.__item=n.slice(),s.__index=c.rank(s.__item,d,_),yn&e?(s._index=s.__index,l=_.order,_.order=e,s._item=c.dual(s.__item,s.__index,d,_),_.order=l):gn&e?(s._index=-1===u?s.__index:b.sub(r,s.__index),l=_.order,_.order=e,s._item=c.dual(s.__item,s.__index,d,_),_.order=l):(s._index=-1===u?b.sub(r,s.__index):s.__index,l=_.order,_.order=e,s._item=c.dual(s.__item,s.__index,d,_),_.order=l),s):(n=b.wrapR(b.N(n),m),e===_.order&&null===x&&b.equ(n,h)?_.sub?s._subitem:s._item:b.inside(n,g,m)?(a=null,_.sub&&(a=_.sub.item(b.mod(n,_.sub.total()),x),n=b.div(n,_.sub.total()),m=_.count),u=bn&e?-1:1,r=b.sub(m,v),yn&e?(i=null,l=_.order,_.order=e,o=c.dual(c.rand(d,_),i,d,_),_.order=l,_.sub&&(o=c.cascade(o,a)),o):gn&e?(i=-1===u?n:b.sub(r,n),l=_.order,_.order=e,o=c.dual(b.equ(p,n)?c.initial(-u,d,_):b.equ(r,n)?c.initial(u,d,_):c.unrank(i,d,_),i,d,_),_.order=l,_.sub&&(o=c.cascade(o,a)),o):(i=-1===u?b.sub(r,n):n,l=_.order,_.order=e,o=c.dual(b.equ(p,n)?c.initial(u,d,_):b.equ(r,n)?c.initial(-u,d,_):c.unrank(i,d,_),i,d,_),_.order=l,_.sub&&(o=c.cascade(o,a)),o)):null)},random:function(n,e,t){var r,i=this,u=i[tn],l=i.$,o=l.order;if("index"===n){var a=nn.Arithmetic,f=a.N,s=a.O,c=a.I,d=l.count,_=arguments.length-1;return 0===_?(e=s,t=a.sub(d,c)):1===_?(e=f(e||0),t=a.sub(d,c)):(e=f(e),t=f(t)),a.rnd(e,t)}return l.order|=yn,r=u.rand(i.n,l),l.order=o,r=u.dual(r,null,i.n,l),l.sub?u.cascade(r,l.sub.random()):r},rewind:function(n){var e=this;return e.order(e.$.order,-1===n?-1:1,!0)},hasNext:function(n){var e=this;return-1===n?yn&e.$.order?!1:e._prev:e._next},next:function(n){var e,t,n,r,i,u=this,l=u[tn],o=nn.Arithmetic,a=o.O,f=o.I,s=o.J,c=u.n,d=u.$,_=d.order,m=d.count,h=d.sub?u._subitem:u._item;if(-1===n)return yn&_?null:(n=bn&_?-1:1,gn&_?(u.__item=l.succ(n,u.__item,u.__index,c,d),null!=u.__item&&(u.__index=o.add(u.__index,0>n?s:f))):(u.__item=l.succ(-n,u.__item,u.__index,c,d),null!=u.__item&&(u.__index=o.add(u.__index,n>0?s:f))),null==u.__item&&d.sub&&d.sub.hasNext(-1)?(u._init(n,!0),u.__subindex=d.sub.index(),u.__subitem=d.sub.next(-1)):(u._prev=null!=u.__item,u._prev&&(u._index=o.sub(u._index,f))),u._item=null==u.__item?null:l.dual(u.__item,u.__index,c,d),d.sub&&(u._prev=u._prev&&null!=u.__subitem,u._subindex=o.add(o.mul(u._index,d.sub.total()),u.__subindex),u._subitem=l.cascade(u._item,u.__subitem)),h);if(yn&_)if(r=o.sub(m,f),o.lt(u._index,r))if(e=u._traversed){for(t=u.random("index"),i=nn.Math.rnd()>.5?s:f;e.isset(t);)t=o.wrap(o.add(t,i),a,r);e.set(t),u.__item=l.unrank(t,c,d),null!=u.__item&&(u.__index=t)}else u.__item=l.rand(c,d),u.__index=null;else u._item=u.__item=null,u._traversed&&(u._traversed.dispose(),u._traversed=null);else n=bn&_?-1:1,gn&_?(u.__item=l.succ(-n,u.__item,u.__index,c,d),null!=u.__item&&(u.__index=o.add(u.__index,n>0?s:f))):(u.__item=l.succ(n,u.__item,u.__index,c,d),null!=u.__item&&(u.__index=o.add(u.__index,0>n?s:f)));return null==u.__item&&d.sub&&d.sub.hasNext()?(u._init(n,!1),u.__subindex=d.sub.index(),u.__subitem=d.sub.next()):(u._next=null!=u.__item,u._next&&(u._index=o.add(u._index,f),yn&_&&null===u.__index&&(u.__index=u._index))),u._item=null==u.__item?null:l.dual(u.__item,u.__index,c,d),d.sub&&(u._next=u._next&&null!=u.__subitem,u._subindex=o.add(o.mul(u._index,d.sub.total()),u.__subindex),u._subitem=l.cascade(u._item,u.__subitem)),h},range:function(n,e){var t,r,i,u,l,o=this,a=nn.Arithmetic,f=a.N,s=a.O,c=a.I,d=o.$,_=d.sub?d.subcount:d.count,m=1,h=arguments.length,b=a.sub(_,c),p=!(yn&d.order);if(1>h?(n=s,e=b):2>h?(n=f(n),e=b):(n=f(n),e=f(e)),n=a.wrapR(n,_),e=a.wrapR(e,_),a.gt(n,e)&&(t=n,n=e,e=t,m=-1),n=a.clamp(n,s,b),p&&(e=a.clamp(e,s,b)),a.lte(n,e)){if(l=[o.$.order,o.__index,o._index,o.__item,o._item,o.__subindex,o._subindex,o.__subitem,o._subitem,o._prev,o._next],p&&o.index(n),i=a.val(a.sub(e,n)),r=new Array(i+1),0>m)for(u=i;u>=0;u--)r[u]=o.next();else for(u=0;i>=u;u++)r[u]=o.next();o.$.order=l[0],o.__index=l[1],o._index=l[2],o.__item=l[3],o._item=l[4],o.__subindex=l[5],o._subindex=l[6],o.__subitem=l[7],o._subitem=l[8],o._prev=l[9],o._next=l[10]}else r=[];return r},__iter__:function(){return new Y.Iterable(this)}}),"undefined"!=typeof Symbol&&"undefined"!=typeof Symbol.iterator&&(Y[en][Symbol.iterator]=Y[en].__iter__),z=nn.Tensor=hn(Y,{constructor:function En(){var n,e=this,t=rn.call(arguments);return n=!t.length||t[t.length-1]instanceof Y||an(t[t.length-1])||t[t.length-1]===+t[t.length-1]?{}:t.pop()||{},n.type=String(n.type||"tensor").toLowerCase(),n.order=n.order||vn,t.length&&an(t[0])&&(t=t[0]),t&&t.length||(t=[]),e instanceof En?("tuple"===n.type?(t[0]=t[0]||1,t[1]=t[1]||1,t[0]instanceof Y?(n.sub=t[0],t[0]=n.sub.dimension()):t[1]instanceof Y&&(n.sub=t[1],t[1]=n.sub.base()),n.base=t[1],n.dimension=t[0]):(n.base=i(function(n,e){return e>n?e:n},0,t),n.dimension=t.length),void Y.call(e,"Tensor",t,n)):new En(t,n)},__static__:{C:function(n,e){return d(n,e[1])},P:Y.P,T:Y.T,count:function(n,e){return e&&"tuple"===e.type?n&&n[0]?nn.Math.exp(n[0],n[1]):0:n&&n.length?nn.Math.product(n):0},initial:function(n,e,t){var i=t&&"tuple"===t.type?e[0]?0>n?r(e[0],e[1]-1,0):r(e[0],0,0):[]:e.length?0>n?r(e.length,function(n){return e[n]-1}):r(e.length,0,0):[];return i},cascade:Y.cascade,dual:function(n,e,t,r){if(null==n)return null;var i=this,u=r&&r.order?r.order:0,l=r&&"tuple"===r.type?i.C:Y.C,o=i.P;i.T;return yn&u?pn&u?o(n,t):n:xn&u?pn&u?o(n,t):n.slice():gn&u?pn&u?l(n,t):o(l(n,t),t):pn&u?o(n,t):n.slice()},succ:function(n,e,t,r,i){return H(e,r,n,i&&i.type?i.type:"tensor")},rand:function(n,e){var t,i=nn.Math.rndInt;return t=e&&"tuple"===e.type?n[0]?r(n[0],function(e){return i(0,n[1]-1)}):[]:n.length?r(n.length,function(e){return i(0,n[e]-1)}):[]},rank:function(n,e,t){var r,i,u,l=nn.Arithmetic,o=l.add,a=l.mul,r=l.O,f=l.J;if(t&&"tuple"===t.type){if(i=e[0],!i)return f;for(e=e[1],u=0;i>u;u++)r=o(a(r,e),n[u])}else{if(i=e.length,!i)return f;for(u=0;i>u;u++)r=o(a(r,e[u]),n[u])}return r},unrank:function(n,e,t){var r,i,u,l,o,a,f=nn.Arithmetic,s=f.mod,c=f.div,d=f.val;if(t&&"tuple"===t.type){if(a=e[0],!a)return[];for(o=new Array(a),i=e[1],r=n,u=a-1;u>=0;u--)l=s(r,i),r=c(r,i),o[u]=d(l)}else{if(a=e.length,!a)return[];for(o=new Array(a),r=n,u=a-1;u>=0;u--)i=e[u],l=s(r,i),r=c(r,i),o[u]=d(l)}return o},product:u,component:function(n,e){var t,r,i,u,l,o,a=[],f=e,s=f.length;for(t=0;s>t;t++)if(i=f[t],l=n[t],u=i[l],u instanceof Array)for(r=0,o=u.length;o>r;r++)a.push(u[r]);else a.push(u);return a}}}),K=nn.Permutation=hn(Y,{constructor:function On(n,e){var t=this;return t instanceof On?(e=e||{},e.type=e.type||"permutation",n=n||1,n instanceof Y&&(e.sub=n,n=e.sub.dimension()),e.base=e.dimension=n,void Y.call(t,"Permutation",n,e)):new On(n,e)},__static__:{C:function(n,e){return d(n,-1)},P:Y.P,T:Y.T,count:function(n,e){return e&&"cyclic"===e.type?n:nn.Math.factorial(n)},initial:function(n,e,t){var i=t&&"cyclic"===t.type?0>n?[e-1].concat(r(e-1,0,1)):r(e,0,1):0>n?r(e,e-1,-1):r(e,0,1);return i},cascade:Y.cascade,dual:Y.dual,succ:function(n,e,t,r,i){return F(e,r,n,i&&i.type?i.type:"permutation")},rand:function(n,e){if(e&&"cyclic"===e.type){var t=nn.Math.rndInt(0,n-1);return t>0?r(n-t,t,1).concat(r(t,0,1)):r(n,0,1)}return g(r(n,0,1),!1,!1)},rank:function(n,e,t){var r,i,u=nn.Arithmetic,l=u.add,o=u.mul,a=u.O;if(e=e||n.length,!e)return u.J;if(t&&"cyclic"===t.type)return n[0];for(n=O(n),i=e-1,r=0;i>r;r++)a=l(o(a,e-r),n[r]);return a},unrank:function(n,e,t){var i,u,l,o,a,f=nn.Arithmetic,s=f.mod,c=f.div,d=f.val;if(!e)return[];if(t&&"cyclic"===t.type)return n=d(n),r(e,function(t){return(n+t)%e});for(i=r(e),i[e-1]=0,u=n,l=e-2;l>=0;l--)o=e-l,a=s(u,o),u=c(u,o),i[l]=d(a);return R(i)},permute:function(n,e,t){var i,u,l,o=n.length;for(!0===t?(u=r(o),l=n):(u=n,l=n.slice()),i=0;o>i;i++)u[i]=l[e[i]];return u},shuffle:function(n,e){if(!0===e){var t=n.length,r=nn.Math.rndInt(0,t-1);return r>0&&n.push.apply(n,n.splice(0,r)),n}return g(n,!1,!1)},compose:function(){return q(rn.call(arguments))},concatenate:function(){return j(rn.call(arguments))},inverse:function(n){return N(n)},cycles:function(n,e){return-1===e?cycles2permutation(n):k(n)},swaps:function(n,e){return-1===e?P(n):$(n)},inversion:function(n,e){return-1===e?R(n):O(n)},matrix:function(n,e,t){return-1===t?T(n,e):L(n,e)},parity:e,is_permutation:X,is_identity:V,is_cyclic:D,is_derangement:J,is_involution:function(n){return G(n,1)},is_kthroot:function(n,e){return e>1?G(n,e-1):!1},is_connected:function(n){var e,t=n.length,r=-1;for(e=0;t-1>e;e++)if(n[e]>r&&(r=n[e]),e>=r)return!1;return!0}}}),Q=nn.Combination=hn(Y,{constructor:function Rn(n,e,t){var r=this;if(!(r instanceof Rn))return new Rn(n,e,t);if(an(n)?(t=e||{},e=n[1]||1,n=n[0]||1):(t=t||{},n=n||1,e=e||1),t.type=String(t.type||"unordered").toLowerCase(),
-1<t.type.indexOf("+")){var i=t.type.split("+");i.sort(),t.type=i.join("+")}e instanceof Y?(t.sub=e,e=t.sub.dimension()):n instanceof Y&&(t.sub=n,n=t.sub.base()),t.base=n,t.dimension=e,Y.call(r,"Combination",[n,e],t)},__static__:{C:function(n,e){return d(n,e[0])},P:Y.P,T:Y.T,count:function(n,e){var t=e&&e.type?e.type:"unordered";return"ordered+repeated"===t?nn.Math.exp(n[0],n[1]):"repeated"===t?nn.Math.factorial(n[0]+n[1]-1,n[1]):"ordered"===t?nn.Math.factorial(n[0],-n[1]):nn.Math.factorial(n[0],n[1])},initial:function(n,e,t){var i=t&&t.type?t.type:"unordered",u="ordered+repeated"===i||"repeated"===i?0>n?r(e[1],e[0]-1,0):r(e[1],0,0):"ordered"===i?0>n?r(e[1],e[0]-1,-1):r(e[1],0,1):0>n?r(e[1],e[0]-e[1],1):r(e[1],0,1);return u},cascade:Y.cascade,dual:Y.dual,succ:function(n,e,t,r,i){return U(e,r,n,i&&i.type?i.type:"unordered")},rand:function(n,e){var t,i,u,l,o=e&&e.type?e.type:"unordered",a=n[1],f=nn.Math.rndInt;return n=n[0],i=n-a,u=n-1,"repeated"===o||"ordered+repeated"===o?(t=1===a?[f(0,u)]:r(a,function(){return f(0,u)}),a>1&&"repeated"===o&&v(t)):"ordered"===o?(l={},t=1===a?[f(0,u)]:n===a?g(r(a,0,1),!1,!1):r(a,function(){for(var e=f(0,u);1===l[e];)e=(e+1)%n;return l[e]=1,e})):(l={},t=1===a?[f(0,u)]:n===a?r(a,0,1):a>i?b(n,v(r(i,function(){for(var e=f(0,u);1===l[e];)e=(e+1)%n;return l[e]=1,e}))):v(r(a,function(){for(var e=f(0,u);1===l[e];)e=(e+1)%n;return l[e]=1,e}))),t},rank:function(n,e,t){var r,i,u,l,o,a=nn.Arithmetic,f=a.add,s=a.sub,c=a.mul,d=a.O,_=(a.I,d),m=e[1],h=t&&t.type?t.type:"unordered",b=nn.Math.factorial;if("ordered+repeated"===h)for(l=e[0],r=0;m>r;r++)_=f(c(_,l),n[r]);else if("repeated"===h){for(l=e[0]+m-1,o=t&&t.count?t.count:b(l,m),r=1;m>=r;r++)i=l-1-n[r-1]-r+1,u=m+1-r,i>=u&&(_=f(_,b(i,u)));_=s(s(o,a.I),_)}else{if("ordered"===h){for(l=e[0],n=O(n,l),r=0;m>r;r++)_=f(c(_,l-r),n[r]);return _}for(l=e[0],o=t&&t.count?t.count:b(l,m),r=1;m>=r;r++)i=l-1-n[r-1],u=m+1-r,i>=u&&(_=f(_,b(i,u)));_=s(s(o,a.I),_)}return _},unrank:function(n,e,t){var i,u,l,o,a,f,s,c=nn.Arithmetic,d=c.O,_=c.I,m=c.sub,h=c.div,b=c.mod,p=c.mul,v=c.lte,g=c.gt,x=c.val,y=e[1],A=t&&t.type?t.type:"unordered";if(e=e[0],i=r(y),"ordered+repeated"===A)for(o=n,f=y-1;f>=0;f--)a=b(o,e),o=h(o,e),i[f]=x(a);else if("ordered"===A){for(o=n,f=y-1;f>=0;f--)l=e-f,a=b(o,l),o=h(o,l),i[f]=x(a);i=R(i,e)}else{s="repeated"===A,l=s?e+y-1:e,u=t&&t.count?t.count:nn.Math.factorial(l,y),n=m(m(u,_),n),u=h(p(u,l-y),l),a=l-y+1,o=y,f=l-1;do v(u,n)?(i[y-o]=s?l-a-y+1:l-a-o+1,g(u,d)&&(n=m(n,u),u=h(p(u,o),f)),o--,f--):(u=h(p(u,f-o),f),a--,f--);while(o>0)}return i},complement:function(n,e,t){return!0===t?g(b(e,v(n))):b(e,n)},pick:function(n,e,t){return e>0?x(n,e,"ordered+repeated"!==t&&"ordered"!==t,"ordered+repeated"===t||"repeated"===t,new Array(e)):[]},choose:function(n,e){return r(e.length,function(t){return n[e[t]]})}}}),Q.conjugate=Q.complement,Z=nn.Powerset=nn.Subset=hn(Y,{constructor:function Sn(n,e){var t=this;return t instanceof Sn?(e=e||{},e.type=e.type||"subset",n=n||1,n instanceof Y&&(e.sub=n,n=e.sub.base()),e.base=n,e.dimension={from:0,to:n},void Y.call(t,"Subset",n,e)):new Sn(n,e)},__static__:{C:function(n,e){return b(e,n)},P:Y.P,T:Y.T,count:function(n,e){return nn.Math.pow2(n)},initial:function(n,e,t){var i=0>n?r(e,0,1):[];return i},cascade:Y.cascade,dual:function(n,e,t,r){if(null==n)return null;var i=this,u=r&&r.order?r.order:0,l=i.C,o=i.P;i.T;return n=yn&u?pn&u?n:o(n,t):xn&u?pn&u?n.slice():o(n,t):gn&u?pn&u?o(l(n,t),t):l(n,t):pn&u?n.slice():o(n,t),r&&"binary"===r.type&&(n=y(n,t)),n},succ:Y.succ,rand:function(n,e){for(var t,i=nn.Math.rndInt,u=null,l=n-1;l>=0;l--)i(0,1)&&(u={len:u?u.len+1:1,k:l,next:u});return t=u?r(u.len,function(n){var e=u.k;return u=u.next,e}):[]},rank:function(n,e,t){for(var r=nn.Arithmetic,i=r.O,u=r.I,l=r.add,o=r.shl,a=i,f=0,s=subset.length;s>f;)a=l(a,o(u,subset[f++]));return a},unrank:function(n,e,t){var r=this,i=nn.Arithmetic,u=i.O,l=i.J,o=i.band,a=i.shr,f=i.gt,s=[],c=0;if(!i.inside(n,l,t&&t.count?t.count:r.count(e,t)))return null;for(;f(n,u);)f(o(n,1),u)&&s.push(c),f(o(n,2),u)&&s.push(c+1),f(o(n,4),u)&&s.push(c+2),f(o(n,8),u)&&s.push(c+3),f(o(n,16),u)&&s.push(c+4),f(o(n,32),u)&&s.push(c+5),f(o(n,64),u)&&s.push(c+6),f(o(n,128),u)&&s.push(c+7),c+=8,n=a(n,8);return s},binary:function(n,e,t){return-1===t?A(n,e):y(n,e)}}}),W=nn.Partition=hn(Y,{constructor:function kn(n,e){var t=this;if(!(t instanceof kn))return new kn(n,e);e=e||{},e.type=e.type||"partition",n=n||1,n instanceof Y&&(e.sub=n,n=e.sub.base());var r=e["max="]?0|e["max="]:null,i=e["parts="]?0|e["parts="]:null,u=i?i:r?n-r+1:n,l=i?i:r?sn.ceil(n/r):1;e.base=n,e.dimension="constant"===e.length?i||n:u===l?l:{from:sn.min(l,u),to:sn.max(l,u)},Y.call(t,"Partition",n,e)},__static__:{C:function(n,e,t){return w(n,!0===t)},P:Y.P,T:Y.T,count:function(n,e){var t,r,i=nn.Arithmetic.add,u=nn.Math.partitions,l=e&&e["max="]?0|e["max="]:null,o=e&&e["parts="]?0|e["parts="]:null,a=nn.Arithmetic.O,f=l?l:0,s=l?l:1,c=o?o:1,d=o?o:n;if(0>n||o&&l&&(o+l>n+1||n>o*l)||l&&l>n||o&&o>n)return a;for(l&&!o&&(f=0,s=1,c=l,d=l),t=c;d>=t;t++)for(r=f?f:n-t+1;r>=s;r--)a=i(a,u(n,t,r));return a},initial:function(n,e,t){var i,u,l,o=t&&t["max="]?0|t["max="]:null,a=t&&t["parts="]?0|t["parts="]:null;if(0>e)return null;if(a&&o){if(a+o>e+1||e>a*o)return null;0>n?(u=e+2>o+o+a?sn.max(0,sn.min(a-1,sn.floor((e-o)/o)-1)):0,l=e-(u+1)*o-a+u+2,i=[o].concat(u?r(u,o,0).concat(l>0?[l]:[]).concat(r(l?a-2-u:a-1-u,1,0)):[e-o-a+2].concat(r(a-2,1,0)))):(l=sn.min(o,sn.ceil((e-o)/(a-1))),u=(e-o)%l,i=[o].concat(r(a-2,l,0)).concat([u||l]))}else if(a){if(a>e)return null;l=sn.ceil(e/a),u=e%l,i=0>n?[e-a+1].concat(r(a-1,1,0)):r(a-1,l,0).concat([u||l])}else if(o){if(o>e)return null;u=sn.floor(e/o),l=e%o,i=0>n?r(u,o,0).concat(l?[l]:[]):[o].concat(r(e-o,1,0))}else i=0>n?[e]:r(e,1,0);return i},cascade:Y.cascade,dual:function(n,e,t,i){if(null==n)return null;var u=this,l=i&&i.order?i.order:0,o=u.C,a=u.P;u.T;return n=yn&l?pn&l?a(n,t):n:xn&l?pn&l?a(n,t):n.slice():gn&l?pn&l?a(o(n,t),t):o(n,t):pn&l?a(n,t):n.slice(),i&&"unpacked"===i.type&&(n=I(n)),i&&"set"===i.type?C(n):(i&&"constant"===i.length&&n.length<t&&(n=n.concat(r(t-n.length,0,0))),i&&"packed"===i.type&&(n=M(n)),n)},succ:function(n,e,t,r,i){var u=i&&i["max="]?0|i["max="]:null,l=i&&i["parts="]?0|i["parts="]:null;return 0>r||l&&u&&(l+u>r+1||r>l*u)||l&&l>r||u&&u>r?null:B(e,r,n,l,u)},rand:Y.rand,rank:e,unrank:e,conjugate:w,sets:function(n,e){return-1===e?E(n):C(n)},pack:function(n,e){return-1===e?I(n):M(n)}}}),W.transpose=W.conjugate,nn});