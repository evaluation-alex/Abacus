/**
*
*   Abacus
*   A combinatorics library for Node/XPCOM/JS, PHP, Python
*   @version: 0.1.0
*   https://github.com/foo123/Abacus
**/
!function(t,r,n){"use strict";var e;"undefined"!=typeof Components&&"object"==typeof Components.classes&&"object"==typeof Components.classesByID&&Components.utils&&"function"==typeof Components.utils["import"]?(t.EXPORTED_SYMBOLS=[r])&&(t[r]=n.call(t)):"object"==typeof module&&module.exports?module.exports=n.call(t):"function"==typeof define&&define.amd&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(r)?define(r,["require","exports","module"],function(){return n.call(t)}):r in t||(t[r]=e=n.call(t))&&"function"==typeof define&&define.amd&&define(function(){return e})}(this,"Abacus",function(t){"use strict";var r,n,e,i,u,o,f,a,s,c={VERSION:"0.1.0"},l="prototype",h="constructor",_="hasOwnProperty",d=Array.prototype.slice,m=Object.create,v=function(t,r){for(var n in r)r[_](n)&&(t[n]=r[n]);return t},p=function(t,r){1===arguments.length&&(r=t,t=Object);var n=r[h];return r[_]("__static__")&&(n=v(n,r.__static__),delete r.__static__),n[l]=v(m(t[l]),r),n},g=Math.log2||function(t){return Math.log(t)/Math.LN2},A=function(t){return function(r){var n,e;return e=r.toString(2),(n=t-e.length)>0&&(e=new Array(n+1).join("0")+e),e}},w=A(32),b=function(t,r,n,e,i,u){var o=t.length;if(arguments.length<5&&(i=o-1),0>i&&(i+=o),arguments.length<4&&(e=0),e>i)return n;if(!0===u){var f,a,s=i-e+1,c=s-1,l=15&s,h=1&l,_=c-l,d=h?r(n,t[i],i):n;for(f=c-h;f>_;f-=2)a=e+f,d=r(r(d,t[a],a),t[a-1],a-1);for(f=_;f>=0;f-=16)a=e+f,d=r(r(r(r(r(r(r(r(r(r(r(r(r(r(r(r(d,t[a],a),t[a-1],a-1),t[a-2],a-2),t[a-3],a-3),t[a-4],a-4),t[a-5],a-5),t[a-6],a-6),t[a-7],a-7),t[a-8],a-8),t[a-9],a-9),t[a-10],a-10),t[a-11],a-11),t[a-12],a-12),t[a-13],a-13),t[a-14],a-14),t[a-15],a-15)}else{var f,a,s=i-e+1,l=15&s,h=1&l,d=h?r(n,t[e],e):n;for(f=h;l>f;f+=2)a=e+f,d=r(r(d,t[a],a),t[a+1],a+1);for(f=l;s>f;f+=16)a=e+f,d=r(r(r(r(r(r(r(r(r(r(r(r(r(r(r(r(d,t[a],a),t[a+1],a+1),t[a+2],a+2),t[a+3],a+3),t[a+4],a+4),t[a+5],a+5),t[a+6],a+6),t[a+7],a+7),t[a+8],a+8),t[a+9],a+9),t[a+10],a+10),t[a+11],a+11),t[a+12],a+12),t[a+13],a+13),t[a+14],a+14),t[a+15],a+15)}return d},y=function(t,r,n,e){if(n>e)return r;var i,u,o=e-n+1,f=15&o,a=1&f,s=a?t(r,n):r;for(i=a;f>i;i+=2)u=n+i,s=t(t(s,u),u+1);for(i=f;o>i;i+=16)u=n+i,s=t(t(t(t(t(t(t(t(t(t(t(t(t(t(t(t(s,u),u+1),u+2),u+3),u+4),u+5),u+6),u+7),u+8),u+9),u+10),u+11),u+12),u+13),u+14),u+15);return s},x=function(t,r,n,e,i){var u=t.length;if(arguments.length<4&&(e=u-1),0>e&&(e+=u),arguments.length<3&&(n=0),n>e)return[];var o,f,a,s,c,l,h=e-n+1,_=new Array(h);if(!0===i){for(a=h-1,c=15&h,l=1&c,s=a-c,l&&(_[0]=r(t[e],e,n,e)),o=a-l;o>s;o-=2)f=n+o,_[o]=r(t[f],f,n,e),_[o+1]=r(t[f-1],f-1,n,e);for(o=s;o>=0;o-=16)f=n+o,_[o]=r(t[f],f,n,e),_[o+1]=r(t[f-1],f-1,n,e),_[o+2]=r(t[f-2],f-2,n,e),_[o+3]=r(t[f-3],f-3,n,e),_[o+4]=r(t[f-4],f-4,n,e),_[o+5]=r(t[f-5],f-5,n,e),_[o+6]=r(t[f-6],f-6,n,e),_[o+7]=r(t[f-7],f-7,n,e),_[o+8]=r(t[f-8],f-8,n,e),_[o+9]=r(t[f-9],f-9,n,e),_[o+10]=r(t[f-10],f-10,n,e),_[o+11]=r(t[f-11],f-11,n,e),_[o+12]=r(t[f-12],f-12,n,e),_[o+13]=r(t[f-13],f-13,n,e),_[o+14]=r(t[f-14],f-14,n,e),_[o+15]=r(t[f-15],f-15,n,e)}else{for(c=15&h,l=1&c,l&&(_[0]=r(t[n],n,n,e)),o=l;c>o;o+=2)f=n+o,_[o]=r(t[f],f,n,e),_[o+1]=r(t[f+1],f+1,n,e);for(o=c;h>o;o+=16)f=n+o,_[o]=r(t[f],f,n,e),_[o+1]=r(t[f+1],f+1,n,e),_[o+2]=r(t[f+2],f+2,n,e),_[o+3]=r(t[f+3],f+3,n,e),_[o+4]=r(t[f+4],f+4,n,e),_[o+5]=r(t[f+5],f+5,n,e),_[o+6]=r(t[f+6],f+6,n,e),_[o+7]=r(t[f+7],f+7,n,e),_[o+8]=r(t[f+8],f+8,n,e),_[o+9]=r(t[f+9],f+9,n,e),_[o+10]=r(t[f+10],f+10,n,e),_[o+11]=r(t[f+11],f+11,n,e),_[o+12]=r(t[f+12],f+12,n,e),_[o+13]=r(t[f+13],f+13,n,e),_[o+14]=r(t[f+14],f+14,n,e),_[o+15]=r(t[f+15],f+15,n,e)}return _},k=function(t,r,n,e,i){var u=t.length;if(arguments.length<4&&(e=u-1),0>e&&(e+=u),arguments.length<3&&(n=0),n>e)return[];var o,f,a,s,c,l,h=e-n+1,_=[];if(trye===i){for(a=h-1,c=15&h,l=1&c,s=a-c,l&&r(t[e],e,t)&&_.push(t[e]),o=a-l;o>s;o-=2)f=n+o,r(t[f],f,t)&&_.push(t[f]),r(t[--f],f,t)&&_.push(t[f]);for(o=s;o>=0;o-=16)f=n+o,r(t[f],f,t)&&_.push(t[f]),r(t[--f],f,t)&&_.push(t[f]),r(t[--f],f,t)&&_.push(t[f]),r(t[--f],f,t)&&_.push(t[f]),r(t[--f],f,t)&&_.push(t[f]),r(t[--f],f,t)&&_.push(t[f]),r(t[--f],f,t)&&_.push(t[f]),r(t[--f],f,t)&&_.push(t[f]),r(t[--f],f,t)&&_.push(t[f]),r(t[--f],f,t)&&_.push(t[f]),r(t[--f],f,t)&&_.push(t[f]),r(t[--f],f,t)&&_.push(t[f]),r(t[--f],f,t)&&_.push(t[f]),r(t[--f],f,t)&&_.push(t[f]),r(t[--f],f,t)&&_.push(t[f]),r(t[--f],f,t)&&_.push(t[f])}else{for(c=15&h,l=1&c,l&&r(t[n],n,t)&&_.push(t[n]),o=l;c>o;o+=2)f=n+o,r(t[f],f,t)&&_.push(t[f]),r(t[++f],f,t)&&_.push(t[f]);for(o=c;h>o;o+=16)f=n+o,r(t[f],f,t)&&_.push(t[f]),r(t[++f],f,t)&&_.push(t[f]),r(t[++f],f,t)&&_.push(t[f]),r(t[++f],f,t)&&_.push(t[f]),r(t[++f],f,t)&&_.push(t[f]),r(t[++f],f,t)&&_.push(t[f]),r(t[++f],f,t)&&_.push(t[f]),r(t[++f],f,t)&&_.push(t[f]),r(t[++f],f,t)&&_.push(t[f]),r(t[++f],f,t)&&_.push(t[f]),r(t[++f],f,t)&&_.push(t[f]),r(t[++f],f,t)&&_.push(t[f]),r(t[++f],f,t)&&_.push(t[f]),r(t[++f],f,t)&&_.push(t[f]),r(t[++f],f,t)&&_.push(t[f]),r(t[++f],f,t)&&_.push(t[f])}return _},U=function(t,r,n,e,i){var u=t.length;if(arguments.length<4&&(e=u-1),0>e&&(e+=u),arguments.length<3&&(n=0),n>e)return t;var o,f,a,s,c,l,h=e-n+1;if(!0===i){for(a=h-1,c=15&h,l=1&c,s=a-c,l&&r(t[e],e,t,n,e),o=a-l;o>s;o-=2)f=n+o,r(t[f],f,t,n,e),r(t[--f],f,t,n,e);for(o=s;o>=0;o-=16)f=n+o,r(t[f],f,t,n,e),r(t[--f],f,t,n,e),r(t[--f],f,t,n,e),r(t[--f],f,t,n,e),r(t[--f],f,t,n,e),r(t[--f],f,t,n,e),r(t[--f],f,t,n,e),r(t[--f],f,t,n,e),r(t[--f],f,t,n,e),r(t[--f],f,t,n,e),r(t[--f],f,t,n,e),r(t[--f],f,t,n,e),r(t[--f],f,t,n,e),r(t[--f],f,t,n,e),r(t[--f],f,t,n,e),r(t[--f],f,t,n,e)}else{for(c=15&h,l=1&c,l&&r(t[n],n,t,n,e),o=l;c>o;o+=2)f=n+o,r(t[f],f,t,n,e),r(t[++f],f,t,n,e);for(o=c;h>o;o+=16)f=n+o,r(t[f],f,t,n,e),r(t[++f],f,t,n,e),r(t[++f],f,t,n,e),r(t[++f],f,t,n,e),r(t[++f],f,t,n,e),r(t[++f],f,t,n,e),r(t[++f],f,t,n,e),r(t[++f],f,t,n,e),r(t[++f],f,t,n,e),r(t[++f],f,t,n,e),r(t[++f],f,t,n,e),r(t[++f],f,t,n,e),r(t[++f],f,t,n,e),r(t[++f],f,t,n,e),r(t[++f],f,t,n,e),r(t[++f],f,t,n,e)}return t},C=function(t,r){for(var n=0,e=0,i=[],u=t.length,o=r.length;u>n&&o>e;)t[n]<r[e]?n++:t[n]>r[e]?e++:(i.push(t[n]),n++,e++);return i},q=function(t,r,n){var e,i,u=0,o=0,f=[],a=t.length,s=r.length;for(n=!1!==n,i=!n;a>u&&s>o;){if(n&&f.length){if(t[u]===e){u++;continue}if(r[o]===e){o++;continue}}t[u]<r[o]?f.push(e=t[u++]):t[u]>r[o]?f.push(e=r[o++]):(f.push(e=t[u]),i&&f.push(r[o]),u++,o++)}for(;a>u;)(i||t[u]!==e)&&f.push(e=t[u++]);for(;s>o;)(i||r[o]!==e)&&f.push(e=r[o++]);return f},E=function(){var t,r,n,e,i,u,o,f,a,s,c=arguments,l=c.length;if(!l)return[];for(a=c[0].length,t=1;l>t;t++)a*=c[t].length;for(s=new Array(a),t=0;a>t;t++){for(f=[],n=t,r=l-1;r>=0;r--)if(e=c[r].length,i=n%e,n=~~(n/e),o=c[r][i],o instanceof Array)for(u=o.length-1;u>=0;u--)f.unshift(o[u]);else f.unshift(o);s[t]=f}return s},I=function(){},O=function(t,r,n){var e,i,u,o,f,a=c.Arithmetic.rnd;for(o=!0===n?t.slice():t,f=!0===r?1:0,e=o.length;f<e--;)i=a(0,e-f),e!==i&&(u=o[e],o[e]=o[i],o[i]=u);return o},R=function(t,r,n){var e,i,u,o,f,a=c.Arithmetic.rnd,s=t.length;for(r=c.Arithmetic.min(r,s),e=new Array(r),n=!1!==n,n&&(i=new Array(r)),u=0;r>u;u++)o=a(0,--s),f=t[o],t[o]=t[s],t[s]=f,e[u]=f,n&&(i[u]=o);if(n)for(u=r-1;u>=0;u--)o=i[u],f=t[s],t[s]=t[o],t[o]=f,s++;return e},M=function(t,r){var n,e,i,u,o=t.length;for(n=new Array(r-o),e=0,i=0,u=0;r>e;)i>=o||e<t[i]?n[u++]=e:i++,e++;return n},L=function(t,r){if(null==t)return null;if(!t.length)return[];var n,e=t.length,i=new Array(e);if(r.length===e)for(n=0;e>n;n++)i[n]=r[n]-1-t[n];else for(n=0;e>n;n++)i[n]=r-1-t[e-1-n];return i},S=function(t){var r,n=[],e=t.length;if(e>1)for(r=e-1;r>=1;r--)n.push([t[0],t[r]]);return n},N=function(t){var r=c.Arithmetic.add;return b(t,r,0)},P=function(t){var r=c.Arithmetic.mul;return b(t,r,1)},X=function(t){return c.Arithmetic.shl(1,t)},j=function(t,r){return c.Arithmetic.pow(t,r)},T=function(t){var r=c.Arithmetic.mul;return 0>t?0:2>t?1:4>t?t<<t-2:y(r,1,2,t)},D=function(t,r){if(r>t-r&&(r=t-r),0>r||1>t)return 0;if(0===r||1===t)return 1;if(1===r)return t;var n,e=c.Arithmetic.mul,i=c.Arithmetic.add,u=t-r,o=1+u;for(n=2;r>=n;n++)o=i(o,e(o,u/n));return c.Arithmetic.round(o)},H=function Z(t,r,n,e){if(n===t&&1===r||r===t&&1===n)return 1;if(n+r>t+1||t>r*n)return 0;var i,u,o=c.Arithmetic.add,f=c.Arithmetic.min(n,t-n-r+2),a=c.Arithmetic.max(1,c.Arithmetic.ceil((t-n)/(r-1))),s=0;for(null==e&&(e={}),i=a;f>=i;i++)u=t-n+","+(r-1)+","+i,null==e[u]&&(e[u]=Z(t-n,r-1,i,e)),s=o(s,e[u]);return s},G=8,V=16,B=32,K=64,Y=128,z=256,F=512,J=G|V|B|K|Y|z|F,Q=function(t){return arguments.length&&null!=t?t.substr?(t=t.toUpperCase(),c.ORDER[_](t)?c.ORDER[t]:G):J&t?t:G:G},W=function(t){return arguments.length?function(){throw new Error('"'+t+'" not implemented')}:function(){throw new Error("Method not implemented")}};return c.Util={rnd:Math.random,rint:function(t,r){return c.Arithmetic.round((r-t)*c.Util.rnd()+t)},shuffle:O,pick:R,operate:b,operation:y,map:x,filter:k,each:U,intersection:C,union:q,kronecker:E,cartesian:I,val:function(t){return c.Arithmetic.floor(t.valueOf())},equ:function(t,r){return t===r},gte:function(t,r){return t>=r},lte:function(t,r){return r>=t},gt:function(t,r){return t>r},lt:function(t,r){return r>t},add:function(t,r){return t+r},sub:function(t,r){return t-r},mul:function(t,r){return t*r},div:function(t,r){return c.Arithmetic.floor(t/r)},mod:function(t,r){return t%r},pow:Math.pow,shl:function(t,r){return t<<r},shr:function(t,r){return t>>r},bor:function(t,r){return t|r},band:function(t,r){return t&r},neg:function(t){return c.Arithmetic.sub(0,t)},abs:Math.abs,min:Math.min,max:Math.max,floor:Math.floor,ceil:Math.ceil,round:Math.round,gcd:function(t,r){var n,e,i=1,u=0,o=0,f=1,a=1,s=1;for(0>t&&(t=-t,a=-1),0>r&&(r=-r,s=-1),r>t&&(n=t,t=r,r=n);;){if(e=-c.Arithmetic.floor(t/r),t%=r,i+=e*o,u+=e*f,0===t)return[r*s,o,f];if(e=-c.Arithmetic.floor(r/t),r%=t,o+=e*i,f+=e*u,0===r)return[t*a,i,u]}return[]},sum:N,product:P,pow2:X,powNK:j,factorial:T,binomial:D,partitions:H},c.Arithmetic={val:c.Util.val,equ:c.Util.equ,gte:c.Util.gte,lte:c.Util.lte,gt:c.Util.gt,lt:c.Util.lt,add:c.Util.add,sub:c.Util.sub,mul:c.Util.mul,div:c.Util.div,mod:c.Util.mod,pow:c.Util.pow,shl:c.Util.shl,shr:c.Util.shr,bor:c.Util.bor,band:c.Util.band,neg:c.Util.neg,abs:c.Util.abs,min:c.Util.min,max:c.Util.max,floor:c.Util.floor,ceil:c.Util.ceil,round:c.Util.round,rnd:c.Util.rint,gcd:c.Util.gcd},c.ORDER={LEX:G,LEXICOGRAPHIC:G,REVLEX:V,ANTILEX:V,REVERSELEXICOGRAPHIC:V,ANTILEXICOGRAPHIC:V,COLEX:B,COLEXICOGRAPHIC:B,REVCOLEX:K,ANTICOLEX:K,REVERSECOLEXICOGRAPHIC:K,ANTICOLEXICOGRAPHIC:K,RANDOM:z,RANDOMISED:z,STOCHASTIC:F},r=c.BitArray=p({constructor:function $(t){var r=this;return r instanceof $?(r.length=t,void(r.bits=new Uint32Array(c.Arithmetic.ceil(t/32)))):new $(t)},length:0,bits:null,dispose:function(){var t=this;return t.length=null,t.bits=null,t},clone:function(){var t=this,n=new r(t.length);return n.bits=new Uint32Array(t.bits),n},fromArray:function(t){var r=this;return r.bits=new Uint32Array(t),r},toArray:function(){return d.call(this.bits)},toString:function(){return x(this.toArray(),w).join("")},reset:function(){var t,r=this,n=r.bits,e=n.length;for(t=0;e>t;t++)n[t]=0;return r},isset:function(t){return!!(this.bits[t>>>5]&1<<(31&t))},set:function(t){var r=this;return r.bits[t>>>5]|=1<<(31&t),r},unset:function(t){var r=this;return r.bits[t>>>5]&=~(1<<(31&t)),r},toggle:function(t){var r=this;return r.bits[t>>>5]^=1<<(31&t),r}}),n=c.CombinatorialIterator=p({constructor:function tt(t){var r,n=this;return n instanceof tt?(r=n[h],n.n=t||0,n._count=r.count(n.n),void n.order(G)):new tt(t)},__static__:{count:W(),dual:function(t,r,n){return 0>=r?[]:L(t,r)},rank:W(),unrank:W(),first:W(),last:W(),succ:function(t,r,n,e){var i=this,u=c.Arithmetic;return-1!==t&&1!==t&&(t=1),r?i.unrank(u.add(i.rank(r,n,e),t),n,e):null},rand:function(t,r){var n=this,e=c.Arithmetic,i=r?r:n.count(t),u=e.sub(i,1),o=e.rnd(0,u);return e.equ(0,o)?n.first(t):e.equ(o,u)?n.last(t):n.unrank(o,t,i)},stochastic:W()},n:0,_order:0,_count:0,_index:null,__item:null,_item:null,_prev:null,_next:null,_traversed:null,_stochastic:null,dispose:function(){var t=this;return t.n=null,t._order=null,t._count=0,t._index=null,t.__item=null,t._item=null,t._prev=null,t._next=null,t._stochastic=null,t._traversed&&(t._traversed.dispose(),t._traversed=null),t},_store:function(){var t=this;return[t._order,t._index,t.__item,t._item,t._prev,t._next]},_restore:function(t){var r=this;return t&&(r._order=t[0],r._index=t[1],r.__item=t[2],r._item=t[3],r._prev=t[4],r._next=t[5]),r},total:function(){return this._count},order:function(t,n,e){var i,u,o,f=this,a=f[h];if(!arguments.length)return f._order;if(t=Q(t),f._order=t,f._index=0,f._item=f.__item=null,f._prev=!1,f._next=!1,u=f._count,o=f.n,F&t)if(null==f._stochastic||n){if(!n)throw new Error("No Stochastic Transition Matrix given!");f._stochastic=[n,e?1:0,e?[]:null],f._item=f.__item=a.stochastic(f._stochastic[0],o,f._stochastic[2])}else null!=f._stochastic[2]&&(f._stochastic[2]=[]),f._item=f.__item=a.stochastic(f._stochastic[0],o,f._stochastic[2]);else z&t?(f._traversed?f._traversed.reset():f._traversed=new r(u),f._traversed.set(i=f.randomIndex()),f._item=f.__item=f.item(i,G)):K&t?(f.__item=a.first(o),f._item=a.dual(f.__item,o,K)):B&t?(f.__item=a.last(o),f._item=a.dual(f.__item,o,B)):V&t?f._item=f.__item=a.last(o):f._item=f.__item=a.first(o);return f._next=null!=f._item,f},index:function(t){if(!arguments.length)return this._index;var r,n=this,e=c.Arithmetic,i=n[h],u=n.n,o=n._count,f=n._order;return e.gt(0,t)&&(t=e.add(t,o)),e.gte(t,0)&&e.lt(t,o)&&(r=e.sub(o,1),K&f?(n._index=t,n.__item=e.equ(0,t)?i.first(u):e.equ(r,t)?i.last(u):i.unrank(t,u,o),n._item=i.dual(n.__item,u,K)):B&f?(n._index=t,n.__item=e.equ(0,t)?i.last(u):e.equ(r,t)?i.first(u):i.unrank(e.sub(r,t),u,o),n._item=i.dual(n.__item,u,B)):V&f?(n._index=t,n._item=n.__item=e.equ(0,t)?i.last(u):e.equ(r,t)?i.first(u):i.unrank(e.sub(r,t),u,o)):G&f&&(n._index=t,n._item=n.__item=e.equ(0,t)?i.first(u):e.equ(r,t)?i.last(u):i.unrank(t,u,o))),n},item:function(t,r){if(!arguments.length)return this._item;var n,e,i,u=this,o=u.n,f=u._count,a=u[h],s=c.Arithmetic;if(r=null!=r?Q(r):u._order,s.gt(0,t)&&(t=s.add(t,f)),s.gte(t,0)&&s.lt(t,f)){if(n=s.sub(f,1),z&r){for(e=u._traversed;e.isset(i=u.randomIndex()););return e.set(i),a.unrank(i,o,f)}return K&r?a.dual(s.equ(0,t)?a.first(o):s.equ(n,t)?a.last(o):a.unrank(t,o,f),o,K):B&r?a.dual(s.equ(0,t)?a.last(o):s.equ(n,t)?a.first(o):a.unrank(s.sub(n,t),o,f),o,B):V&r?s.equ(0,t)?a.last(o):s.equ(n,t)?a.first(o):a.unrank(s.sub(n,t),o,f):s.equ(0,t)?a.first(o):s.equ(n,t)?a.last(o):a.unrank(t,o,f)}return null},randomIndex:function(t,r){var n=this,e=c.Arithmetic,i=n._count,u=arguments.length;return 0===u?(t=0,r=e.sub(i,1)):1===u&&(t=t||0,r=e.sub(i,1)),e.rnd(t,r)},random:function(){var t=this,r=t[h];return r.rand(t.n,t._count)},rewind:function(){var t=this;return t.order(t._order),t._prev=!1,t},hasNext:function(){return F&this._order?!0:this._next},next:function(){var t,r,n=this,e=c.Arithmetic,i=n._order,u=n[h],o=n._item,f=n.n,a=n._count;if(F&i)n._item=n.__item=u.stochastic(n._stochastic[0],f,n._stochastic[2]);else if(z&i)if(e.lt(e.add(n._index,1),a)){for(n._index=e.add(n._index,1),t=n._traversed;t.isset(r=n.randomIndex()););t.set(r),n._item=n.__item=n.item(r,G),n._next=null!=n._item}else n._next=!1,n._traversed&&(n._traversed.dispose(),n._traversed=null);else K&i?(n.__item=u.succ(1,n.__item,f,a),n._item=u.dual(n.__item,f,K)):B&i?(n.__item=u.succ(-1,n.__item,f,a),n._item=u.dual(n.__item,f,B)):V&i?n._item=n.__item=u.succ(-1,n.__item,f,a):n._item=n.__item=u.succ(1,n.__item,f,a),n._next=null!=n._item,n._next&&(n._index=e.add(n._index,1));return o},forward:function(){var t=this,r=c.Arithmetic;return t.order(t._order).index(r.sub(t._count,1)),t._prev=r.gte(t._index,0),t._next=!1,t},hasPrev:function(){return(z|F)&this._order?!1:this._prev},prev:function(){var t=this,r=t._order,n=t[h],e=t._item,i=t.n,u=t._count;return(z|F)&r?null:(K&r?(t.__item=n.succ(-1,t.__item,i,u),t._item=n.dual(t.__item,i,K)):B&r?(t.__item=n.succ(1,t.__item,i,u),t._item=n.dual(t.__item,i,B)):V&r?t._item=t.__item=n.succ(1,t.__item,i,u):t._item=t.__item=n.succ(-1,t.__item,i,u),t._prev=null!=t._item,t._prev&&--t._index,e)},range:function(t,r){var n,e,i,u,o,f=this,a=c.Arithmetic,s=f._count,l=1,h=arguments.length,_=a.sub(s,1);if(1>h?(t=0,r=_):2>h&&(r=_),a.lt(t,0)&&(t=a.add(t,s)),a.lt(r,0)&&(r=a.add(r,s)),a.gt(t,r)&&(n=t,t=r,r=n,l=-1),a.lt(t,0)&&(t=0),a.gt(r,_)&&(r=_),a.lte(t,r)){if(o=f._store(),(F|z)&f._order||f.index(t),i=a.val(a.sub(r,t)),e=new Array(i+1),0>l)for(u=i;u>=0;u--)e[u]=f.next();else for(u=0;i>=u;u++)e[u]=f.next();f._restore(o)}else e=[];return e}}),e=c.Permutation=p(n,{constructor:function rt(t){var r=this;return r instanceof rt?void n.call(r,t):new rt(t)},__static__:{count:function(t){return T(t)},dual:n.dual,rank:function(t,r){var n,e,i,u,o=c.Arithmetic,f=0,a=o.ceil(g(r)),s=(1<<1+a)-1,l=new Array(s),h=o.shl(1,a);for(n=0;s>n;n++)l[n]=0;for(n=0;r>n;n++){for(u=t[n],i=o.val(o.add(h,u)),e=0;a>e;e++)1&i&&(u=o.sub(u,l[i>>>1<<1])),l[i]=o.add(l[i],1),i>>>=1;l[i]=o.add(l[i],1),f=o.add(o.mul(f,o.sub(n)),u)}return f},unrank:function(t,r,n){var e,i,u,o,f,a,s,l,h,_,d,m,v=c.Arithmetic,p=this;if(n=n||T(r),v.equ(0,t))return p.first(r);if(v.equ(n,v.add(t,1)))return p.last(r);for(e=new Array(r),i=v.div(n,r),h=v.ceil(g(r)),_=(1<<1+h)-1,d=new Array(_),m=v.shl(1,h),u=0;h>=u;u++)for(o=1,f=1<<u;f>=o;o++)d[f-1+o]=v.shl(1,v.sub(h,u));for(l=r-1,u=0;r>u;u++){for(a=v.div(t,i),s=1,o=0;h>o;o++)d[s]=v.sub(d[s],1),s<<=1,v.gte(a,d[s])&&(a=v.sub(a,d[s]),s++);d[s]=0,e[u]=v.val(v.sub(s,m)),l&&(t=v.mod(t,i),i=v.div(i,l),l--)}return e},first:function(t){var r,n=new Array(t);for(r=0;t>r;r++)n[r]=r;return n},last:function(t){var r,n=new Array(t);for(r=0;t>r;r++)n[r]=t-1-r;return n},succ:function(t,r,n){if(r){var e,i,u,o,f,a=r.slice();if(-1===t){for(e=n-2;e>=0&&a[e]<=a[e+1];)e--;if(e>=0){for(i=n-1;i>e&&a[e]<=a[i];)i--;for(f=a[e],a[e]=a[i],a[i]=f,u=e+1,o=n-1;o>u;)f=a[u],a[u++]=a[o],a[o--]=f}else a=null}else{for(e=n-2;e>=0&&a[e]>=a[e+1];)e--;if(e>=0){for(i=n-1;i>e&&a[e]>=a[i];)i--;for(f=a[e],a[e]=a[i],a[i]=f,u=e+1,o=n-1;o>u;)f=a[u],a[u++]=a[o],a[o--]=f}else a=null}return a}return null},rand:function(t){var r,n=new Array(t);for(r=0;t>r;r++)n[r]=r;return O(n)},stochastic:function(t,r,n){if(t.length!==r||t[0].length!==r)throw new Error("Stochastic Matrix dimensions and Permutation dimensions do not match!");var e,i,u,o,f,a,s,l,h=new Array(r),_=new Array(r),d=0,m=c.Util.rnd,v=!1;for(i=0;r>i;i++)_[i]=0;if(n){if(v=!0,!n.length){for(n.N=0,e=new Array(r),i=0;r>i;i++)e[i]=0;for(i=0;r>i;i++)n.push(e.slice())}d=++n.N}for(l=!v,i=0;r>i;)for(o=m(),s=0,f=t[i],v&&(a=n[i]),u=0;r>u;u++){if(o>s&&o<=s+f[u]){0===_[u]&&(l||a[u]+1<=(d+1)*f[u])&&(_[u]=1,h[i]=u,v&&a[u]++,i++);break}s+=f[u]}return h},inverse:function(t,r){r=r||t.length;var n,e=new Array(r);for(n=0;r>n;n++)e[t[n]]=n;return e},compose:function(){var t,r,n,e=arguments,i=e.length,u=i?e[0]:[],o=u.length;for(r=1;i>r;r++)for(n=u.slice(),t=0;o>t;t++)u[t]=n[e[r][t]];return u},permute:function(t,r,n){var e,i,u,o=t.length;for(!0===n?(i=new Array(o),u=t):(i=t,u=t.slice()),e=0;o>e;e++)i[e]=u[r[e]];return i},reassign:function(t,r){var n,e=t.length,i=new Array(e);for(n=0;e>n;n++)i[n]=r[t[n]];return i},shuffle:O,toCycles:function(t,r,n){r=r||t.length;var e,i,u,o=[],f=!0===n?1:0,a=new Array(r),s=new Array(r);for(e=0;r>e;e++)s[e]=e,a[e]=0;for(u=[i=s.shift()],a[i]=1;s.length;){if(i=t[i],a[i])for(u.length>f&&o.push(u),u=[];s.length&&a[i=s.shift()];);a[i]||(u.push(i),a[i]=1)}return u.length>f&&o.push(u),o},fromCycles:function(t,r){var n,e,i,u,o=new Array(r),f=t.length;for(e=0;r>e;e++)o[e]=e;for(n=0;f>n;n++)if(u=t[n],i=u.length,!(2>i)){for(e=0;i-1>e;e++)o[u[e]]=u[e+1];o[u[i-1]]=u[0]}return o},toSwaps:function(t,r){r=r||t.length;var n,i,u,o=[],f=e.toCycles(t,r,!0);for(n=0,i=f.length;i>n;n++)u=f[n],o=o.concat(S(u));return o},fromSwaps:function(t,r){var n,e,i,u=t.length,o=new Array(r);for(n=0;r>n;n++)o[n]=n;for(n=0;u>n;n++)e=t[n],i=o[e[0]],o[e[0]]=o[e[1]],o[e[1]]=i;return o},toMatrix:function(t,r,n){var e,i,u=new Array(r);for(n=!0===n,e=0;r>e;e++)for(u[e]=new Array(r),i=0;r>i;i++)u[e][i]=0;for(e=0;r>e;e++)n?u[t[e]][e]=1:u[e][t[e]]=1;return u},fromMatrix:function(t,r,n){var e,i,u=new Array(r);for(n=!0===n,e=0;r>e;e++)for(i=0;r>i;i++)t[e][i]&&(n?u[i]=e:u[e]=i);return u},isConnected:function(t,r){var n,e=-(1/0);for(r=r||t.length,n=0;r-1>n;n++)if(t[n]>e&&(e=t[n]),n>=e)return!1;return!0}}}),i=c.Combination=p(n,{constructor:function nt(t,r){var e=this;return e instanceof nt?void n.call(e,[t,r]):new nt(t,r)},__static__:{count:function(t){return D(t[0],t[1])},dual:function(t,r){return L(t,r[0])},rank:function(t,r,n){var e,i,u,o,f,a=c.Arithmetic,s=0;for(o=r[1],r=r[0],f=n?n:D(r,o),e=1;o>=e;e++)i=r-1-t[e-1],u=o+1-e,i>=u&&(s=a.add(s,D(i,u)));return a.sub(a.sub(f,1),s)},unrank:function(t,r,n){var e,i,u,o,f,a,s=c.Arithmetic,l=this;if(n=n||D(r[0],r[1]),s.equ(0,t))e=l.first(r);else if(s.equ(n,s.add(t,1)))e=l.last(r);else{u=r[1],r=r[0],e=new Array(u),i=n,t=s.sub(s.sub(i,1),t),i=s.mul(s.sub(r,u),s.div(i,r)),f=r-u+1,o=u,a=r-1;do s.lte(i,t)?(e[u-o]=r-f-o+1,s.gt(i,0)&&(t=s.sub(t,i),i=s.div(s.mul(o,i),a)),o--,a--):(i=s.div(s.mul(s.sub(a,o),i),a),f--,a--);while(o>0)}return e},first:function(t){var r,n=t[1],e=new Array(n);for(r=0;n>r;r++)e[r]=r;return e},last:function(t){var r,n=t[1],e=new Array(n);for(t=t[0],r=0;n>r;r++)e[n-1-r]=t-1-r;return e},succ:function(t,r,n){if(r){var e,i,u,o,f,a=r.slice();if(e=n[1],n=n[0],-1===t){for(i=e-1,u=-1;i>0;){if(a[i]>a[i-1]+1){u=i;break}i--}if(-1===u&&0<a[0]&&(u=0),u>-1){for(f=n,i=e-1;i>u;i--)a[i]=--f;a[u]--}else a=null}else{for(i=e-1,u=-1,o=n-e;i>=0;){if(a[i]<o+i){u=i;break}i--}if(u>-1)for(f=a[u],i=u;e>i;i++)a[i]=++f;else a=null}return a}return null},rand:function(t){var r,n,e,i,u,o,f,a;for(n=t[1],t=t[0],r=new Array(n),e=c.Util.rnd(),u=0,f=0,a=t-n,i=1;n>=i;i++){for(u++,o=(n-i+1)/(t-u+1);e>=o&&a+i>u;)f=o,u++,o=f+(1-f)*((n-i+1)/(t-u+1));r[i-1]=u-1,e=(e-f)/(o-f)}return r},stochastic:n.stochastic,complement:M,choose:function(t,r){var n,e=r.length,i=new Array(e);for(n=0;e>n;n++)i[n]=t[r[n]];return i},pick:R,toMatrix:function(t,r,n){var e,i,u,o;for(i=r[1],r=r[0],e=new Array(r),n=!0===n,u=0;r>u;u++)for(e[u]=new Array(r),o=0;r>o;o++)e[u][o]=0;for(u=0;i>u;u++)n?e[t[u]][u]=1:e[u][t[u]]=1;return e},fromMatrix:function(t,r,n){var e,i,u,o;for(i=r[1],r=r[0],e=new Array(i),n=!0===n,u=0;r>u;u++)for(o=0;r>o;o++)t[u][o]&&(n&&i>o?e[o]=u:!n&&i>u&&(e[u]=o));return e}}}),i.conjugate=i.complement,u=c.CombinationRepeat=p(n,{constructor:function et(t,r){var e=this;return e instanceof et?void n.call(e,[t,r]):new et(t,r)},__static__:{count:function(t){return D(t[0]+t[1]-1,t[1])},dual:i.dual,rank:function(t,r,n){var e,i,u,o,f,a,s=c.Arithmetic,l=0;for(o=r[1],r=r[0],f=r+o-1,a=n?n:D(f,o),e=1;o>=e;e++)i=f-1-t[e-1]-e+1,u=o+1-e,i>=u&&(l=s.add(l,D(i,u)));return s.sub(s.sub(a,1),l)},unrank:function(t,r,n){var e,i,u,o,f,a,s,l=c.Arithmetic,h=this;if(n=n||D(r[0]+r[1]-1,r[1]),l.equ(0,t))return h.first(r);if(l.equ(n,l.add(t,1)))return h.last(r);u=r[1],r=r[0],o=r+u-1,e=new Array(u),i=n,t=l.sub(l.sub(i,1),t),i=l.mul(l.sub(o,u),l.div(i,o)),a=o-u+1,f=u,s=o-1;do l.lte(i,t)?(e[u-f]=o-a-u+1,l.gt(i,0)&&(t=l.sub(t,i),i=l.div(l.mul(i,f),s)),f--,s--):(i=l.div(l.sub(s,f),s),a--,s--);while(f>0);return e},first:function(t){var r,n=t[1],e=new Array(n);for(r=0;n>r;r++)e[r]=0;return e},last:function(t){var r,n=t[1],e=new Array(n);for(t=t[0]-1,r=0;n>r;r++)e[r]=t;return e},succ:function(t,r,n){if(r){var e,i,u,o,f=r.slice();if(e=n[1],n=n[0],-1===t){for(i=e-1,u=-1;i>0;){if(f[i]>f[i-1]){u=i;break}i--}if(-1===u&&0<f[0]&&(u=0),u>-1){for(o=n-1,i=u+1;e>i;i++)f[i]=o;f[u]--}else f=null}else{for(i=e-1,u=-1;i>=0;){if(f[i]<n-1){u=i;break}i--}if(u>-1)for(o=f[u]+1,i=u;e>i;i++)f[i]=o;else f=null}return f}return null},rand:function(t){var r,n,e,i,u,o,f,a,s;for(n=t[1],t=t[0],r=new Array(n),e=c.Util.rnd(),u=0,f=0,a=t+n-1,s=a-n,i=1;n>=i;i++){for(u++,o=(n-i+1)/(a-u+1);e>=o&&s+i>u;)f=o,u++,o=f+(1-f)*((n-i+1)/(a-u+1));r[i-1]=u-i,e=(e-f)/(o-f)}return r},stochastic:i.stochastic}}),o=c.Partition=p(n,{constructor:function it(t){var r=this;return r instanceof it?void n.call(r,t):new it(t)},__static__:{count:function(t){var r,n,e=c.Arithmetic.add,i=t>1?2:1;for(r=2;t>r;r++)for(n=t-r+1;n>=1;n--)i=e(i,H(t,r,n));return i},dual:function(t,r){var n,e,i=[],u=t.length;for(n=0;u>n;n++)if(e=r-t[n],!(0>=e)){if(r===e)return[r];i.unshift(e)}return i},rank:function(t,r,n,e,i){var u,o,f,a=c.Arithmetic,s=this,l=t.length,h=r;return n=n||s.count(r),e=e||0,i=i||l,o=e,f=t[o],u=h===f?a.sub(n,1):1===f?0:l>o+1?a.add(1,s.rank(t,r-f,a.sub(n,s.count(r-f)),o+1)):0},unrank:function(t,r,n){},first:function(t){var r,n=new Array(t);for(r=0;t>r;r++)n[r]=1;return n},last:function(t){return[t]},succ:function(t,r,n){if(r){var e,i,u,o,f,a,s=r.slice();if(-1===t)if(s[0]>1){for(i=s.length,e=i-1;e>=0&&1===s[e];)e--;for(u=s[e]-1,s=s.slice(0,e+1),s[e]=u,f=N(s),a=n-f;a>0;)o=a,o>u?(o=u,s.push(o)):s.push(a),a-=o}else s=null;else if(s[0]<n){for(i=s.length,e=i-1,e>0&&e--;e>0&&s[e]===s[e-1];)e--;for(s[e]++,s=s.slice(0,e+1),f=N(s),a=n-f;a>0;)s.push(1),a--}else s=null;return s}return null},rand:function(t){},stochastic:n.stochastic,conjugate:function(t){var r,n,e,i=t.length,u=t[0],o=new Array(u);for(r=0;u>r;r++)o[r]=1;for(n=1;i>n;n++)for(r=0,e=t[n];u>r&&e>0;)o[r++]++,e--;return o},pack:function(t){var r,n=[],e=t.length,i=t[0],u=[i,1];for(r=1;e>r;r++)i===t[r]?u[1]++:(n.push(u),i=t[r],u=[i,1]);return n.push(u),n},unpack:function(t){var r,n,e,i,u,o=[],f=t.length;for(r=0;f>r;r++)if(u=t[r],1===u[1])o.push(u[0]);else for(e=u[1],i=u[0],n=0;e>n;n++)o.push(i);return o}}}),o.transpose=o.conjugate,f=c.Powerset=p(n,{constructor:function ut(t){var r=this;return r instanceof ut?void n.call(r,t):new ut(t)},__static__:{count:function(t){return X(t)},dual:n.dual,rank:function(t){for(var r=c.Arithmetic,n=0,e=0,i=t.length;i>e;)n=r.add(n,r.shl(1,t[e++]));return n},unrank:function(t){for(var r=c.Arithmetic,n=[],e=0;r.gt(t,0);)r.gt(r.band(t,1),0)&&n.unshift(e),r.gt(r.band(t,2),0)&&n.unshift(e+1),r.gt(r.band(t,4),0)&&n.unshift(e+2),r.gt(r.band(t,8),0)&&n.unshift(e+3),r.gt(r.band(t,16),0)&&n.unshift(e+4),r.gt(r.band(t,32),0)&&n.unshift(e+5),r.gt(r.band(t,64),0)&&n.unshift(e+6),r.gt(r.band(t,128),0)&&n.unshift(e+7),e+=8,t=r.shr(t,8);return n},first:function(t){return[]},last:function(t){var r,n=new Array(t);for(r=0;t>r;r++)n[r]=t-1-r;return n},succ:function(t,r,n){var e=this,i=c.Arithmetic;return 1!==t&&-1!==t&&(t=1),-1===t?0===r.length?null:e.unrank(i.add(e.rank(r),t)):n===r.length?null:e.unrank(i.add(e.rank(r),t))},rand:n.rand,stochastic:n.stochastic}}),a=c.Tensor=p(n,{constructor:function ot(){var t=this;return t instanceof ot?void(arguments.length?n.call(t,d.call(arguments)):(t.n=[],t._count=0)):(t=new ot,arguments.length?n.call(t,d.call(arguments)):(t.n=[],t._count=0),t)},__static__:{count:function(t){return t&&t.length?P(t):0},dual:n.dual,rank:function(t,r){var n,e,i=c.Arithmetic,u=r,o=u.length;if(!o)return-1;for(n=0,e=0;o>e;e++)n=i.add(i.mul(n,u[e]),t[e]);return n},unrank:function(t,r){var n,e,i,u,o,f=c.Arithmetic,a=r,s=a.length;if(!s)return[];for(o=new Array(s),n=t,i=s-1;i>=0;i--)e=a[i],u=f.mod(n,e),n=f.div(n,e),o[i]=f.val(u);return o},first:function(t){var r,n=t.length,e=new Array(n);for(r=0;n>r;r++)e[r]=0;return e},last:function(t){var r,n=t,e=n.length,i=new Array(e);for(r=0;e>r;r++)i[r]=n[r]-1;return i},succ:function(t,r,n){if(r){var e,i,u=r.slice(),o=n,f=o.length;if(-1===t){for(e=f-1;e>=0&&u[e]-1<0;)e--;if(e>=0)for(u[e]--,i=e+1;f>i;i++)u[i]=o[i]-1;else u=null}else{for(e=f-1;e>=0&&u[e]+1===o[e];)e--;if(e>=0)for(u[e]++,i=e+1;f>i;i++)u[i]=0;else u=null}return u}return null},rand:function(t){var r,n=c.Arithmetic.rnd,e=t,i=e.length,u=new Array(i);for(r=0;i>r;r++)u[r]=n(0,e[r]-1);return u},stochastic:n.stochastic,product:E,component:function(t,r){var n,e,i,u,o,f,a=[],s=r,c=s.length;for(n=0;c>n;n++)if(i=s[n],o=t[n],u=i[o],u instanceof Array)for(e=0,f=u.length;f>e;e++)a.push(u[e]);else a.push(u);return a}}}),s=c.Tuple=p(n,{constructor:function ft(t,r){var e=this;return e instanceof ft?void n.call(e,[t||1,r||2]):new ft(t,r)},__static__:{count:function(t){return j(t[1],t[0])},dual:function(t,r){return L(t,r[1])},rank:function(t,r){var n,e,i=c.Arithmetic,u=r[0];for(r=r[1],n=0,e=0;u>e;e++)n=i.add(i.mul(n,r),t[e]);return n},unrank:function(t,r){var n,e,i,u,o,f=c.Arithmetic,a=r[0];for(r=r[1],o=new Array(a),n=t,i=a-1;i>=0;i--)e=r,u=f.mod(n,e),n=f.div(n,e),o[i]=f.val(u);return o},first:function(t){var r,n=t[0],e=new Array(n);for(r=0;n>r;r++)e[r]=0;return e},last:function(t){var r,n=t[0],e=new Array(n);for(t=t[1]-1,r=0;n>r;r++)e[r]=t;return e},succ:function(t,r,n){if(r){var e,i,u=r.slice(),o=n[0],n=n[1];if(-1===t){for(e=o-1;e>=0&&u[e]-1<0;)e--;if(e>=0)for(u[e]--,i=e+1;o>i;i++)u[i]=n-1;else u=null}else{for(e=o-1;e>=0&&u[e]+1===n;)e--;if(e>=0)for(u[e]++,i=e+1;o>i;i++)u[i]=0;else u=null}return u}return null},rand:function(t){var r,n=c.Arithmetic.rnd,e=t[0],i=new Array(e);for(t=t[1]-1,r=0;e>r;r++)i[r]=n(0,t);return i},stochastic:a.stochastic}}),c});